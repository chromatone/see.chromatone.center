{"version":3,"file":"composables.js","sources":["../src/ui/useMouse.js","../src/ui/useColor.js","../src/ui/useBackground.js","../src/account/useAccount.js","../src/chat/useChat.js","../src/chat/usePrivate.js","../src/gun/useRelay.js","../src/gun/useGun.js","../src/gun/useRelays.js","../src/crypto/useCrypto.js","../src/crypto/useCert.js","../src/dict/useDict.js","../src/dict/langs.js","../src/file/useFile.js","../src/file/useMd.js","../src/posts/usePost.js","../src/posts/usePosts.js","../src/posts/useTags.js","../src/posts/useReaction.js","../src/posts/useReactions.js","../src/file/useZip.js","../src/room/rootRoom.js","../src/room/useRoom.js","../src/room/useGuests.js","../src/gifts/useGifts.js","../src/user/useMates.js","../src/user/useUser.js","../src/user/usePass.js","../src/gifts/useGift.js","../src/gifts/index.js","../src/log/useWorker.js","../src/log/useLog.js","../src/project/useProject.js","../src/project/useProjects.js","../src/project/index.js","../src/space/useSpace.js","../src/space/useDraw.js"],"sourcesContent":["/**\n * Handle mouse movement inside an SVG\n * @module useMouse\n * */\n\nimport { useMousePressed, useMouseInElement } from \"@vueuse/core\";\nimport { ref, reactive, onMounted, onBeforeUnmount, watch } from \"vue\";\n\n/**\n * @typedef {Object} useMouse\n * @property {ref} area - an area to mount the mouse to\n * @property {Mouse} mouse - the reactive mouse parameters\n */\n\n/**\n * @typedef {reactive} Mouse\n * @property {Number} x - absolute X coordinate to place a marker to\n * @property {Number} y - absolute Y coordinate to place a marker to\n * @property {Number} normX - [0-1] relative X coordinate\n * @property {Number} normY - [0-1] relative Y coordinate\n * @property {Boolean} pressed - is mouse pressed?\n * @property {Boolean} inside - is mouse inside the area?\n */\n\n/**\n * Correct mouse position in an SVG space\n * @returns {useMouse}\n */\n\nexport function useSvgMouse(area = ref(null)) {\n\n  const { pressed } = useMousePressed();\n\n  const mouse = reactive({\n    x: 0,\n    y: 0,\n    normX: 0,\n    normY: 0,\n    pressed,\n    inside: false,\n  });\n\n  onMounted(() => {\n    document.addEventListener(\"mousemove\", getCursorPosition);\n    const { isOutside } = useMouseInElement(area);\n    watch(isOutside, (out) => {\n      mouse.inside = !out;\n    });\n  });\n\n  onBeforeUnmount(() => {\n    document.removeEventListener(\"mousemove\", getCursorPosition);\n  });\n\n  function getCursorPosition(event, rect = area.value) {\n    const svgElement = rect.closest(\"svg\");\n    if (!svgElement) return;\n    var svgPoint = svgElement.createSVGPoint();\n    svgPoint.x = event.clientX;\n    svgPoint.y = event.clientY;\n    let correct = svgPoint.matrixTransform(svgElement.getScreenCTM().inverse());\n    if (false) {\n      let bounds = rect.getBBox();\n      mouse.x =\n        correct.x < bounds.width\n          ? correct.x < 0\n            ? 0\n            : correct.x\n          : bounds.width;\n      mouse.y =\n        correct.y < bounds.height\n          ? correct.y < 0\n            ? 0\n            : correct.y\n          : bounds.height;\n      mouse.normY = mouse.y / bounds.height;\n      mouse.normX = mouse.x / bounds.width;\n    } else {\n      mouse.x = correct.x;\n      mouse.y = correct.y;\n    }\n  }\n\n  return {\n    area,\n    mouse,\n  };\n}\n","/**\n * Deterministic colors derived from oub keys, hashes or any other string data\n * @module useColor\n * */\n\nimport ColorHash from \"color-hash\";\n\nconst color = {\n  light: new ColorHash({\n    saturation: [0.05, 0.08, 0.22],\n    lightness: [0.85, 0.87, 0.9],\n  }),\n  pale: new ColorHash({\n    saturation: [0.05, 0.42, 0.52],\n    lightness: [0.75, 0.77, 0.9],\n  }),\n  regular: new ColorHash({\n    saturation: [0.1, 0.5, 0.7],\n    lightness: [0.3, 0.5, 0.7],\n  }),\n  deep: new ColorHash({\n    saturation: [0.5, 0.6, 0.7],\n    lightness: [0.5, 0.55, 0.6],\n  }),\n  dark: new ColorHash({\n    saturation: [0.02, 0.5, 0.6],\n    lightness: [0.18, 0.2, 0.5],\n  }),\n};\n\n/**\n * Get a color generator of a certain palette\n * @param {('light'|'regular'|'deep'|'dark')} palette\n * @returns {ColorHash} Color-Hash instance\n * @see https://github.com/zenozeng/color-hash\n * @example\n * import {useColor} from '@gun-vue/composables'\n * const colorDeep = useColor('deep')\n * const color = colorDeep.hex('any text data')\n * // color == '#e052ae'\n */\n\nexport function useColor(palette = \"deep\") {\n  if (typeof palette == \"object\") {\n    return new ColorHash(palette);\n  }\n  return color[palette];\n}\n","import { gunAvatar } from \"..\";\n\nexport function useBackground({\n  pub,\n  size = 200,\n  light = 0.5,\n  overlay = 0.5,\n  draw = \"squares\",\n  attachment = \"fixed\",\n} = {}) {\n  if (!pub) return;\n\n  return {\n    background: `linear-gradient(hsla(255,0%,${\n      light * 100\n    }%,${overlay}), hsla(255,0%,${light * 100}%,${overlay})), url(${gunAvatar({\n      pub: pub,\n      draw,\n      reflect: false,\n      size: size,\n    })})`,\n    backgroundSize: \"cover, cover\",\n    backgroundAttachment: `${attachment},${attachment}`,\n  };\n}\n","/**\n * Basic user management\n * @module useAccount\n * */\n\nimport { useGun } from \"..\";\nimport { useColor } from \"../ui\";\nimport { computed, reactive, ref } from \"vue\";\nimport ms from \"ms\";\n\nconst colorDeep = useColor(\"deep\");\n\n/**\n * @typedef {computed(object)} account \n * Reactive account data\n * @property {string} pub   the pub key\n * @property {string} color the color hash of the pub key\n * @property {object} profile all the profile fields of the account\n * @property {number} pulse the recent presence timestamp\n * @property {boolean} blink on/off switching pulse\n * @property {'online' | string} lastSeen a human readable last seen status ('online' if less than TIMEOUT)\n */\n\n\n/**\n * Load and handle user's account by a public key\n * @param {ref(string) | string} pub - The public key of a user as a string or a ref\n * @returns {account}\n * @example\n * import { ref } from 'vue'\n * import { useAccount, SEA } from '@gun-vue/composables'\n *\n * const pub = ref()\n *\n * async function generatePair() {\n *  pub.value = await SEA.pair()\n * }\n *\n * const { account } = useAccount(pub)\n * \n * generatePair()\n */\n\nexport function useAccount(pub = ref(), { TIMEOUT = 10000 } = {}) {\n  const gun = useGun();\n  pub = ref(pub);\n  const account = computed(() => {\n    const obj = reactive({\n      pub,\n      color: computed(() => (pub.value ? colorDeep.hex(pub.value) : \"gray\")),\n      profile: {\n        name: \"\",\n      },\n      pulse: 0,\n      lastSeen: computed(() => {\n        let time = Date.now() - obj.pulse;\n        if (time > TIMEOUT) {\n          return ms(time);\n        } else {\n          return \"online\";\n        }\n      }),\n      blink: false,\n      db: gun.user(pub.value),\n    });\n\n    gun\n      .user(pub.value)\n      .get(\"pulse\")\n      .on((d) => {\n        obj.blink = !obj.blink;\n        obj.pulse = d;\n      })\n      .back()\n      .get(\"profile\")\n      .map()\n      .on((data, key) => {\n        obj.profile[key] = data;\n      });\n    return obj;\n  });\n\n  return { account };\n}","/**\n * Basic public chat\n * @module useChat\n */\n\nimport { ref, reactive, computed } from \"vue\";\nimport slugify from \"slugify\";\nimport { useUser, useGun, currentRoom } from \"..\";\nimport { refDebounced } from '@vueuse/core'\n\nexport function useChat() {\n  const gun = useGun();\n  const { user } = useUser();\n\n  const currentChat = ref(\"general\");\n  const chats = reactive({\n    general: {},\n  });\n\n  const chatDb = gun.user(currentRoom.pub).get(\"chat\");\n\n  chatDb.map().on((d, k) => {\n    const [title, author] = k.split(\"@\");\n    chats[title] = chats[title] || {};\n    if (d) {\n      chats[title][author] = d;\n    } else {\n      delete chats?.[title]?.[author];\n    }\n  });\n\n  function addChat(title) {\n    chatDb\n      .get(`${slugify(title) || title}@${user.pub}`)\n      .put(true, null, { opt: { cert: currentRoom.features.chat } });\n  }\n\n  const topicDb = computed(() =>\n    gun.user(currentRoom.pub).get(\"chat/\" + currentChat.value)\n  );\n\n  const messages = computed(() => {\n    const msgs = reactive({});\n    topicDb.value.map().on((text, k) => {\n      const timestamp = k.substring(0, 13);\n      const author = k.substring(14);\n      msgs[k] = {\n        timestamp,\n        author,\n        text,\n      };\n    });\n    return msgs;\n  });\n\n  const messageList = computed(() => Object.values(messages.value || {}))\n  const debList = refDebounced(messageList)\n  const sorted = computed(() => debList.value.sort((a, b) => a.timestamp > b.timestamp ? 1 : -1))\n\n\n  function send(message) {\n    if (!message) return;\n    let now = Date.now();\n    topicDb.value\n      .get(`${now}@${user.pub}`)\n      .put(message, null, { opt: { cert: currentRoom.features.chat } });\n  }\n\n  return {\n    send,\n    addChat,\n    currentChat,\n    chats,\n    messages,\n    sorted\n  };\n}\n","/**\n * Basic private chat\n * @module usePrivateChat\n */\n\nimport { reactive, computed, ref } from \"vue\"\nimport { useAccount, useUser, useGun, SEA } from '..'\nimport { refDebounced } from '@vueuse/core'\n\nexport function usePrivateChat(pub, { parse = true } = {}) {\n\n  const gun = useGun();\n  const { user } = useUser();\n  const messages = reactive({});\n  const epub = ref()\n\n  gun.user(pub)\n    .get('epub')\n    .once(d => epub.value = d)\n\n\n  gun.user(pub)\n    .get('chat')\n    .get(user.pub)\n    .map()\n    .once(function (d, k) {\n      parseMessages(d, k, pub, this)\n    })\n\n  gun.user()\n    .get('chat')\n    .get(pub)\n    .map()\n    .once(function (d, k) {\n      parseMessages(d, k, user.pub, this)\n    })\n\n  function parseMessages(data, today, author, that) {\n    that.map().on(async (d, k) => {\n      if (d && d.startsWith('SEA')) {\n        const secret = await SEA.secret(epub.value, user.pair())\n        const work = await SEA.work(secret, today)\n        const dec = await SEA.decrypt(d, work)\n        if (!dec || typeof dec != 'object') return\n        messages[k] = {\n          timestamp: dec.timestamp,\n          author,\n          text: dec.text\n        }\n      }\n    })\n  }\n\n  async function send(message) {\n    if (!message) return;\n    const theDate = new Date()\n    const toSend = {\n      timestamp: theDate.getTime(),\n      text: message\n    }\n    const today = theDate.toLocaleDateString('en-CA')\n    const secret = await SEA.secret(epub.value, user.pair())\n    const work = await SEA.work(secret, today)\n    const enc = await SEA.encrypt(toSend, work)\n    gun.user().get('chat').get(pub).get(today).set(enc)\n  }\n\n  const messageList = computed(() => Object.values(messages || {}))\n  const debList = refDebounced(messageList)\n  const sorted = computed(() => debList.value.sort((a, b) => a.timestamp > b.timestamp ? 1 : -1))\n\n  return {\n    send,\n    messages,\n    sorted\n  };\n}\n\n\nexport function usePrivateChatCount(pub) {\n  const gun = useGun();\n  const { user } = useUser();\n  const messages = reactive({});\n\n  const available = ref(false)\n\n  gun.user(pub).get('epub').on(d => available.value = d)\n\n  gun.user(pub).get('chat').get(user.pub).map().map().on((d, k) => {\n    if (d && !d.startsWith('SEA')) return\n    messages[k] = d\n  })\n\n  gun.user().get('chat').get(pub).map().map().on((d, k) => {\n    if (d && !d.startsWith('SEA')) return\n    messages[k] = d\n  })\n\n  const count = computed(() => {\n    return Object.keys(messages).length\n  })\n  return { count, available }\n}\n\nexport function usePrivateChatList() {\n  const gun = useGun();\n  const { user } = useUser();\n  const list = reactive({})\n  if (user.is) {\n    gun.user().get('chat').map().on((d, k) => {\n      list[k] = d\n    })\n    gun.user().get(\"mates\").map().on(async (d, k) => {\n      const mutual = await gun.user(k).get('mates').get(user.pub)\n      const epub = await gun.user(k).get('epub')\n      if (mutual && epub) {\n        list[k] = d\n      }\n    })\n\n  }\n  return { list }\n}","/**\n * Relay connection management\n * @module useRelay\n */\n\nimport { useGun } from '.'\nimport { computed, reactive, watch } from 'vue'\nimport { useStorage } from \"@vueuse/core\";\nimport ms from 'ms'\n\nexport const defaultPeer = \"https://etogun.glitch.me/gun\";\nexport const peer = useStorage(\"peer\", defaultPeer);\n\n/**\n * @typedef {reactive} Relay Peer server status reactive object\n * @property {String} host the current peer server URL\n * @property {String} status current connection status\n * @property {Number} started the timestamp of server started current session\n * @property {Number} pulse last received timestamp\n * @property {Number} lag drift of the timestamp in ms\n * @property {Number} diff age of the session in ms\n * @property {String} age age of the session in human readable format\n * @property {Boolean} blink a Boolean toggled every time the new pulse comes to drive animations\n * @example\n * {\n * \"peer\": \"https://etogun.glitch.me/gun\",\n * \"host\": \"6db1edbb5aae\",\n * \"status\": \"running\",\n * \"started\": 1642666725795,\n * \"pulse\": 1642677007483,\n * \"lag\": 8,\n * \"diff\": 10281688,\n * \"age\": \"3h\",\n * \"delay\": 22,\n * \"blink\": true\n * }\n */\n\nexport const relay = reactive({\n  list: [],\n  peer: peer.value,\n  host: new URL(peer.value).hostname,\n  status: 'offline',\n  started: 0,\n  pulse: 0,\n  lag: 0,\n  diff: computed(() => relay.pulse - relay.started),\n  age: computed(() => ms(relay.diff)),\n  delay: computed(() => Date.now() - relay.pulse),\n  blink: false,\n})\n\nwatch(\n  () => relay.pulse,\n  (next, prev) => {\n    relay.blink = !relay.blink\n    relay.lag = next - prev - 500\n  },\n)\n\nfunction setPeer(url) {\n  peer.value = url\n  window.location.reload()\n};\n\nfunction resetPeer() {\n  peer.value = defaultPeer\n  window.location.reload()\n}\n\n\n/**\n * Peer server status monitor\n * @returns {useRelay}\n *\n * @example\n * import { useRelay } from '@gun-vue/composables';\n *\n * const { relay, setPeer, resetPeer } = useRelay()\n */\nexport function useRelay() {\n  const gun = useGun()\n  if (relay.pulse == 0) {\n    gun\n      .get(relay.host)\n      .map()\n      .on((d, k) => {\n        relay[k] = d\n      })\n  }\n\n  return { relay, setPeer, resetPeer }\n}\n","/**\n * Gun DB initialization and basic methods\n * @module useGun\n */\n\nimport Gun from \"gun/gun\";\nimport \"gun/lib/then\";\nimport \"gun/lib/radix\";\nimport \"gun/lib/radisk\";\nimport \"gun/lib/store\";\nimport \"gun/lib/rindexed\";\nimport \"gun/lib/webrtc\";\nimport \"gun/nts\";\n\n\n// polyfiils for Gun 0.2020.1236\nimport { Buffer } from 'buffer'\nwindow.Buffer = Buffer\nwindow.setImmediate = setTimeout\n\nimport { peer } from './useRelay'\n\n\n// https://github.com/amark/gun/wiki/volunteer.dht\n// https://github.com/draeder/gun-relays\n\n/** The main Gun instance for database operations */\nexport let gun;\n\n/** Secondary Gun instance for key management */\nexport let gun2;\n\n/**\n * Instantiate a Gun instance for DB manipulations\n * @param {Object} options - options fot this gun instance, like { localstorage:true }\n * @returns {Gun}\n * @example\n * import { useGun } from '@gun-vue/composables'\n *\n * const gun = useGun()\n */\n\nexport function useGun(opts = { localStorage: false }) {\n  if (!gun) {\n    gun = Gun({ peers: [peer.value], ...opts });\n  }\n  return gun;\n}\n\n/**\n * get a secondary Gun instance for certificate management\n * @param {object} options - options fot this gun instance, like { localstorage:true }\n * @returns {Gun}\n */\n\nexport function useGun2(opts = { localStorage: false }) {\n  if (!gun2) {\n    gun2 = Gun({ peers: [peer.value], ...opts });\n  }\n  return gun2;\n}\n\n/**\n * SEA library\n * @constant SEA\n */\nexport { default as SEA } from \"gun/sea.js\";\n\n/**\n * **Get a soul for any given node**\n * A wrapper for `Gun.node.soul`\n * @function soul\n */\nexport const soul = Gun?.node?.soul;\n\n/**\n * **Generate a random UUID**\n * A wrapper for `Gun.text.random`\n * @function genUUID\n */\nexport const genUUID = Gun?.text?.random;\n\n\n","/**\n * Loads the [list of active volunteer DHT gun nodes](https://github.com/amark/gun/wiki/volunteer.dht)  and benchmarks ping for them\n * @module useRelays\n */\n\n/**\n * @typedef {Object} useRelays\n * @property {Object} Relays\n * @property {Object} Errors\n * @property {Function} loadRelays\n */\n\n/**\n * @typedef {Object} loadRelaysOptions\n * @property {String} source\n */\n\n/**\n * @typedef {Object[]} Relays \n * @property {String} hostname\n * @property {String} url\n * @property {Number} ping\n */\n\n\nimport urlRegex from 'url-regex'\nimport { reactive } from 'vue'\nimport { relay } from './useRelay'\n\nconst relays = reactive({})\nconst errors = reactive({})\n\n/**\n * Load the list of the relays\n * @param {Object} loadRelaysOptions\n * @returns {relays} \n */\n\nexport async function loadRelays({\n  source = 'https://raw.githubusercontent.com/wiki/amark/gun/volunteer.dht.md'\n} = {}) {\n  let res = await fetch(source)\n  let data = await res.text()\n  let urls = data.match(urlRegex())\n  urls.push(relay.peer)\n  urls = Array.from(urls)\n  urls.forEach((u) => {\n    let testUrl = new URL(u)\n    if (testUrl.pathname === '/gun' && testUrl.pathname.indexOf('~~') === -1) {\n      let startMoment = performance.now()\n      fetch(testUrl.href, {\n        method: 'HEAD',\n        mode: 'cors',\n        // mode: 'no-cors',\n        redirect: 'follow',\n        referrerPolicy: 'no-referrer',\n      }).then(response => {\n        let endMoment = performance.now()\n        if (response.ok) {\n          relays[testUrl.hostname] = {\n            host: testUrl.hostname,\n            ping: (endMoment - startMoment).toFixed(),\n            url: testUrl.href\n          }\n        } else {\n          errors[testUrl.hostname] = response\n        }\n      }).catch(e => {\n        errors[testUrl.hostname] = e\n      })\n    }\n  })\n  return relays\n}\n\n/**\n * Gets the list of actual gun relays and tool to update the list\n * @returns {useRelays}\n * @example\n * import { useRelays } from '@gun-vue/composables'\n * const { relays, errors, loadRelays } = useRelays()\n */\n\nexport function useRelays() {\n  return { relays, errors, loadRelays }\n}\n\n","/**\n * SEA cryptography abstraction\n * @module useCrypto\n */\n\n// https://github.com/amark/gun/wiki/Snippets\n\nimport { SEA } from \"../gun/\";\n\nexport function isHash(str) {\n  return str.length == 44 && str.charAt(43) == '='\n}\n\n/**\n * @typedef {Object} Entity\n * @property {String} pub - the public key\n * @property {String} epub - the elliplic encryption epub\n */\n\n/**\n * Encrypt data for one receiver entity\n * 1. Generates encryption secret using bob's epub and current user pair\n * 2. Enctypts data with this secret\n * @param {String} data - Stringified data to be encrypted\n * @param {Entity} sender - An object with `pub` and `epub` strings - the user.is object of the reciever's account\n * @param {SEAPair} receiver - SEA Pair of the sender – `epriv` key will be used to encrypt the data\n * @returns {String} Encrypted data string to be sent\n */\nexport async function encFor(data, receiver, sender) {\n  const secret = await SEA.secret(receiver.epub, sender);\n  const encryptedData = await SEA.encrypt(data, secret);\n  return encryptedData;\n}\n\n/**\n * Decrypt a private message from an entity\n * 1. Generates secret using senders `epub` and current user pair\n * 2. Decrypts the data with this secret\n * @param {String} data - Encrypted private data\n * @param {Entity} sender - An object with `pub` and `epub` strings - the user.is object of the sender's account\n * @param {SEAPair} receiver - SEA Pair of the receiver – `epriv` key will be used to encrypt the data\n * @returns {String} Decrypted data\n */\nexport async function decFrom(data, sender, receiver) {\n  const secret = await SEA.secret(sender.epub, receiver);\n  const decryptedData = await SEA.decrypt(data, secret);\n  return decryptedData;\n}\n\nexport async function hashText(text) {\n  let hash = await SEA.work(text, null, null, { name: \"SHA-256\" });\n  return hash;\n}\n\nexport async function hashObj(obj) {\n  let hashed = typeof obj == \"string\" ? obj : JSON.stringify(obj);\n  let hash = await hashText(hashed);\n  return { hashed, hash };\n}\n\n/**\n * Calculate a hex hash for any string data\n * @async\n * @param {String} text\n * @param {String} seed\n * @returns {String} The hex encoded SHA-1 hash\n */\nexport async function getShortHash(text, seed) {\n  return await SEA.work(text, seed, null, { name: \"SHA-1\", encode: \"hex\" });\n}\n\n// Buffer -> Base64 String -> Url Safe Base64 String\nexport function safeHash(unsafe) {\n  if (!unsafe) return;\n  const encode_regex = /[\\+=\\/]/g;\n  return unsafe.replace(encode_regex, encodeChar);\n}\n\nfunction encodeChar(c) {\n  switch (c) {\n    case \"+\":\n      return \"-\";\n    case \"=\":\n      return \".\";\n    case \"/\":\n      return \"_\";\n  }\n}\n\n// Url Safe Base64 String -> Base64 String -> Buffer\nexport function unsafeHash(safe) {\n  if (!safe) return;\n  const decode_regex = /[\\._\\-]/g;\n  return safe.replace(decode_regex, decodeChar);\n}\n\nfunction decodeChar(c) {\n  switch (c) {\n    case \"-\":\n      return \"+\";\n    case \".\":\n      return \"=\";\n    case \"_\":\n      return \"/\";\n  }\n}\n\nexport function safeJSONParse(input, def) {\n  // Convert null to empty object\n  if (!input) {\n    return def || {};\n  } else if (Object.prototype.toString.call(input) === \"[object Object]\") {\n    return input;\n  }\n  try {\n    return JSON.parse(input);\n  } catch (e) {\n    return def || {};\n  }\n}\n","import { SEA } from \"..\";\n\nexport async function issueCert({\n  pair,\n  tag = \"word\",\n  dot = '',\n  users = \"*\",\n  personal = false,\n} = {}) {\n  let policy = { \"*\": `${tag}` };\n  if (dot) {\n    policy[\".\"] = dot;\n  }\n  if (personal) {\n    policy[\"+\"] = \"*\";\n  }\n  try {\n    let cert = await SEA.certify(users, policy, pair);\n    return cert;\n  } catch (e) {\n    console.log(\"cert error: \", e);\n  }\n}\n\nwindow.issueCert = issueCert;\n\nexport async function generateCerts({ pair, list = [] } = {}) {\n  const all = {};\n  for (let opt of list) {\n    all[opt.tag] = await issueCert({ ...opt, pair });\n  }\n  return all;\n}\n","/**\n * @module useDictionary\n */\n\nimport Fuse from \"fuse.js\";\nimport { ref, reactive, computed, watch } from 'vue'\nimport { useStorage } from '@vueuse/core';\n\nimport { useGun, currentRoom, hashText, useUser, useColor, hashObj } from '..';\n\n\nexport const dictRecord = reactive({\n  word: null,\n  def: null\n})\n\nexport const dictLang = useStorage('dict-lang', 'en')\n\nwatch(dictRecord, () => {\n  if (dictRecord.word && dictRecord.def) {\n    addRecord(dictRecord)\n  }\n})\n\n/**\n * Use filtrable words list\n * @returns {useWords}\n */\n\nexport function useWords() {\n  const gun = useGun()\n  const { user } = useUser()\n\n  const input = ref('')\n  const word = computed(() => letterFilter(input.value))\n\n  async function addWord() {\n    const hash = await hashText(word.value)\n    gun.get('dict').get('#word').get(hash).put(word.value)\n    dictRecord.word = hash\n    // gun\n    //   .user(currentRoom.pub)\n    //   .get('dict')\n    //   .get(`${hash}@${user.pub}`)\n    //   .put(true, null, { opt: { cert: currentRoom.features?.dict } });\n    input.value = ''\n  }\n\n  const linked = reactive({})\n\n  gun.user(currentRoom.pub).get('dict').map().on(async (d, k) => {\n    if (!d) return\n    let hash = k.slice(0, 44);\n    let defHash = k.slice(45, 89);\n    let def = await gun.get('dict').get('#def').get(defHash).then()\n    if (!def) return\n    try {\n      def = JSON.parse(def)\n    } catch (e) {\n      console.log(e, def)\n      return\n    }\n    if (def?.lang != dictLang.value) return\n    linked[hash] = linked[hash] || await gun.get('dict').get('#word').get(hash).then()\n  })\n\n  const words = reactive({})\n\n  gun.get('dict').get('#word').map().once((d, k) => {\n    if (d.includes(' ')) return\n    words[k] = d\n  })\n\n  const fuse = computed(() => {\n    let arr = Object.entries(words).map(entry => {\n      return { text: entry[1], hash: entry[0] }\n    })\n    return new Fuse(arr, {\n      keys: ['text'],\n      includeScore: true\n    })\n  })\n\n  const found = computed(() => fuse.value.search(input.value))\n\n  return { input, found, words, linked, word, addWord }\n}\n\n\n\n\nexport function useWord(hash) {\n  const gun = useGun()\n\n  const word = ref()\n\n  gun.get('dict').get('#word').get(hash).once((d, k) => {\n    word.value = letterFilter(d)\n  })\n  return { word }\n}\n\n\n/**\n * Dictionary definitions browser\n * @returns {useDefs}\n */\n\nexport function useDefs() {\n  const gun = useGun()\n\n  const def = reactive({\n    text: '',\n    lang: dictLang,\n    part: 'noun'\n  })\n\n  async function addDef() {\n    const { hash, hashed } = await hashObj(def)\n    gun.get('dict').get('#def').get(hash).put(hashed)\n    dictRecord.def = hash\n    def.text = ''\n    def.part = null\n  }\n\n  const linked = reactive({})\n\n  gun.user(currentRoom.pub).get('dict').map().on(async (d, k) => {\n    if (!d) return\n\n    let hash = k.slice(45, 89);\n    let record = await gun.get('dict').get('#def').get(hash).then()\n    if (!record) return\n    try {\n      record = JSON.parse(record)\n      if (record?.lang != dictLang.value) return\n      linked[hash] = linked[hash] || record\n    } catch (e) {\n      console.log(e, record)\n    }\n\n  })\n\n\n  const defs = reactive({})\n\n  gun.get('dict').get('#def').map().once((d, k) => {\n    defs[k] = JSON.parse(d)\n  })\n\n  const fuse = computed(() => {\n    let defList = []\n    for (let hash in defs) {\n      defList.push({ hash, ...defs[hash] })\n    }\n    return new Fuse(defList, {\n      keys: ['text'],\n      includeScore: true\n    })\n  })\n\n  const found = computed(() => fuse.value.search(def.text))\n\n  return { def, addDef, defs, found, linked }\n}\n\n\n\nasync function addRecord({ word, def } = {}) {\n\n  const gun = useGun()\n  const { user } = useUser();\n  let already = await gun\n    .user(currentRoom.pub)\n    .get('dict')\n    .get(`${word}:${def}@${user.pub}`).then()\n\n  gun\n    .user(currentRoom.pub)\n    .get('dict')\n    .get(`${word}:${def}@${user.pub}`)\n    .put(!already, null, { opt: { cert: currentRoom.features?.dict } });\n  dictRecord.word = null\n  dictRecord.def = null\n}\n\nexport function useDictRecordsFor(hash) {\n  const gun = useGun()\n  const links = reactive({})\n  gun\n    .user(currentRoom.pub)\n    .get('dict')\n    .map()\n    .on((data, key) => {\n      let index = key.indexOf(hash);\n      if (index == -1) return;\n      const { from, to, author } = parseHashLink(key)\n      let linked = from == hash ? to : from\n\n      links[linked] = links[linked] || {}\n      if (data) {\n        links[linked][author] = data\n      } else {\n        delete links?.[linked]?.[author]\n        if (Object.keys(links?.[linked]).length == 0) {\n          delete links?.[linked]\n        }\n      }\n    })\n  return links\n}\n\nexport function useDictRecordsBy(pub) {\n  const gun = useGun()\n  const records = reactive({})\n  gun\n    .user(currentRoom.pub)\n    .get('dict')\n    .map()\n    .on((data, key) => {\n      const { from, to, author } = parseHashLink(key)\n      if (author != pub) return\n\n      records[from] = records[from] || {}\n      if (data) {\n        records[from][to] = data\n      } else {\n        delete records?.[from]?.[to]\n        if (Object.keys(records[from]).length == 0) {\n          delete records?.[from]\n        }\n      }\n    })\n  return records\n}\n\nexport function useDictAuthors() {\n  const gun = useGun()\n  const authors = reactive({})\n  gun\n    .user(currentRoom.pub)\n    .get('dict')\n    .map()\n    .once(async (data, key) => {\n      const { from, to, author } = parseHashLink(key)\n      authors[author] = authors[author] || {}\n      authors[author][from] = authors[author][from] || {}\n      authors[author][from][to] = data\n    })\n  return authors\n}\n\nexport function useDictLangs() {\n  const gun = useGun()\n  const langs = reactive({})\n  gun\n    .user(currentRoom.pub)\n    .get('dict')\n    .map()\n    .once(async (data, key) => {\n\n\n      let hash = key.slice(45, 89);\n      let def = await gun.get('dict').get('#def').get(hash).then()\n      if (!def) return\n      try {\n        def = JSON.parse(def)\n      } catch (e) {\n        console.log(def, e)\n      }\n      if (!def?.lang) return\n      langs[def?.lang] = langs[def?.lang] || 0\n      langs[def?.lang]++\n    })\n  return langs\n}\n\n\nexport function parseHashLink(link) {\n  return {\n    from: link.slice(0, 44),\n    to: link.slice(45, 89),\n    author: link.slice(-87),\n  }\n}\n\n\nexport function renderStress({ text, stress } = {}) {\n  const stressMark = '&#x301;'\n  if (!text) return;\n  let str = text.slice(0, stress + 1) + stressMark + text.slice(stress + 1);\n  return str[0].toUpperCase() + str.slice(1);\n}\n\nexport function letterFilter(str) {\n  if (!str) return ''\n  let clean = str.toLowerCase().matchAll(/\\p{L}/gu, '')\n  return Array.from(clean).map(el => el[0]).join('')\n}","export const langParts = {\n  noun: {\n    en: 'noun',\n    ru: 'сущ',\n    underline: 'solid',\n  },\n  adj: {\n    en: 'adjective',\n    ru: 'прил',\n    underline: 'wavy',\n  },\n  verb: {\n    en: 'verb',\n    ru: 'глаг',\n    underline: 'double',\n  },\n  adv: {\n    en: 'adverb',\n    ru: 'нареч',\n    underline: 'dotted',\n  },\n}\n\n\nexport const languages = [\n  {\n    \"code\": \"aa\",\n    \"name\": \"Afar\",\n    \"native\": \"Afar\"\n  },\n  {\n    \"code\": \"ab\",\n    \"name\": \"Abkhazian\",\n    \"native\": \"Аҧсуа\"\n  },\n  {\n    \"code\": \"af\",\n    \"name\": \"Afrikaans\",\n    \"native\": \"Afrikaans\"\n  },\n  {\n    \"code\": \"ak\",\n    \"name\": \"Akan\",\n    \"native\": \"Akana\"\n  },\n  {\n    \"code\": \"am\",\n    \"name\": \"Amharic\",\n    \"native\": \"አማርኛ\"\n  },\n  {\n    \"code\": \"an\",\n    \"name\": \"Aragonese\",\n    \"native\": \"Aragonés\"\n  },\n  {\n    \"code\": \"ar\",\n    \"name\": \"Arabic\",\n    \"native\": \"العربية\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"as\",\n    \"name\": \"Assamese\",\n    \"native\": \"অসমীয়া\"\n  },\n  {\n    \"code\": \"av\",\n    \"name\": \"Avar\",\n    \"native\": \"Авар\"\n  },\n  {\n    \"code\": \"ay\",\n    \"name\": \"Aymara\",\n    \"native\": \"Aymar\"\n  },\n  {\n    \"code\": \"az\",\n    \"name\": \"Azerbaijani\",\n    \"native\": \"Azərbaycanca / آذربايجان\"\n  },\n  {\n    \"code\": \"ba\",\n    \"name\": \"Bashkir\",\n    \"native\": \"Башҡорт\"\n  },\n  {\n    \"code\": \"be\",\n    \"name\": \"Belarusian\",\n    \"native\": \"Беларуская\"\n  },\n  {\n    \"code\": \"bg\",\n    \"name\": \"Bulgarian\",\n    \"native\": \"Български\"\n  },\n  {\n    \"code\": \"bh\",\n    \"name\": \"Bihari\",\n    \"native\": \"भोजपुरी\"\n  },\n  {\n    \"code\": \"bi\",\n    \"name\": \"Bislama\",\n    \"native\": \"Bislama\"\n  },\n  {\n    \"code\": \"bm\",\n    \"name\": \"Bambara\",\n    \"native\": \"Bamanankan\"\n  },\n  {\n    \"code\": \"bn\",\n    \"name\": \"Bengali\",\n    \"native\": \"বাংলা\"\n  },\n  {\n    \"code\": \"bo\",\n    \"name\": \"Tibetan\",\n    \"native\": \"བོད་ཡིག / Bod skad\"\n  },\n  {\n    \"code\": \"br\",\n    \"name\": \"Breton\",\n    \"native\": \"Brezhoneg\"\n  },\n  {\n    \"code\": \"bs\",\n    \"name\": \"Bosnian\",\n    \"native\": \"Bosanski\"\n  },\n  {\n    \"code\": \"ca\",\n    \"name\": \"Catalan\",\n    \"native\": \"Català\"\n  },\n  {\n    \"code\": \"ce\",\n    \"name\": \"Chechen\",\n    \"native\": \"Нохчийн\"\n  },\n  {\n    \"code\": \"ch\",\n    \"name\": \"Chamorro\",\n    \"native\": \"Chamoru\"\n  },\n  {\n    \"code\": \"co\",\n    \"name\": \"Corsican\",\n    \"native\": \"Corsu\"\n  },\n  {\n    \"code\": \"cr\",\n    \"name\": \"Cree\",\n    \"native\": \"Nehiyaw\"\n  },\n  {\n    \"code\": \"cs\",\n    \"name\": \"Czech\",\n    \"native\": \"Česky\"\n  },\n  {\n    \"code\": \"cu\",\n    \"name\": \"Old Church Slavonic / Old Bulgarian\",\n    \"native\": \"словѣньскъ / slověnĭskŭ\"\n  },\n  {\n    \"code\": \"cv\",\n    \"name\": \"Chuvash\",\n    \"native\": \"Чăваш\"\n  },\n  {\n    \"code\": \"cy\",\n    \"name\": \"Welsh\",\n    \"native\": \"Cymraeg\"\n  },\n  {\n    \"code\": \"da\",\n    \"name\": \"Danish\",\n    \"native\": \"Dansk\"\n  },\n  {\n    \"code\": \"de\",\n    \"name\": \"German\",\n    \"native\": \"Deutsch\"\n  },\n  {\n    \"code\": \"dv\",\n    \"name\": \"Divehi\",\n    \"native\": \"ދިވެހިބަސް\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"dz\",\n    \"name\": \"Dzongkha\",\n    \"native\": \"ཇོང་ཁ\"\n  },\n  {\n    \"code\": \"ee\",\n    \"name\": \"Ewe\",\n    \"native\": \"Ɛʋɛ\"\n  },\n  {\n    \"code\": \"el\",\n    \"name\": \"Greek\",\n    \"native\": \"Ελληνικά\"\n  },\n  {\n    \"code\": \"en\",\n    \"name\": \"English\",\n    \"native\": \"English\"\n  },\n  {\n    \"code\": \"eo\",\n    \"name\": \"Esperanto\",\n    \"native\": \"Esperanto\"\n  },\n  {\n    \"code\": \"es\",\n    \"name\": \"Spanish\",\n    \"native\": \"Español\"\n  },\n  {\n    \"code\": \"et\",\n    \"name\": \"Estonian\",\n    \"native\": \"Eesti\"\n  },\n  {\n    \"code\": \"eu\",\n    \"name\": \"Basque\",\n    \"native\": \"Euskara\"\n  },\n  {\n    \"code\": \"fa\",\n    \"name\": \"Persian\",\n    \"native\": \"فارسی\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"ff\",\n    \"name\": \"Peul\",\n    \"native\": \"Fulfulde\"\n  },\n  {\n    \"code\": \"fi\",\n    \"name\": \"Finnish\",\n    \"native\": \"Suomi\"\n  },\n  {\n    \"code\": \"fj\",\n    \"name\": \"Fijian\",\n    \"native\": \"Na Vosa Vakaviti\"\n  },\n  {\n    \"code\": \"fo\",\n    \"name\": \"Faroese\",\n    \"native\": \"Føroyskt\"\n  },\n  {\n    \"code\": \"fr\",\n    \"name\": \"French\",\n    \"native\": \"Français\"\n  },\n  {\n    \"code\": \"fy\",\n    \"name\": \"West Frisian\",\n    \"native\": \"Frysk\"\n  },\n  {\n    \"code\": \"ga\",\n    \"name\": \"Irish\",\n    \"native\": \"Gaeilge\"\n  },\n  {\n    \"code\": \"gd\",\n    \"name\": \"Scottish Gaelic\",\n    \"native\": \"Gàidhlig\"\n  },\n  {\n    \"code\": \"gl\",\n    \"name\": \"Galician\",\n    \"native\": \"Galego\"\n  },\n  {\n    \"code\": \"gn\",\n    \"name\": \"Guarani\",\n    \"native\": \"Avañe'ẽ\"\n  },\n  {\n    \"code\": \"gu\",\n    \"name\": \"Gujarati\",\n    \"native\": \"ગુજરાતી\"\n  },\n  {\n    \"code\": \"gv\",\n    \"name\": \"Manx\",\n    \"native\": \"Gaelg\"\n  },\n  {\n    \"code\": \"ha\",\n    \"name\": \"Hausa\",\n    \"native\": \"هَوُسَ\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"he\",\n    \"name\": \"Hebrew\",\n    \"native\": \"עברית\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"hi\",\n    \"name\": \"Hindi\",\n    \"native\": \"हिन्दी\"\n  },\n  {\n    \"code\": \"ho\",\n    \"name\": \"Hiri Motu\",\n    \"native\": \"Hiri Motu\"\n  },\n  {\n    \"code\": \"hr\",\n    \"name\": \"Croatian\",\n    \"native\": \"Hrvatski\"\n  },\n  {\n    \"code\": \"ht\",\n    \"name\": \"Haitian\",\n    \"native\": \"Krèyol ayisyen\"\n  },\n  {\n    \"code\": \"hu\",\n    \"name\": \"Hungarian\",\n    \"native\": \"Magyar\"\n  },\n  {\n    \"code\": \"hy\",\n    \"name\": \"Armenian\",\n    \"native\": \"Հայերեն\"\n  },\n  {\n    \"code\": \"hz\",\n    \"name\": \"Herero\",\n    \"native\": \"Otsiherero\"\n  },\n  {\n    \"code\": \"ia\",\n    \"name\": \"Interlingua\",\n    \"native\": \"Interlingua\"\n  },\n  {\n    \"code\": \"id\",\n    \"name\": \"Indonesian\",\n    \"native\": \"Bahasa Indonesia\"\n  },\n  {\n    \"code\": \"ie\",\n    \"name\": \"Interlingue\",\n    \"native\": \"Interlingue\"\n  },\n  {\n    \"code\": \"ig\",\n    \"name\": \"Igbo\",\n    \"native\": \"Igbo\"\n  },\n  {\n    \"code\": \"ii\",\n    \"name\": \"Sichuan Yi\",\n    \"native\": \"ꆇꉙ / 四川彝语\"\n  },\n  {\n    \"code\": \"ik\",\n    \"name\": \"Inupiak\",\n    \"native\": \"Iñupiak\"\n  },\n  {\n    \"code\": \"io\",\n    \"name\": \"Ido\",\n    \"native\": \"Ido\"\n  },\n  {\n    \"code\": \"is\",\n    \"name\": \"Icelandic\",\n    \"native\": \"Íslenska\"\n  },\n  {\n    \"code\": \"it\",\n    \"name\": \"Italian\",\n    \"native\": \"Italiano\"\n  },\n  {\n    \"code\": \"iu\",\n    \"name\": \"Inuktitut\",\n    \"native\": \"ᐃᓄᒃᑎᑐᑦ\"\n  },\n  {\n    \"code\": \"ja\",\n    \"name\": \"Japanese\",\n    \"native\": \"日本語\"\n  },\n  {\n    \"code\": \"jv\",\n    \"name\": \"Javanese\",\n    \"native\": \"Basa Jawa\"\n  },\n  {\n    \"code\": \"ka\",\n    \"name\": \"Georgian\",\n    \"native\": \"ქართული\"\n  },\n  {\n    \"code\": \"kg\",\n    \"name\": \"Kongo\",\n    \"native\": \"KiKongo\"\n  },\n  {\n    \"code\": \"ki\",\n    \"name\": \"Kikuyu\",\n    \"native\": \"Gĩkũyũ\"\n  },\n  {\n    \"code\": \"kj\",\n    \"name\": \"Kuanyama\",\n    \"native\": \"Kuanyama\"\n  },\n  {\n    \"code\": \"kk\",\n    \"name\": \"Kazakh\",\n    \"native\": \"Қазақша\"\n  },\n  {\n    \"code\": \"kl\",\n    \"name\": \"Greenlandic\",\n    \"native\": \"Kalaallisut\"\n  },\n  {\n    \"code\": \"km\",\n    \"name\": \"Cambodian\",\n    \"native\": \"ភាសាខ្មែរ\"\n  },\n  {\n    \"code\": \"kn\",\n    \"name\": \"Kannada\",\n    \"native\": \"ಕನ್ನಡ\"\n  },\n  {\n    \"code\": \"ko\",\n    \"name\": \"Korean\",\n    \"native\": \"한국어\"\n  },\n  {\n    \"code\": \"kr\",\n    \"name\": \"Kanuri\",\n    \"native\": \"Kanuri\"\n  },\n  {\n    \"code\": \"ks\",\n    \"name\": \"Kashmiri\",\n    \"native\": \"कश्मीरी / كشميري\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"ku\",\n    \"name\": \"Kurdish\",\n    \"native\": \"Kurdî / كوردی\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"kv\",\n    \"name\": \"Komi\",\n    \"native\": \"Коми\"\n  },\n  {\n    \"code\": \"kw\",\n    \"name\": \"Cornish\",\n    \"native\": \"Kernewek\"\n  },\n  {\n    \"code\": \"ky\",\n    \"name\": \"Kirghiz\",\n    \"native\": \"Kırgızca / Кыргызча\"\n  },\n  {\n    \"code\": \"la\",\n    \"name\": \"Latin\",\n    \"native\": \"Latina\"\n  },\n  {\n    \"code\": \"lb\",\n    \"name\": \"Luxembourgish\",\n    \"native\": \"Lëtzebuergesch\"\n  },\n  {\n    \"code\": \"lg\",\n    \"name\": \"Ganda\",\n    \"native\": \"Luganda\"\n  },\n  {\n    \"code\": \"li\",\n    \"name\": \"Limburgian\",\n    \"native\": \"Limburgs\"\n  },\n  {\n    \"code\": \"ln\",\n    \"name\": \"Lingala\",\n    \"native\": \"Lingála\"\n  },\n  {\n    \"code\": \"lo\",\n    \"name\": \"Laotian\",\n    \"native\": \"ລາວ / Pha xa lao\"\n  },\n  {\n    \"code\": \"lt\",\n    \"name\": \"Lithuanian\",\n    \"native\": \"Lietuvių\"\n  },\n  {\n    \"code\": \"lu\",\n    \"name\": \"Luba-Katanga\",\n    \"native\": \"Tshiluba\"\n  },\n  {\n    \"code\": \"lv\",\n    \"name\": \"Latvian\",\n    \"native\": \"Latviešu\"\n  },\n  {\n    \"code\": \"mg\",\n    \"name\": \"Malagasy\",\n    \"native\": \"Malagasy\"\n  },\n  {\n    \"code\": \"mh\",\n    \"name\": \"Marshallese\",\n    \"native\": \"Kajin Majel / Ebon\"\n  },\n  {\n    \"code\": \"mi\",\n    \"name\": \"Maori\",\n    \"native\": \"Māori\"\n  },\n  {\n    \"code\": \"mk\",\n    \"name\": \"Macedonian\",\n    \"native\": \"Македонски\"\n  },\n  {\n    \"code\": \"ml\",\n    \"name\": \"Malayalam\",\n    \"native\": \"മലയാളം\"\n  },\n  {\n    \"code\": \"mn\",\n    \"name\": \"Mongolian\",\n    \"native\": \"Монгол\"\n  },\n  {\n    \"code\": \"mo\",\n    \"name\": \"Moldovan\",\n    \"native\": \"Moldovenească\"\n  },\n  {\n    \"code\": \"mr\",\n    \"name\": \"Marathi\",\n    \"native\": \"मराठी\"\n  },\n  {\n    \"code\": \"ms\",\n    \"name\": \"Malay\",\n    \"native\": \"Bahasa Melayu\"\n  },\n  {\n    \"code\": \"mt\",\n    \"name\": \"Maltese\",\n    \"native\": \"bil-Malti\"\n  },\n  {\n    \"code\": \"my\",\n    \"name\": \"Burmese\",\n    \"native\": \"မြန်မာစာ\"\n  },\n  {\n    \"code\": \"na\",\n    \"name\": \"Nauruan\",\n    \"native\": \"Dorerin Naoero\"\n  },\n  {\n    \"code\": \"nb\",\n    \"name\": \"Norwegian Bokmål\",\n    \"native\": \"Norsk bokmål\"\n  },\n  {\n    \"code\": \"nd\",\n    \"name\": \"North Ndebele\",\n    \"native\": \"Sindebele\"\n  },\n  {\n    \"code\": \"ne\",\n    \"name\": \"Nepali\",\n    \"native\": \"नेपाली\"\n  },\n  {\n    \"code\": \"ng\",\n    \"name\": \"Ndonga\",\n    \"native\": \"Oshiwambo\"\n  },\n  {\n    \"code\": \"nl\",\n    \"name\": \"Dutch\",\n    \"native\": \"Nederlands\"\n  },\n  {\n    \"code\": \"nn\",\n    \"name\": \"Norwegian Nynorsk\",\n    \"native\": \"Norsk nynorsk\"\n  },\n  {\n    \"code\": \"no\",\n    \"name\": \"Norwegian\",\n    \"native\": \"Norsk\"\n  },\n  {\n    \"code\": \"nr\",\n    \"name\": \"South Ndebele\",\n    \"native\": \"isiNdebele\"\n  },\n  {\n    \"code\": \"nv\",\n    \"name\": \"Navajo\",\n    \"native\": \"Diné bizaad\"\n  },\n  {\n    \"code\": \"ny\",\n    \"name\": \"Chichewa\",\n    \"native\": \"Chi-Chewa\"\n  },\n  {\n    \"code\": \"oc\",\n    \"name\": \"Occitan\",\n    \"native\": \"Occitan\"\n  },\n  {\n    \"code\": \"oj\",\n    \"name\": \"Ojibwa\",\n    \"native\": \"ᐊᓂᔑᓈᐯᒧᐎᓐ / Anishinaabemowin\"\n  },\n  {\n    \"code\": \"om\",\n    \"name\": \"Oromo\",\n    \"native\": \"Oromoo\"\n  },\n  {\n    \"code\": \"or\",\n    \"name\": \"Oriya\",\n    \"native\": \"ଓଡ଼ିଆ\"\n  },\n  {\n    \"code\": \"os\",\n    \"name\": \"Ossetian / Ossetic\",\n    \"native\": \"Иронау\"\n  },\n  {\n    \"code\": \"pa\",\n    \"name\": \"Panjabi / Punjabi\",\n    \"native\": \"ਪੰਜਾਬੀ / पंजाबी / پنجابي\"\n  },\n  {\n    \"code\": \"pi\",\n    \"name\": \"Pali\",\n    \"native\": \"Pāli / पाऴि\"\n  },\n  {\n    \"code\": \"pl\",\n    \"name\": \"Polish\",\n    \"native\": \"Polski\"\n  },\n  {\n    \"code\": \"ps\",\n    \"name\": \"Pashto\",\n    \"native\": \"پښتو\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"pt\",\n    \"name\": \"Portuguese\",\n    \"native\": \"Português\"\n  },\n  {\n    \"code\": \"qu\",\n    \"name\": \"Quechua\",\n    \"native\": \"Runa Simi\"\n  },\n  {\n    \"code\": \"rm\",\n    \"name\": \"Raeto Romance\",\n    \"native\": \"Rumantsch\"\n  },\n  {\n    \"code\": \"rn\",\n    \"name\": \"Kirundi\",\n    \"native\": \"Kirundi\"\n  },\n  {\n    \"code\": \"ro\",\n    \"name\": \"Romanian\",\n    \"native\": \"Română\"\n  },\n  {\n    \"code\": \"ru\",\n    \"name\": \"Russian\",\n    \"native\": \"Русский\"\n  },\n  {\n    \"code\": \"rw\",\n    \"name\": \"Rwandi\",\n    \"native\": \"Kinyarwandi\"\n  },\n  {\n    \"code\": \"sa\",\n    \"name\": \"Sanskrit\",\n    \"native\": \"संस्कृतम्\"\n  },\n  {\n    \"code\": \"sc\",\n    \"name\": \"Sardinian\",\n    \"native\": \"Sardu\"\n  },\n  {\n    \"code\": \"sd\",\n    \"name\": \"Sindhi\",\n    \"native\": \"सिनधि\"\n  },\n  {\n    \"code\": \"se\",\n    \"name\": \"Northern Sami\",\n    \"native\": \"Sámegiella\"\n  },\n  {\n    \"code\": \"sg\",\n    \"name\": \"Sango\",\n    \"native\": \"Sängö\"\n  },\n  {\n    \"code\": \"sh\",\n    \"name\": \"Serbo-Croatian\",\n    \"native\": \"Srpskohrvatski / Српскохрватски\"\n  },\n  {\n    \"code\": \"si\",\n    \"name\": \"Sinhalese\",\n    \"native\": \"සිංහල\"\n  },\n  {\n    \"code\": \"sk\",\n    \"name\": \"Slovak\",\n    \"native\": \"Slovenčina\"\n  },\n  {\n    \"code\": \"sl\",\n    \"name\": \"Slovenian\",\n    \"native\": \"Slovenščina\"\n  },\n  {\n    \"code\": \"sm\",\n    \"name\": \"Samoan\",\n    \"native\": \"Gagana Samoa\"\n  },\n  {\n    \"code\": \"sn\",\n    \"name\": \"Shona\",\n    \"native\": \"chiShona\"\n  },\n  {\n    \"code\": \"so\",\n    \"name\": \"Somalia\",\n    \"native\": \"Soomaaliga\"\n  },\n  {\n    \"code\": \"sq\",\n    \"name\": \"Albanian\",\n    \"native\": \"Shqip\"\n  },\n  {\n    \"code\": \"sr\",\n    \"name\": \"Serbian\",\n    \"native\": \"Српски\"\n  },\n  {\n    \"code\": \"ss\",\n    \"name\": \"Swati\",\n    \"native\": \"SiSwati\"\n  },\n  {\n    \"code\": \"st\",\n    \"name\": \"Southern Sotho\",\n    \"native\": \"Sesotho\"\n  },\n  {\n    \"code\": \"su\",\n    \"name\": \"Sundanese\",\n    \"native\": \"Basa Sunda\"\n  },\n  {\n    \"code\": \"sv\",\n    \"name\": \"Swedish\",\n    \"native\": \"Svenska\"\n  },\n  {\n    \"code\": \"sw\",\n    \"name\": \"Swahili\",\n    \"native\": \"Kiswahili\"\n  },\n  {\n    \"code\": \"ta\",\n    \"name\": \"Tamil\",\n    \"native\": \"தமிழ்\"\n  },\n  {\n    \"code\": \"te\",\n    \"name\": \"Telugu\",\n    \"native\": \"తెలుగు\"\n  },\n  {\n    \"code\": \"tg\",\n    \"name\": \"Tajik\",\n    \"native\": \"Тоҷикӣ\"\n  },\n  {\n    \"code\": \"th\",\n    \"name\": \"Thai\",\n    \"native\": \"ไทย / Phasa Thai\"\n  },\n  {\n    \"code\": \"ti\",\n    \"name\": \"Tigrinya\",\n    \"native\": \"ትግርኛ\"\n  },\n  {\n    \"code\": \"tk\",\n    \"name\": \"Turkmen\",\n    \"native\": \"Туркмен / تركمن\"\n  },\n  {\n    \"code\": \"tl\",\n    \"name\": \"Tagalog / Filipino\",\n    \"native\": \"Tagalog\"\n  },\n  {\n    \"code\": \"tn\",\n    \"name\": \"Tswana\",\n    \"native\": \"Setswana\"\n  },\n  {\n    \"code\": \"to\",\n    \"name\": \"Tonga\",\n    \"native\": \"Lea Faka-Tonga\"\n  },\n  {\n    \"code\": \"tr\",\n    \"name\": \"Turkish\",\n    \"native\": \"Türkçe\"\n  },\n  {\n    \"code\": \"ts\",\n    \"name\": \"Tsonga\",\n    \"native\": \"Xitsonga\"\n  },\n  {\n    \"code\": \"tt\",\n    \"name\": \"Tatar\",\n    \"native\": \"Tatarça\"\n  },\n  {\n    \"code\": \"tw\",\n    \"name\": \"Twi\",\n    \"native\": \"Twi\"\n  },\n  {\n    \"code\": \"ty\",\n    \"name\": \"Tahitian\",\n    \"native\": \"Reo Mā`ohi\"\n  },\n  {\n    \"code\": \"ug\",\n    \"name\": \"Uyghur\",\n    \"native\": \"Uyƣurqə / ئۇيغۇرچە\"\n  },\n  {\n    \"code\": \"uk\",\n    \"name\": \"Ukrainian\",\n    \"native\": \"Українська\"\n  },\n  {\n    \"code\": \"ur\",\n    \"name\": \"Urdu\",\n    \"native\": \"اردو\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"uz\",\n    \"name\": \"Uzbek\",\n    \"native\": \"Ўзбек\"\n  },\n  {\n    \"code\": \"ve\",\n    \"name\": \"Venda\",\n    \"native\": \"Tshivenḓa\"\n  },\n  {\n    \"code\": \"vi\",\n    \"name\": \"Vietnamese\",\n    \"native\": \"Tiếng Việt\"\n  },\n  {\n    \"code\": \"vo\",\n    \"name\": \"Volapük\",\n    \"native\": \"Volapük\"\n  },\n  {\n    \"code\": \"wa\",\n    \"name\": \"Walloon\",\n    \"native\": \"Walon\"\n  },\n  {\n    \"code\": \"wo\",\n    \"name\": \"Wolof\",\n    \"native\": \"Wollof\"\n  },\n  {\n    \"code\": \"xh\",\n    \"name\": \"Xhosa\",\n    \"native\": \"isiXhosa\"\n  },\n  {\n    \"code\": \"yi\",\n    \"name\": \"Yiddish\",\n    \"native\": \"ייִדיש\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"yo\",\n    \"name\": \"Yoruba\",\n    \"native\": \"Yorùbá\"\n  },\n  {\n    \"code\": \"za\",\n    \"name\": \"Zhuang\",\n    \"native\": \"Cuengh / Tôô / 壮语\"\n  },\n  {\n    \"code\": \"zh\",\n    \"name\": \"Chinese\",\n    \"native\": \"中文\"\n  },\n  {\n    \"code\": \"zu\",\n    \"name\": \"Zulu\",\n    \"native\": \"isiZulu\"\n  }\n]","/**\n * File handling functions\n * @module useFile\n * */\n\nimport { reactive } from \"vue\";\n\n/**\n * A method to download any text as a file\n * @param {String} text - the text to download\n * @param {String} fileType - the file type like \"application/json\"\n * @param {String} fileName - the full file name like \"myKey.json\"\n */\n\nexport function downloadFile(text, fileType, fileName, isBlob = true) {\n  const a = document.createElement(\"a\");\n  a.download = fileName;\n\n  if (isBlob) {\n    a.href = URL.createObjectURL(new Blob([text], { type: fileType }));\n    setTimeout(function () {\n      URL.revokeObjectURL(a.href);\n    }, 1500);\n  } else {\n    a.href = `data:${fileType};,${text}`;\n  }\n  a.dataset.downloadurl = [fileType, a.download, a.href].join(\":\");\n  a.style.display = \"none\";\n  document.body.appendChild(a);\n  a.click();\n  document.body.removeChild(a);\n}\n\n/**\n * Upload and parse JSON keypair\n * @param {Event} event - `$event` from the `@change` handler\n * @param {Function} callback - a function to handle the loaded file from the reader\n */\n\nexport function uploadText(event, callback = (r) => console.log(r)) {\n  let file = event.target.files[0];\n  const maxBytes = 20000000;\n  if (file.size > maxBytes) {\n    console.error(\"File is bigger than \" + niceBytes(maxBytes)) + \" limit\";\n    return;\n  }\n  let reader = new FileReader();\n  reader.readAsText(file);\n  reader.onload = () => {\n    callback(reader.result);\n  };\n}\n\n//// https://github.com/itsabdessalam/encodeit/blob/develop/src/components/FileUploader.vue\n// to be upgraded with this code https://github.com/powerbot15/image-compressor/blob/master/image-compressor.js\n// https://github.com/dhhb/vue-base64-file-upload\n// https://zocada.com/compress-resize-images-javascript-browser/\n\n/**\n * @typedef {Object} PictureUploadOptions\n * @property {Boolean} preserveRatio - should we preserve the original picture aspect ratio? Default: `false`\n * @property {Number} picSize - width of the rendered picture\n * @property {Number} maxSize - maximum size of an uploaded picture\n */\n\n/**\n * @typedef {Object} PictureUploadData\n * @property {reactive} state - a reactive object with the state of the upload\n * @property {Function} handleUpload - handler function to use with `@change=\"handleUpload\"` on an `<input type=\"file\">` element\n */\n\n/**\n * Process an uploaded picture by rendering in into a canvas with given size. Returns a base64 encoded image to be stored and displayed as `img.src`\n * @param {PictureUploadOptions} Options - uploader options\n * @returns {PictureUploadData}\n * @example\n * const src = ref(null)\n *\n * const {state, handleUpload} = usePictureUpload({\n *  preserveRatio: true,\n * })\n *\n * watch(()=>state.output, file => src.value = file.content)\n */\n\nexport function usePictureUpload({\n  preserveRatio = false,\n  picSize = 100,\n  maxSize = 10240000,\n} = {}) {\n  const state = reactive({\n    errors: [],\n    status: null,\n    output: {},\n  });\n\n  function handleChange(event) {\n    const fileList = event.target.files;\n    reset();\n    if (!fileList.length) return;\n    state.status = \"loading\";\n    [...fileList].map((file) => processFile(file));\n  }\n\n  function processFile(file) {\n    fileToBase64(file).then((res) => {\n      state.output = {\n        name: sanitizeFileName(file.name),\n        content: res,\n        size: niceBytes(Math.round((res.length * 3) / 4)),\n      };\n      state.status = \"success\";\n    });\n    return null;\n  }\n\n  function fileToBase64(file) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader(),\n        readerBase64 = new FileReader(),\n        blob = file.slice(0, 4);\n      reader.readAsArrayBuffer(blob);\n      reader.onloadend = (e) => {\n        let isValidMimeType = checkMimetype(\n          getMimeTypeSignature(e.target.result)\n        );\n\n        if (bytesToMegabytes(file.size) > bytesToMegabytes(maxSize)) {\n          state.errors.push({\n            message: \"File size is too large!\",\n          });\n        }\n\n        if (isValidMimeType === false) {\n          state.errors.push({\n            message: \"File type is not supported!\",\n          });\n        }\n\n        if (state.errors.length > 0) {\n          flashErrors(state.errors);\n          reset();\n          return;\n        } else {\n          readerBase64.readAsDataURL(file);\n        }\n      };\n\n      readerBase64.onloadend = () => {\n        const img = new Image();\n        img.src = readerBase64.result;\n        img.onload = () => {\n          const naturalAspect = preserveRatio\n            ? img.naturalWidth / img.naturalHeight\n            : 1;\n\n          const canvas = document.createElement(\"canvas\");\n          canvas.width = picSize;\n          canvas.height = picSize / naturalAspect;\n\n          const context = canvas.getContext(\"2d\");\n          context.drawImage(img, 0, 0, canvas.width, canvas.height);\n          resolve(canvas.toDataURL());\n        };\n      };\n\n      reader.onerror = (error) => reject(error);\n      readerBase64.onerror = (error) => reject(error);\n    });\n  }\n\n  // Resets upload\n  function reset() {\n    state.status = \"\";\n    state.errors = [];\n    state.output = {};\n  }\n\n  // Converts from bytes to megabytes\n  function bytesToMegabytes(bytes) {\n    const value = bytes * Math.pow(10, -6);\n    return value;\n  }\n\n  // Checks mime type (more at https://mimesniff.spec.whatwg.org/#matching-an-image-type-pattern )\n  // More info https://stackoverflow.com/questions/18299806/how-to-check-file-mime-type-with-javascript-before-upload\n  function checkMimetype(signature) {\n    const signatures = [\n      \"89504E47\", // image/png\n      \"47494638\", // image/gif\n      \"FFD8FFDB\", // image/jpeg\n      \"FFD8FFE0\",\n      \"FFD8FFE1\",\n      \"FFD8FFE2\",\n      \"FFD8FFE3\",\n      \"FFD8FFE8\",\n      \"FFD8FFED\",\n      \"3C3F786D\", // svg/xml\n      \"3C737667\",\n    ];\n    return signatures.includes(signature);\n  }\n\n  function getMimeTypeSignature(data) {\n    const uint = new Uint8Array(data);\n    let bytes = [];\n    uint.forEach((byte) => {\n      bytes.push(byte.toString(16));\n    });\n    return bytes.join(\"\").toUpperCase();\n  }\n\n  // Sanitizes file's name\n  function sanitizeFileName(name) {\n    return (\n      name\n        .replace(/\\.[^/.]+$/, \"\")\n        // .replace(/[^a-z0-9]/gi, \"_\")\n        .toLowerCase()\n    );\n  }\n\n  function flashErrors(errors) {\n    if (errors.length === 2) {\n      console.error(\"File upload failed due to size and type!\");\n    } else {\n      console.error(errors[0].message + errors[0].type);\n    }\n  }\n\n  return {\n    state,\n    handleChange,\n  };\n}\n\nconst units = [\"bytes\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"];\n\nfunction niceBytes(x) {\n  let l = 0,\n    n = parseInt(x, 10) || 0;\n\n  while (n >= 1024 && ++l) {\n    n = n / 1024;\n  }\n  return n.toFixed(n < 10 && l > 0 ? 1 : 0) + \" \" + units[l];\n}\n\nexport function base64MimeType(encoded) {\n  var result = null;\n  if (typeof encoded !== \"string\") {\n    return result;\n  }\n  var mime = encoded.match(/data:([a-zA-Z0-9]+\\/[a-zA-Z0-9-.+]+).*,.*/);\n  if (mime && mime.length) {\n    result = mime[1];\n  }\n  return result;\n}\n\nexport function base64FileType(encoded) {\n  return encoded.match(/[^:]\\w+\\/[\\w-+\\d.]+(?=;|,)/)?.[0];\n}\n\nexport function base64Extension(encoded) {\n  return encoded.substring(\n    encoded.indexOf(\"/\") + 1,\n    encoded.indexOf(\";base64\")\n  );\n}\n\nvar signatures = {\n  JVBERi0: \"application/pdf\",\n  R0lGODdh: \"image/gif\",\n  R0lGODlh: \"image/gif\",\n  iVBORw0KGgo: \"image/png\",\n  \"/9j/\": \"image/jpg\",\n};\n\nexport function detectMimeType(b64) {\n  for (var s in signatures) {\n    if (b64.indexOf(s) === 0) {\n      return signatures[s];\n    }\n  }\n}\n\n// DRAG AND DROP\n//https://medium.com/devschacht/https-medium-com-kasimoka-joseph-zimmerman-drag-drop-file-uploader-vanilla-js-de850d74aa2f\n//https://github.com/quarklemotion/html5-file-selector/blob/master/src/Html5FileSelector.js\n","/**\n * Handle Markdown files\n * @module useMd\n * */\n\nimport yaml from \"yaml\";\nimport markdown from \"markdown-it\";\nimport externalLinks from \"markdown-it-external-links\";\n\n/**\n * @typedef {Object} Md\n * @property {Object} frontmatter\n * @property {object} content\n */\n\n/**\n *  Create markdown with frontmatter\n * @param {Md} md -  frontmatter,content\n * @returns Markdown text file ready to download\n */\n\nexport function createMd({ frontmatter = null, text = \"\" } = md) {\n  let front = \"\";\n  if (typeof frontmatter == \"object\") {\n    let yml = yaml.stringify(frontmatter);\n    front = `---\n${yml}---\n `;\n    return front + text;\n  }\n}\n\n/**\n * Parse text content of a markdown file into an object\n * @param {String} file - Text form of an uploaded file\n * @returns {Md} - An object with md frontmatter and content\n */\nexport function parseMd(file) {\n  const yamlBlockPattern = /^(?:\\-\\-\\-)(.*?)(?:\\-\\-\\-|\\.\\.\\.)(?:\\n*\\s*)(.*)/s;\n  const yml = yamlBlockPattern.exec(file.trim());\n  let frontmatter, content;\n\n  if (yml) {\n    frontmatter = yml[1];\n    content = yml?.[2];\n    try {\n      frontmatter = yaml.parse(frontmatter);\n    } catch {\n      frontmatter = {};\n    }\n    return { frontmatter, content };\n  } else {\n    return { frontmatter: {}, content: file.trim() };\n  }\n}\n\nexport function useMd() {\n  const md = new markdown({\n    linkify: true,\n    typographer: true,\n  });\n\n  md.use(externalLinks, {\n    externalTarget: \"_blank\",\n  });\n  return md;\n}\n","/**\n * Get and handle a particular post by it's tag and hash\n * @module usePost\n */\n\nimport { computed, reactive, ref } from \"vue\";\nimport ms from \"ms\";\n\nimport { useGun, gun, useRoom, currentRoom, useUser } from \"..\";\nimport { useZip } from \"../file/\";\nimport { hashObj, hashText, safeHash } from \"../crypto\";\n\n/**\n * An interface to manage a post\n * @param {Object} options\n * @returns {Post}\n * @example\n * const post = usePost({ tag: 'tag', hash: postHash })\n */\n\nexport function usePost({ hash = \"\", loadMedia = true } = {}) {\n  const gun = useGun();\n\n  const post = reactive({});\n\n  gun\n    .get('posts')\n    .get(`#index`)\n    .get(hash)\n    .on(async (d, k) => {\n      try {\n        Object.assign(post, JSON.parse(d));\n      } catch (e) {\n        post.raw = d;\n      }\n      if (loadMedia) {\n        [\"icon\", \"cover\", \"text\"].forEach((file) => {\n          if (post[file]) {\n            gun\n              .get('posts')\n              .get(`#${file}`)\n              .get(post[file])\n              .on((data) => {\n                post[file] = data;\n              });\n          }\n        });\n      }\n\n    });\n\n  const downloading = ref(false);\n\n  async function download() {\n    downloading.value = true;\n    await downloadPost(post);\n    downloading.value = false;\n  }\n  return { post, download, downloading };\n}\n\n/**\n * @typedef {Object} Post\n * @property {Boolean} empty - whether the post has contents\n * @property {String} tag - the tag under which the post was published\n * @property {String} hash - the hash of the contents\n * @property {Object} data - the contents of the post\n * @property {Function} download - use this function to download the post as a Markdown file\n * @example\n * {\n *  \"empty\": false,\n *  \"tag\": \"ds\",\n *  \"hash\": \"C8trDBYNyvxVedHK4Q0IuUarc/k2/iiv8opPfoAU0xA=\",\n *  \"data\": {\n *    \"cover\": \"data:image/png;base64,..........\",\n *    \"icon\": \"data:image/png;base64,..........\",\n *    \"title\": \"OSS\",\n *    \"statement\": \"New live album by tsoop\",\n *    \"youtube\": \"K2MwpOd8vEI\",\n *    \"content\": \"It's mostly op-z + op-1 with my own Unity visuals based on [Chromatone](https://chromatone.center) system.\\n\\n### 2021\\nFirst played live at April 20th **2021**.\\n\\n### Into 2022\\nIt's an ongoing live album to be recorded throughout the **2022**.\"\n * },\n *  \"timestamp\": 1642590655747,\n *  \"lastUpdated\": \"1d\"\n * }\n */\n\n/**\n * Add a new post to a tag\n * @param {String} tag\n * @param {Object} post\n * @example\n * import { addPost } from '@gun-vue/composables'\n *\n * addPost('MyTag', {\n *  title: 'New post'\n * })\n */\n\nexport async function addPost(to, post) {\n  const { user } = useUser();\n  const { icon, cover, text } = post;\n  post.icon = await saveToHash(\"icon\", post.icon);\n  post.cover = await saveToHash(\"cover\", post.cover);\n  post.text = await saveToHash(\"text\", post.text);\n  const { hashed, hash } = await hashObj(post);\n  console.log(hash, post, to)\n  gun.get('posts').get(`#index`).get(`${hash}`).put(hashed);\n  gun\n    .user(currentRoom.pub)\n    .get(\"posts\")\n    .get(`${to}:${hash}@${user.pub}`)\n    .put(true, null, { opt: { cert: currentRoom.features?.posts } });\n\n}\n\n/**\n * Download the post as a zip file with MD contents and icon and cover pictures if present\n * @param {Post} post\n * @example\n * import { downloadPost, usePost } from '@gun-vue/composables'\n *\n * const {post} = usePost( postTag, postHash )\n *\n * downloadPost(post)\n */\n\nexport async function downloadPost(post) {\n  let { title } = post;\n\n  const { zipPost, addFile, downloadZip } = useZip();\n\n  let singleFile = false;\n\n  if (title && !post.raw) {\n    await zipPost({ ...post });\n  } else {\n    title = \"file\";\n    singleFile = true;\n    const hash = await hashText(post.raw);\n    await addFile({\n      title: safeHash(hash),\n      file: post.raw,\n    });\n  }\n\n  await downloadZip({ title });\n  return true;\n}\n\nexport async function loadFromHash(category, hash) {\n  if (\n    category &&\n    hash &&\n    typeof hash == \"string\" &&\n    hash.length == 44 &&\n    hash.slice(0, 5) != \"data:\"\n  ) {\n    return await gun.get('posts').get(`#${category}`).get(hash).then();\n  }\n  return hash;\n}\n\nasync function saveToHash(category, text) {\n  if (category && text) {\n    const hash = await hashText(text);\n    gun.get('posts').get(`#${category}`).get(`${hash}`).put(text);\n    return hash;\n  } else {\n    return text;\n  }\n}\n\n/**\n * Parse a post string from db\n * @param {String} data Stringified data from the hashed post\n * @returns {Object} Post object\n */\n\nexport async function parsePost(data) {\n  let post;\n  try {\n    post = JSON.parse(data);\n  } catch (e) {\n    post = { base64: data };\n  }\n  return post;\n}\n\n/**\n * Get and update the timestamp of an immutable post\n * @param {} - {tag, hash} \n * @returns {} - {timestamp, msTime, refresh}\n */\n\nexport function usePostTimestamp({ tag, hash } = {}) {\n  const timestamp = ref(0)\n\n  const msTime = computed(() => ms(Date.now() - timestamp.value || 1000))\n\n  gun\n    .get('posts')\n    .get(`#index`)\n    .get(hash)\n    .on(function (d, k, g) {\n      timestamp.value = g.put['>']\n    })\n\n  async function refresh() {\n    let data = await gun.get('posts').get(`#index`).get(hash).then();\n    gun.get('posts').get(`#index`).get(hash).put(data);\n  }\n  return { timestamp, msTime, refresh }\n}","/**\n * Get and handle a particular post by it's tag and hash\n * @module usePosts\n */\n\nimport { computed, reactive, ref } from \"vue\";\n\nimport JSZip from \"jszip\";\n\nimport { detectMimeType, useZip, parseMd, currentRoom, useUser, isHash } from \"..\";\nimport { useGun, gun } from \"../gun\";\nimport { parsePost, addPost, usePost } from \".\";\n\n/**\n * @typedef usePosts\n * @property {ref} posts -  the reactive list of hashed data\n * @property {ref} timestamps - reactive timestamps list for all posts in a list\n * @property {computed} count - the number of posts in a feed\n * @property {Function} downloadPosts - Download all posts in a zip file\n * @property {Function} uploadPosts - upload a zip file with posts\n */\n\n/**\n * Use a list of immutable data from a #tag\n * @param {String} tag - A vue ref to watch - generated from props by `toRef(props,'tag')`\n * @param {Object} options - Options for the feed\n * @returns {usePosts}\n * @example\n * import { usePosts } from '@gun-vue/composables'\n *\n * const { posts, timestamps, count, uploadPosts, downloadPosts} = usePosts('MyTag')\n */\nexport function usePosts(tag) {\n  if (!tag) return\n  const gun = useGun();\n\n  const posts = reactive({});\n  const backlinks = reactive({});\n\n  gun\n    .user(currentRoom.pub)\n    .get(\"posts\")\n    .map()\n    .on(function (data, key) {\n      let index = key.indexOf(tag);\n      if (index == -1) return;\n      let author = key.slice(-87);\n      let from = key.slice(0, 44);\n      let to = key.slice(45, 89);\n      if (index == 0) {\n        posts[to] = posts[to] || {};\n        posts[to][author] = data;\n      } else {\n        backlinks[from] = backlinks[from] || {};\n        backlinks[from][author] = data;\n      }\n    });\n\n\n  const countPosts = computed(() => {\n    let count = 0;\n    for (let hash in posts) {\n      inner_loop: for (let author in posts[hash]) {\n        if (posts[hash][author]) {\n          count++;\n          break inner_loop;\n        }\n      }\n    }\n    return count;\n  });\n\n  const countBacklinks = computed(() => {\n    let count = 0;\n    for (let hash in backlinks) {\n      inner_loop: for (let author in backlinks[hash]) {\n        if (backlinks[hash][author]) {\n          count++;\n          break inner_loop;\n        }\n      }\n    }\n    return count;\n  });\n\n  const downloading = ref(false);\n\n  async function downloadPosts() {\n    downloading.value = true;\n    downloading.value = !(await downloadFeed(tag, posts));\n  }\n\n  function uploadPosts(ev) {\n    uploadFeed(tag, ev);\n  }\n\n  return {\n    posts,\n    backlinks,\n    countPosts,\n    countBacklinks,\n    downloadPosts,\n    downloading,\n    uploadPosts\n  };\n}\n\n\n\n\n\n/**\n * Export a list of posts as a zip file\n * @async\n * @param {String} tag - Name of the tag\n * @param {Object} posts - Posts to export\n * @example\n * import {downloadFeed} from '@gun-vue/components'\n *\n * downloadFeed('myTag',posts)\n */\n\nexport async function downloadFeed(tag, posts) {\n  if (!posts) return;\n\n  const { zip, zipPost, downloadZip } = useZip();\n  const fullPosts = {};\n  for (let hash in posts) {\n    fullPosts[hash] = usePost({ tag, hash }).post;\n    await zipPost({ ...fullPosts[hash] });\n  }\n\n  await downloadZip({ title: `#${tag}` });\n  return true;\n}\n\n/**\n * Upload zip files and add all the MD files from it to the tag\n * @param {String} tag - a tag to add the posts to\n * @param {FileList} files - File list from the input `@change` event\n * @example\n * import { uploadFeed } from '@gun-vue/composables'\n * @example @lang html\n * <input type=\"file\" @change=\"uploadFeed( 'myTag', $event.target.files )\" />\n */\nexport function uploadFeed(tag, files) {\n  [...files].forEach(async (file) => {\n    const zip = await JSZip.loadAsync(file);\n    if (zip.comment) {\n      console.info(\"Zip file comment: \" + zip.comment);\n    }\n    zip.forEach(async (path, entry) => {\n      if (path.endsWith(\"index.md\")) {\n        let title = path.slice(0, -9);\n        let md = await entry.async(\"string\");\n        let { frontmatter, content } = parseMd(md);\n        frontmatter = frontmatter || {};\n        frontmatter.title = frontmatter?.title || title;\n        if (frontmatter.icon) {\n          const icon = await zip\n            .file(`${title}/${frontmatter.icon}`)\n            .async(\"base64\");\n          const iconMime = detectMimeType(icon);\n          frontmatter.icon = `data:${iconMime};base64,${icon}`;\n        }\n        if (frontmatter.cover) {\n          const cover = await zip\n            ?.file(`${title}/${frontmatter.cover}`)\n            ?.async(\"base64\");\n          const coverMime = detectMimeType(cover);\n          frontmatter.cover = `data:${coverMime};base64,${cover}`;\n        }\n        let post = { ...frontmatter, content };\n        addPost(tag, post);\n      }\n    });\n  });\n}\n","/**\n * Get and handle a particular post by it's tag and hash\n * @module useTags\n */\n\nimport { computed, reactive, ref } from \"vue\";\nimport slugify from \"slugify\";\nimport Fuse from \"fuse.js\";\nimport { useGun } from \"../gun\";\nimport { hashText } from \"../crypto\";\n\n/**\n * @typedef useTagList\n * @property {ref} search - a ref to bind to an input element\n * @property {computed} slug - a slugified search query - url safe verion to be used as a tag\n * @property {Tags} tags - the object to handle all the tags\n * @property {Function} addTag - add a slug tag to the list\n */\n\n/**\n * Toolkit to deal with the available tags\n * @returns {useTagList}\n */\nexport function useTagList() {\n  const gun = useGun();\n\n  const search = ref();\n  const slug = computed(() => slugify(search.value));\n\n  const tags = reactive({\n    list: {},\n    all: computed(() => {\n      const arr = [];\n      for (let t in tags.list) {\n        arr.push({\n          hash: t,\n          tag: tags.list[t],\n        });\n      }\n      return arr.sort((a, b) =>\n        a && b && a.tag.toLowerCase() < b.tag.toLowerCase() ? -1 : 1\n      );\n    }),\n    count: computed(() => tags.all.length),\n    fuse: computed(() => {\n      return new Fuse(tags.all, {\n        includeScore: true,\n        keys: [\"tag\"],\n      });\n    }),\n    results: computed(() => {\n      if (!search.value) return [];\n      let res = tags.fuse.search(slug.value);\n      return res;\n    }),\n    minScore: computed(() => {\n      let min = 100;\n      tags.results.forEach((res) => {\n        if (res.score < min) {\n          min = res.score;\n        }\n      });\n      return min;\n    }),\n  });\n\n  gun\n    .get(\"#tags\")\n    .map()\n    .on((d, k) => {\n      if (!d) return;\n      try {\n        data = JSON.parse(d); //ignore objects\n      } catch (e) {\n        tags.list[k] = d; // assumes tag is a plain string\n      }\n    });\n\n  async function addTag(tag = slug.value) {\n    if (!tag) return;\n    let safe = slugify(tag);\n    const hash = await hashText(safe);\n    gun.get(`#tags`).get(`${hash}`).put(safe);\n  }\n\n  return { search, slug, tags, addTag };\n}\n\n\n\nexport function listPersonalTag(tag, pub = currentRoom.pub) {\n  const gun = useGun();\n  const records = reactive({});\n  gun\n    .user(pub)\n    .get(`${tag}`)\n    .map()\n    .on(function (data, key) {\n      let k = key.substring(0, 87);\n      records[k] = records[k] || {};\n      records[k][key.substring(88)] = data;\n    });\n  return records;\n}\n\nexport async function addHashedPersonal(tag, obj, pub = currentRoom.pub, cert) {\n  if (!cert) cert = await gun.get(`~${pub}`).get(\"features\").get(tag).then();\n  if (!cert && pub == rootRoom.pub) {\n    cert = rootRoom.features?.[`#${tag}`];\n  }\n  if (!cert && pub != user.pub) {\n    console.log(\"No certificate found\");\n    return;\n  }\n  const { hashed, hash } = await hashObj(obj);\n  gun\n    .get(`~${pub}`)\n    .get(`#${tag}`)\n    .get(`${hash}@${user.pub}`)\n    .put(hashed, null, { opt: { cert } });\n}\n\nexport function getHashedPersonal(tag, hash, pub = currentRoom.pub) {\n  const record = reactive({});\n  gun\n    .get(`~${pub}`)\n    .get(`#${tag}`)\n    .map()\n    .once(function (data, key) {\n      if (key.includes(hash)) {\n        record.hash = hash;\n        record.tag = tag;\n        record.data = safeJSONParse(data);\n        record.authors = record.authors || {};\n        record.authors[key.slice(-87)] = true;\n      }\n    });\n  return { record };\n}\n","/**\n * React to posts with emojis\n * @module useReaction\n */\n\n\nimport { useUser, currentRoom, getFirstEmoji, useGun } from '..';\nimport { ref, watchEffect } from 'vue'\n\nconst rootsTags = ['rooms']\n\n\nexport function useReaction({ tag, hash, back } = {}) {\n\n  const { user } = useUser();\n\n  const reaction = ref('👍')\n\n  const gun = useGun()\n\n  const roomDb = gun.user(currentRoom.pub)\n\n  watchEffect(() => {\n    if (rootsTags.includes(tag)) {\n      roomDb.get(tag).get(`${hash}@${user.pub}`).on(d => {\n        if (d && d !== true) {\n          reaction.value = d\n        }\n      })\n    } else {\n      roomDb.get('posts').get(`${tag}:${hash}@${user.pub}`).on(d => {\n        if (d && d !== true) {\n          reaction.value = d\n        }\n      })\n    }\n  })\n\n\n  function react(r) {\n    reactToPost({ tag, hash, back, reaction: getFirstEmoji(r ? r : reaction.value) })\n  }\n  return { reaction, react }\n}\n\n\nexport async function reactToPost({ tag, hash, back, reaction = true } = {}) {\n  const { user } = useUser();\n  const gun = useGun();\n  console.log(tag, hash, reaction)\n  if (tag == \"rooms\") {\n    let myPost = gun.user(currentRoom.pub).get(tag).get(`${hash}@${user.pub}`);\n    let current = await myPost.then();\n    myPost.put(!current ? reaction : null, null, {\n      opt: { cert: currentRoom.features?.[tag] },\n    });\n  } else {\n    let myLink = gun.user(currentRoom.pub).get(\"posts\");\n    if (!back) {\n      myLink = myLink.get(`${tag}:${hash}@${user.pub}`);\n    } else {\n      myLink = myLink.get(`${hash}:${tag}@${user.pub}`);\n    }\n\n    let current = await myLink.then();\n    myLink.put(!current ? reaction : null, null, {\n      opt: { cert: currentRoom.features?.posts },\n    });\n  }\n}\n\n","/**\n * Reactions to posts with emojis\n * @module useReactions\n */\n\nimport { useGun, currentRoom, isEmoji, useUser, reactToPost } from '../';\nimport { reactive, ref, computed } from 'vue'\n\n\nexport function useReactions(authors) {\n  const reactions = {}\n  for (let pub in authors) {\n    let reaction = authors[pub]\n    if (reaction) {\n      reactions[reaction] = reactions[reaction] || []\n      reactions[reaction].push(pub)\n    }\n\n  }\n  return reactions\n}\n\nexport function countRating(authors) {\n  let count = 0\n  for (let author in authors) {\n    if (authors[author] && authors[author] != '🗑') {\n      count++\n    } else if (authors[author] == '🗑') {\n      count--\n    }\n  }\n  return count\n}\n\n\nexport function useUserPosts(pub) {\n  const gun = useGun()\n  const posts = reactive({})\n  gun.user(currentRoom.pub).get('posts').map().on((d, k) => {\n    let author = k.slice(90);\n    let from = k.substring(0, 44)\n    let to = k.substring(45, 89)\n    if (author == pub) {\n      if (d) {\n        posts[d] = posts[d] || {}\n        posts[d][to] = from\n      } else {\n        delete posts?.[d]?.[to]\n      }\n\n    }\n  })\n  return posts\n}","/**\n * Read and write zip files\n * @module useZip\n * @see https://github.com/Stuk/jszip\n * */\n\nimport JSZip from \"jszip\";\nimport { downloadFile, base64Extension, base64FileType } from \"./useFile\";\nimport { genUUID, SEA } from \"../gun/\";\nimport { createMd } from \"./useMd\";\nimport { loadFromHash } from \"../posts\";\n\n/**\n * @typedef useZip\n * @property {JSZip} zip - a JSZip instance\n * @property {Function} zipPost - treats a post with md contents and cover and icon images and adds them to the zip\n * @property {Function} addMd - add a MD file to the zip\n * @property {Function} addFile - add a binary file to the zip\n * @property {Function} downloadZip - initiate the download of the zip file\n */\n\n/**\n * Zip file creation toolbox\n * @returns {useZip}\n * @example\n * import {useZip} from '@gun-vue/composables'\n * const { zip, zipPost, addMd, addFile, downloadZip } = useZip()\n */\n\nexport function useZip() {\n  const zip = new JSZip();\n\n  /**\n   * Add a binary file to the zip\n   * @async\n   * @param {Object} options\n   * @returns {String} the resulting filename\n   * @example\n   *  if (post.cover) { // a base64 encoded picture\n   *   const fileName = await addFile({\n   *     title: \"cover\",\n   *     file: post.cover,\n   *     folder: post.title,\n   *   });\n   *   post.cover = fileName;\n   * }\n   */\n\n  async function addFile({ title, file, folder = \".\" } = {}) {\n    const fileType = base64FileType(file);\n    const extension = base64Extension(file);\n    const blob = await fetch(file).then((res) => res.blob());\n    const fileName = `${title}.${extension}`;\n    zip.file(`${folder}/${fileName}`, blob, fileType);\n    return fileName;\n  }\n\n  function addMd({ md, title } = {}) {\n    zip.file(`${title}/index.md`, createMd(md), \"text/markdown\");\n  }\n\n  /**\n   * Zips the whole post object\n   * @param {Object} post\n   * @async\n   */\n\n  async function zipPost(post = {}) {\n    let { icon, cover, text, title, statement } = post;\n    delete post?.text;\n    if (!title) {\n      title = statement ? statement.split(0, 12) : genUUID();\n    }\n\n    const files = [\"cover\", \"icon\"];\n\n    for (let type of files) {\n      let file = await loadFromHash(type, post[type]);\n      if (file) {\n        const fileName = await addFile({\n          title: type,\n          file,\n          folder: title,\n        });\n\n        post[type] = fileName;\n      }\n    }\n\n    text = await loadFromHash(\"text\", text);\n\n    addMd({\n      title,\n      md: {\n        frontmatter: post,\n        text,\n      },\n    });\n  }\n\n  async function downloadZip({ title = \"\", addDate = true } = {}) {\n    let now = new Date();\n    const offset = now.getTimezoneOffset();\n    now = new Date(now.getTime() - offset * 60 * 1000);\n    const date = now.toISOString().split(\"T\")[0];\n\n    const blob = await zip.generateAsync({\n      type: \"blob\",\n      comment: `Exported from ${title} at ${location} on ${date}`,\n      compression: \"DEFLATE\",\n      compressionOptions: {\n        level: 9,\n      },\n    });\n\n    const fileName = `${title}-${date}.zip`;\n\n    downloadFile(blob, \"application/zip\", fileName);\n    return true;\n  }\n\n  return { zip, zipPost, addMd, addFile, downloadZip };\n}\n","export const rootRoom = {\n  \"pub\": \"OUlhoY2Eq8QkZE_iWN3l6J2vvbkX33vowcFdqFoCoEQ.a-B1ImQK4aoiEpdW-38MAPc8oi16DHY57bDJ4dEZpX0\",\n  \"hosts\": {\n    \"jFjrmOEaRy-GAJlOCdG4SGoaLm_4AGMPP1sfmzYPwwo.mp2H7IQuTWlFSahN6ZnXN9Za0pD3thiIYUyGCaMel-M\": {\n      \"enc\": \"SEA{\\\"ct\\\":\\\"pvG4zoG5OIM7gyT5Jsh+PuFLAf200NKIpa7X/OxNm+lneWOD6avNS9iEXx9GgTM18iSdE3CBrKydusfLcqiXFFfMZivXsUTnf2Mbe702drcEcr7x9JTRhEqo3ptmunn+a+NUtfOPeExNFSCKoqfdMzSIR/nZFdW/qGcV5DDZOjuYdbV9Sh1rbvDPThJNJERz3WioLv3SodSXo4J5pq+2NujebALBabIZJYw2RXOxPjRMSnaYjT4lAZTA3FCy4mmP9fReVNw46Zjs6GYoZzIer0E4q5thRKyzf9IDFRJLfwpjejYY/fQWW4YFffN+1QBOjDAysCws+nCBSmFeKuAr2vFTvzdUI7gcoeKOc16BRnTC5NF8qQnXMS4XoilvueQ4as2mffG6iEwUiU5TicZO77+fARiUfG5WIgjEdkE=\\\",\\\"iv\\\":\\\"a6bjav88otAnmjv6iB/r\\\",\\\"s\\\":\\\"W+WzjXaZ4EAu\\\"}\",\n      \"profile\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"jFjrmOEaRy-GAJlOCdG4SGoaLm_4AGMPP1sfmzYPwwo.mp2H7IQuTWlFSahN6ZnXN9Za0pD3thiIYUyGCaMel-M\\\",\\\"w\\\":{\\\"*\\\":\\\"profile\\\"}},\\\"s\\\":\\\"YIGcs8VXeD4eB21MFPM/wnpJnMkmuxX6wjA/1GD170ATGBob9Ps3WCGtRUyhT2AmCIOe7oXpinZdtd3SCSZh/A==\\\"}\",\n      \"features\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"jFjrmOEaRy-GAJlOCdG4SGoaLm_4AGMPP1sfmzYPwwo.mp2H7IQuTWlFSahN6ZnXN9Za0pD3thiIYUyGCaMel-M\\\",\\\"w\\\":{\\\"*\\\":\\\"features\\\"}},\\\"s\\\":\\\"vhnmYfslzJm6qWTUBp4meKtlzAkIxyayRJa1KNeCFJT27T7UX4X//+t5giRX6Z/rIz3aWEPZX9UK3LLhc/J91g==\\\"}\",\n      \"hosts\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"jFjrmOEaRy-GAJlOCdG4SGoaLm_4AGMPP1sfmzYPwwo.mp2H7IQuTWlFSahN6ZnXN9Za0pD3thiIYUyGCaMel-M\\\",\\\"w\\\":{\\\"*\\\":\\\"hosts\\\"}},\\\"s\\\":\\\"2x5ZTh1NYv+eCtRKwlKItC1j9ZV5YhhiWJiaNq8Y+8YBF93aaagY6CT0YzLYFvG/fKTBWN4lldaeI+cFV88AbA==\\\"}\"\n    }\n  },\n  \"features\": {\n    \"rooms\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"*\\\",\\\"w\\\":{\\\"*\\\":\\\"rooms\\\",\\\"+\\\":\\\"*\\\"}},\\\"s\\\":\\\"iJjnFrGvM092KSqH9kUYJm0pBgd6HSg8b9kl9QPjdQYNDAZQe2btfDP6rXIVNPcYFIjEYqBCibuQhcAjODUQFg==\\\"}\",\n    \"space\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"*\\\",\\\"w\\\":{\\\"*\\\":\\\"space\\\",\\\"+\\\":\\\"*\\\"}},\\\"s\\\":\\\"eTZNu+acczsk8ew+UKCseanlVJ4prm+N1cvLXe2T6Bccfk6a7gR5EjvyBat4iCv97HpcoYtfcQO1ImhgVzP/bQ==\\\"}\",\n    \"posts\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"*\\\",\\\"w\\\":{\\\"*\\\":\\\"posts\\\",\\\"+\\\":\\\"*\\\"}},\\\"s\\\":\\\"g94jrn4qvausK0sf5ej+MDIqJr9QOyG6U/fwAfmjxWcxCSiVzra8ZhvwOA3PVsqdcRYMK9YFMZ2cNJhT84ew/w==\\\"}\",\n    \"chat\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"*\\\",\\\"w\\\":{\\\"*\\\":\\\"chat\\\",\\\"+\\\":\\\"*\\\"}},\\\"s\\\":\\\"Nclaw2A61Dzx6wLNeGSFr+od7bdj0jYftz/8XDRTZTUUp42xnD1Hyp2GbmFGKrY8be+60XOxYB0Tcp+ewkPimA==\\\"}\",\n    \"dict\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"*\\\",\\\"w\\\":{\\\"*\\\":\\\"dict\\\",\\\"+\\\":\\\"*\\\"}},\\\"s\\\":\\\"cmnSSjKGrbxEoJ3JyGfgeesLJ3fELC6aIy3nO4MmSLok4ZNxpx2HayQaQmi+8gfgwX86poYUm1WR2bDdUAgzmw==\\\"}\",\n    \"projects\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"*\\\",\\\"w\\\":{\\\"*\\\":\\\"projects\\\",\\\"+\\\":\\\"*\\\"}},\\\"s\\\":\\\"Zx/1sVapPoqx0pVMrMElSWVwBbD1AH0uPP11/tte2qHUmww458tqwRNfC3XMhZVl/fR589I3VWoUXSfNGDPj+g==\\\"}\",\n    \"gifts\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"*\\\",\\\"w\\\":{\\\"*\\\":\\\"gifts\\\",\\\"+\\\":\\\"*\\\"}},\\\"s\\\":\\\"YpWMF8FpZToI4KCc4ZxR4zBChQMF+C6HQF1maNpDyA6g9t/DY9tejELG+mc2CqcV9mDU/km2q7EeaZGnxQsREA==\\\"}\"\n  }\n}","/**\n * @module useRoom\n */\n\nimport {\n  SEA,\n  useGun2,\n  gun,\n  useGun,\n  generateCerts,\n  useUser,\n  user,\n  hashObj,\n  safeJSONParse,\n  hashText\n} from \"..\";\nimport { rootRoom } from \"./rootRoom\";\nimport { reactive, computed, ref, watchEffect } from \"vue\";\n\nexport const currentRoom = reactive({\n  pub: rootRoom.pub,\n  isRoot: computed(() => currentRoom.pub == rootRoom.pub),\n  hosts: {},\n  features: {},\n  profile: {},\n});\n\nwatchEffect(() => {\n  const gun = useGun();\n\n  if (currentRoom.pub == rootRoom.pub) {\n    currentRoom.hosts = rootRoom.hosts;\n    currentRoom.features = rootRoom.features;\n  } else {\n    currentRoom.features = {};\n    currentRoom.hosts = {};\n    gun\n      .user(currentRoom.pub)\n      .get(\"hosts\")\n      .map()\n      .once((d, k) => {\n\n        currentRoom.hosts[k] = d;\n      });\n    gun\n      .user(currentRoom.pub)\n      .get(\"features\")\n      .map()\n      .once((d, k) => {\n\n        currentRoom.features[k] = d;\n      });\n  }\n});\n\n\n/**\n * Reactive room controls\n * @returns {useRoom}\n */\n\nexport function useRoom(pub = currentRoom.pub) {\n  const room = reactive({\n    pub,\n    isRoot: pub != rootRoom.pub,\n    hosts: {},\n    features: {},\n    profile: {},\n  });\n\n  const gun = useGun();\n  gun\n    .user(pub)\n    .get(\"profile\")\n    .map()\n    .on((d, k) => {\n      room.profile[k] = d;\n    });\n  gun\n    .user(pub)\n    .get(\"hosts\")\n    .map()\n    .once((d, k) => {\n      room.hosts[k] = d;\n    });\n  gun\n    .user(pub)\n    .get(\"features\")\n    .map()\n    .once((d, k) => {\n      room.features[k] = d;\n    });\n\n  return {\n    room,\n    submitRoom,\n    enterRoom,\n    createRoom,\n    leaveRoom,\n    updateRoomProfile,\n  };\n}\n\nexport function useRoomLogo(pub = currentRoom.pub) {\n\n  const logo = ref()\n\n  gun.user(pub).get('profile').get('logo').on(hash => {\n    if (!hash) {\n      logo.value = null\n      return\n    }\n    gun.get('#logos').get(hash).once(d => {\n      logo.value = d\n    })\n  })\n\n  async function uploadLogo(file) {\n    if (file) {\n      const hash = await hashText(file)\n      gun.get('#logos').get(hash).put(file)\n      updateRoomProfile('logo', hash)\n    } else {\n      removeLogo()\n    }\n\n  }\n\n  function removeLogo() {\n    updateRoomProfile('logo', null)\n  }\n\n  return {\n    logo, uploadLogo, removeLogo\n  }\n}\n\nexport function useRooms() {\n  const rooms = computed(() => {\n    return listPersonal(\"rooms\", currentRoom.pub);\n  });\n  return { rooms, createRoom };\n}\n\nexport function listPersonal(tag, pub = currentRoom.pub) {\n  const gun = useGun();\n  const records = reactive({});\n  gun\n    .user(pub)\n    .get(`${tag}`)\n    .map()\n    .on(function (data, key) {\n      let k = key.substring(0, 87);\n      records[k] = records[k] || {};\n      records[k][key.substring(88)] = data;\n    });\n  return records;\n}\n\n/**\n * Update a profile field of a room\n * @param {String} field parameter to write to\n * @param {String} content\n */\n\nexport function updateRoomProfile(field, content) {\n  const gun = useGun();\n  const { user } = useUser();\n  let certificate = currentRoom.hosts?.[user.pub]?.profile;\n  gun\n    .user(currentRoom.pub)\n    .get(\"profile\")\n    .get(field)\n    .put(content, null, { opt: { cert: certificate } });\n}\n\n/**\n * Create a new room inside the current room\n */\n\nexport async function createRoom({ pair, name } = {}) {\n  const { user } = useUser();\n  // if (!pair) pair = await SEA.pair();\n  if (!pair) return;\n\n  const certs = await generateCerts({\n    pair,\n    list: [\n      { tag: \"profile\", users: [user.pub] },\n      { tag: \"features\", users: [user.pub] },\n      { tag: \"hosts\", users: [user.pub] },\n    ],\n  });\n  const features = await generateCerts({\n    pair,\n    list: [\n      { tag: \"rooms\", personal: true },\n      { tag: \"space\", personal: true },\n      { tag: \"posts\", personal: true },\n      { tag: \"chat\", personal: true },\n      { tag: \"dict\", personal: true },\n      { tag: \"projects\", personal: true },\n      { tag: \"gifts\", personal: true },\n    ],\n  });\n\n  const enc = await SEA.encrypt(pair, user.pair());\n  const dec = await SEA.decrypt(enc, user.pair());\n\n  console.log(\n    \"COPY THIS ROOM INFO TO USE IT AS A ROOT\",\n    {\n      pub: dec.pub,\n      hosts: { [user.pub]: { enc, ...certs } },\n      features,\n    },\n    \"STORE THIS KEY PAIR IN A SAFE PLACE\",\n    dec\n  );\n\n  const gun = useGun();\n  gun.user().get(\"safe\").get(\"rooms\").get(dec.pub).put(enc);\n\n  gun\n    .user(currentRoom.pub)\n    .get(\"rooms\")\n    .get(`${dec.pub}@${user.pub}`)\n    .put(true, null, { opt: { cert: currentRoom?.features?.rooms } });\n\n  const roomDb = gun.user(dec.pub);\n  roomDb\n    .get(\"hosts\")\n    .get(user.pub)\n    .put(\n      {\n        enc,\n        ...certs,\n      },\n      null,\n      { opt: { cert: certs.hosts } }\n    );\n  roomDb.get(\"features\").put(features, null, { opt: { cert: certs.features } });\n\n  if (name) {\n    roomDb.get(\"profile\").put({ name }, null, { opt: { cert: certs.profile } });\n  }\n\n  // enterRoom(pair.pub);\n}\n\nexport async function recreateRoom(enc) {\n  const dec = await SEA.decrypt(enc, user.pair());\n  createRoom({\n    pair: dec,\n  });\n}\n\nexport async function submitRoom(pub) {\n  const gun = useGun();\n  const already = await gun\n    .user(currentRoom.pub)\n    .get(\"rooms\")\n    .get(`${pub}@${user.pub}`)\n    .then();\n\n  gun\n    .user(currentRoom.pub)\n    .get(\"rooms\")\n    .get(`${pub}@${user.pub}`)\n    .put(!already, null, { opt: { cert: currentRoom.features?.rooms } });\n}\n\nexport function joinRoom() {\n  const gun = useGun();\n  gun\n    .user(currentRoom.pub)\n    .get(\"space\")\n    .get(user.pub)\n    .put(JSON.stringify({ x: Math.random(), y: Math.random() }), null, {\n      opt: { cert: currentRoom.features?.space },\n    });\n}\n\n/**\n * The right way to come inside a room\n * @param {String} pub\n */\n\nexport function enterRoom(pub) {\n  currentRoom.pub = pub;\n}\n\n/**\n * Leave the room\n */\n\nexport function leaveRoom() {\n  currentRoom.pub = rootRoom.pub;\n}\n\nexport async function addPersonal({\n  tag,\n  key,\n  text,\n  pub = currentRoom.pub,\n  cert,\n} = {}) {\n  if (!cert) cert = await gun.user(pub).get(\"features\").get(tag).then();\n  if (!cert) {\n    cert = currentRoom.features?.[`${tag}`];\n  }\n  if (!cert && pub != user.pub) {\n    console.log(\"No certificate found\");\n    return;\n  }\n  gun\n    .user(pub)\n    .get(`${tag}`)\n    .get(`${key}@${user.pub}`)\n    .put(text, null, { opt: { cert } });\n}\n","import { computed, ref, reactive, watchEffect } from \"vue\";\nimport { useGun, useAccount, getFirstEmoji, currentRoom } from \"..\";\n\nlet startTime = Date.now();\n\nexport function useGuests({ TIMEOUT = 10000 } = {}) {\n  const gun = useGun();\n\n  const guests = reactive({});\n  const online = reactive({});\n  const offline = reactive({});\n\n  const count = reactive({\n    total: computed(() => Object.keys(guests).length),\n    online: computed(() => Object.keys(online).length),\n    offline: computed(() => Object.keys(offline).length),\n  });\n\n  gun\n    .user(currentRoom.pub)\n    .get(\"space\")\n    .map()\n    .once((pos, pub) => {\n      const { account } = useAccount(pub);\n      guests[pub] = account;\n      guests[pub].order = computed(() =>\n        startTime - account.value.pulse < TIMEOUT\n          ? 1\n          : startTime - account.value.pulse\n      );\n      guests[pub].online = computed(() => {\n        return startTime - account.value.pulse < TIMEOUT;\n      });\n    });\n\n  watchEffect(() => {\n    for (let pub in guests) {\n      if (guests[pub].online) {\n        online[pub] = guests[pub];\n        delete offline[pub];\n      } else {\n        offline[pub] = guests[pub];\n        delete online[pub];\n      }\n    }\n  });\n\n  return { guests, online, offline, count };\n}\n","import { useNow, watchThrottled } from '@vueuse/core'\nimport { SEA } from 'gun'\nimport { reactive, computed, watch } from 'vue'\nimport { useGun, useUser, hashObj, currentRoom } from '..'\n\nimport { giftPath } from '.'\n\nexport function useGifts() {\n  const { user } = useUser()\n  const gun = useGun()\n\n  const gifts = reactive({})\n\n  gun.user(currentRoom.pub).get(giftPath).map().once((data, key) => {\n    gun.get('#' + giftPath).get(key.slice(0, -88)).once((d, k) => {\n      try {\n        const obj = JSON.parse(d)\n        gifts[k] = obj\n      } catch (e) {\n        // gifts[k] = d\n      }\n    })\n  })\n\n  return { gifts }\n}\n\n\nexport function useMyGifts() {\n  const { user } = useUser()\n  const gun = useGun()\n  const gifts = reactive({})\n  const from = reactive({})\n  const to = reactive({})\n\n  gun.user().get(giftPath).map().on((d, hash) => {\n    gun.get('#' + giftPath).get(hash).once(d => {\n      try {\n        d = JSON.parse(d)\n        gifts[hash] = d\n        if (d.from == user.pub) {\n          from[hash] = d\n        }\n        if (d.to == user.pub) {\n          to[hash] = d\n        }\n      } catch { }\n    })\n  })\n\n  const newGifts = reactive({})\n\n  gun.user(currentRoom.pub).get(giftPath).map().once(async (d, path) => {\n    let hash = path.slice(0, -88)\n    gun.get('#' + giftPath).get(hash).once(async (d) => {\n      try {\n        d = JSON.parse(d)\n        if (d.to == user.pub) {\n          let has = await gun.user().get(giftPath).get(hash).then()\n          if (!has) {\n            newGifts[hash] = d\n          }\n        }\n      } catch { }\n    })\n  })\n\n\n  return { gifts, from, to, newGifts }\n}\n\nexport function useProjectGifts(path) {\n  const pub = path.slice(-87)\n  const gun = useGun()\n  const gifts = reactive({})\n\n  gun.user(pub).get(giftPath).map().once((d, hash) => {\n    gun.get('#' + giftPath).get(hash).once(d => {\n      try {\n        d = JSON.parse(d)\n        if (d.project == path) {\n          gifts[hash] = { ...d, state: {} }\n\n          gun.user(d.from).get(giftPath).get(hash).on(data => { gifts[hash].state.from = data })\n          gun.user(d.to).get(giftPath).get(hash).on(data => { gifts[hash].state.to = data })\n        }\n\n      } catch { }\n    })\n  })\n\n\n\n  const collections = computed(() => {\n    let collections = {}\n    for (let hash in gifts) {\n      let gift = gifts[hash]\n      collections[gift.ql] = collections[gift.ql] || { list: {}, sum: 0, from: {} }\n      collections[gift.ql].list[hash] = gift\n    }\n\n    for (let q in collections) {\n      collections[q].sum = 0\n      collections[q].from = {}\n\n      for (let hash in collections[q].list) {\n\n        let colG = collections[q].list[hash]\n        if (!(colG.state.from && colG.state.to)) continue\n        collections[q].sum += Number(colG.qn)\n        collections[q].from[colG.from] = collections[q].from[colG.from] || 0\n        collections[q].from[colG.from] += Number(colG.qn)\n      }\n\n    }\n    return collections\n  })\n\n\n\n  return { gifts, collections }\n}","/**\n * Connections between accounts\n * @module useMates\n */\n\nimport { reactive, watch, ref, computed } from \"vue\";\nimport { useGun, user } from \"..\";\nimport GB from \"grapheme-breaker-mjs\";\n\n/**\n * @typedef {reactive} useMates\n */\n\n/**\n * Get a reactive list of the user's mates\n * @param {String} pub\n * @returns {useMates}\n */\n\nexport function useMates(pub) {\n  if (!pub) {\n    pub = user.pub;\n  }\n  const mates = reactive({});\n  const gun = useGun();\n  gun\n    .user(pub)\n    .get(\"mates\")\n    .map()\n    .once((text, matePub) => {\n      if (text) {\n        mates[matePub] = {\n          emoji: getFirstEmoji(text),\n          text,\n        };\n        gun\n          .user(matePub)\n          .get(\"mates\")\n          .get(pub)\n          .on((d) => {\n            if (d) {\n              mates[matePub].back = getFirstEmoji(d);\n            } else {\n              delete mates[matePub].back;\n            }\n          });\n      } else {\n        delete mates[matePub];\n      }\n    });\n  return mates;\n}\n\n/**\n * Break the string into graphemes and return the first one if it's an emoji\n * @param {String} text\n * @returns {String} Emoji\n */\n\nexport function getFirstEmoji(text, def = \"👋\") {\n  if (!text || typeof text != \"string\") return;\n  let em = GB.break(text)[0];\n  if (isEmoji(em)) {\n    return em;\n  } else {\n    return def;\n  }\n}\n\n/**\n * Check if the text has emojis\n * @param {String} text\n * @returns {Boolean}\n */\n\nexport function isEmoji(text) {\n  return /\\p{Extended_Pictographic}/u.test(text);\n}\n\n/**\n * @typedef {Object} useMate\n * @property {ref} emoji - change it in an input\n * @property {ref} isMate - reactive state of connection\n * @property {Function} toggleMate - toggle the link with current `emoji` ref\n */\n\n/**\n * Make mates with some account by current user\n * @param {String} pub\n * @returns {useMate}\n */\n\nexport function useMate(pub) {\n  const emoji = ref(\"👋\");\n  const isMate = ref(false);\n\n  const dbMate = user.db.get(\"mates\").get(pub);\n\n  dbMate.on((d) => {\n    isMate.value = getFirstEmoji(d);\n  });\n\n  function toggleMate() {\n    dbMate.put(isMate.value ? false : getFirstEmoji(emoji.value));\n  }\n  return { emoji, isMate, toggleMate };\n}\n","/**\n * Basic user management\n * @module useUser\n * */\n\nimport { gun, useGun } from \"..\";\nimport { useColor } from \"../ui\";\nimport { computed, reactive, ref } from \"vue\";\nimport ms from \"ms\";\n\nconst colorDeep = useColor(\"deep\");\n\nexport const selectedUser = reactive({\n  pub: null,\n});\n\n/**\n * @typedef {Object} Account - the user account interface\n * @property {ref} pub - The pub key used to build the account\n * @property {computed} color - The user account color derived from the pub key\n * @property {Object} profile - An object with all the `gun.user().get('profile')` data\n * @property {Number} pulse - latest timestamp from the user. It's emitted every second. Offline timeout is set to 10 seconds.\n * @property {Boolean} blink - A boolean that toggles on every timestamp received\n * @property {Sting} lastSeen - Shows 'online' if recent pulse is less then 10s ago or a human readable time string\n * @property {gun} db - `gun.user(pub)` ref to query any additional user data\n * @example\n * {\n * \"pub\": \"XnpLVDYZWdl1NNgo6BlD6e3-n3Fzi-ZzVrzbIgYCYHo.9-hHUHaWNaAE6tMp800MMzNtDLtjicS53915IrBu4uc\",\n * \"color\": \"#f55c3d\",\n * \"profile\": {\n *    \"name\": \"Accord\",\n *    \"Message\": \"Use your imagination!\",\n *    \"Money\": \"$ 20000000000\"\n * },\n * \"pulse\": 1642077216809,\n * \"lastSeen\": \"online\",\n * \"blink\": true\n * }\n */\n\n/**\n * @typedef {Object} User - An interface to the current gun user\n * @property {Boolean} initiated - `true` if useUser has been run at least once\n * @property {Object} is - Reactive `gun.user().is`\n * @property {String} pub - Current user public key\n * @property {String} color - a HEX color for the given pub\n * @property {Number} pulse - Last received pulse timestamp\n * @property {Number} pulser - An id for pulse `setInterval`\n * @property {Boolean} blink - Toggles with every pulse received\n * @property {Object} db - `gun.user()` reference\n * @property {Object} safe - safe account indicators\n * @property {Function} pair - use `user.pair()` to get curent user key pair\n * @example\n * { \n *  \"initiated\": true, \n *  \"is\": { \n *    \"pub\": \"XnpLVDYZWdl1NNgo6BlD6e3-n3Fzi-ZzVrzbIgYCYHo.9-hHUHaWNaAE6tMp800MMzNtDLtjicS53915IrBu4uc\", \n *    \"epub\": \"wAvPlMAg4jvUvK4sPpVyF1CAWnRCMu1YpHnoDrVDg-o.l79QDmdPCLEiO0F_WkB3zYLpJt-lANtyhNmHSM4bTes\", \n *    \"alias\": \"XnpLVDYZWdl1NNgo6BlD6e3-n3Fzi-ZzVrzbIgYCYHo.9-hHUHaWNaAE6tMp800MMzNtDLtjicS53915IrBu4uc\" \n *  }, \n *  \"name\": \"Accord\", \n *  \"pub\": \"XnpLVDYZWdl1NNgo6BlD6e3-n3Fzi-ZzVrzbIgYCYHo.9-hHUHaWNaAE6tMp800MMzNtDLtjicS53915IrBu4uc\", \n *  \"color\": \"#f55c3d\", \n *  \"pulse\": 1642708061615, \n *  \"pulser\": 12, \n *  \"blink\": false, \n *  \"safe\": { \n *    \"saved\": true, \n *    \"password\": null, \n *    \"enc\": \"SEA{\\\"ct\\\":\\\"E+6GViU9dTuidruOCNAoBITE+AlGNRgiABplSbL5fh4v1P+fhF33MuBwKd3ssBNi2kJ1sCzvS/YLmzivECA5ARZPGVbgXTSj8AE9kCz0Ac/8ushlsfBNdt8s3+a3OPVxMIevnT01uqcgr75Zp4TugIg/YuB5WltA9RHsgWEMlo+X+tRGaqG5rfw4sAmTSV0P8evMgM9rN/Un5t/WeDbvIPNXqZEmtxwAhMUZwOJWZckNZmNwpxnelFO0BwmauWfzkXuqGeSxNhMeaZi+VoRDMUvTjT68DLBnVoOhFhcdco+RW8AJfktZHZ4GF2IzFnQmTGpUd2LfvIY/Yn1eNJH7iQ5w41ChiYB/zhgQCOc5ur51PV6swAuN595vUNn7+0J1JRSNGzW2V/4j4YR4IEsAoqOtdn2Y21ga/CFdrE0=\\\",\\\"iv\\\":\\\"LtODTV+LBzhWHqUcptUO\\\",\\\"s\\\":\\\"XCL9Uj1YlPcV\\\"}\", \n *  \"pass\": \"SEA{\\\"ct\\\":\\\"8wNClMx/ebfou+gGWdf+bbx0TAgc9RU=\\\",\\\"iv\\\":\\\"NPgHkI+Ke+i/mw+3chlr\\\",\\\"s\\\":\\\"3VzGv06Y4fQ+\\\"}\" \n *  } \n * }\n\n */\n\nexport const user = reactive({\n  initiated: false,\n  auth: false,\n  is: null,\n  name: \"\",\n  pub: computed(() => user?.is?.pub),\n  color: computed(() => (user.pub ? colorDeep.hex(user.pub) : \"gray\")),\n  pulse: 0,\n  pulser: null,\n  blink: false,\n  safe: {\n    saved: null,\n    password: null,\n  },\n  pair() {\n    return gun?.user?.()?._?.sea;\n  },\n});\n\n/**\n * @typedef useUser\n * @property {User} user - the user interface\n * @property {Function} auth - auth with a pair\n * @property {Function} leave - log out\n */\n\n/**\n * Get access to current logged in user\n * @returns {useUser}\n * @example\n * import { useUser } from '@gun-vue/composables'\n *\n * const { user, auth, leave } = useUser()\n */\n\nexport function useUser() {\n\n\n  if (!user.initiated) {\n    const gun = useGun();\n    user.db = gun.user();\n    gun.user().recall({ sessionStorage: true }, () => {\n      console.log(\"user was recalled\");\n    });\n\n    gun.on(\"auth\", () => {\n      init();\n      console.log(\"user authenticated\");\n    });\n    user.initiated = true;\n  }\n\n\n  return { user, auth, leave };\n}\n\nfunction init() {\n  user.is = gun.user().is;\n  if (user.pulser) {\n    clearInterval(user.pulser);\n  }\n  user.pulser = setInterval(() => {\n    gun.user().get(\"pulse\").put(Date.now());\n  }, 1000);\n\n  gun.user().get('epub').put(user.is.epub)\n\n  gun\n    .user()\n    .get(\"pulse\")\n    .on((d) => {\n      user.blink = !user.blink;\n      user.pulse = d;\n    })\n\n  gun.user()\n    .get(\"safe\")\n    .map()\n    .on((d, k) => {\n      user.safe[k] = d;\n    });\n\n  gun\n    .user()\n    .get(\"profile\")\n    .get(\"name\")\n    .on((d) => (user.name = d));\n\n  user.initiated = true;\n}\n\n/**\n * Authenticate with a SEA key pair\n * @param {Object} pair\n * @example\n * import { auth, SEA } from '@gun-vue/composables'\n *\n * async function login() {\n *    const pair = await SEA.pair()\n *    auth(pair)\n * }\n */\n\nexport async function auth(pair, cb = () => { }) {\n  if (!isPair(pair)) {\n    // pair = await SEA.pair();\n    console.log(\"incorrect pair\", pair);\n    return;\n  }\n  gun.user().auth(pair, async () => {\n    cb(pair);\n    console.log(\"user is authenticated\");\n  });\n}\n\n/**\n * Log out the user\n * @example\n * import { leave } from '@gun-vue/composables'\n *\n * leave()\n **/\n\nexport function leave() {\n  let is = !!user.is?.pub;\n  user.initiated = false;\n  clearInterval(user.pulser);\n  gun.user().leave();\n  setTimeout(() => {\n    if (is && !user.pair()) {\n      user.is = null;\n      console.info(\"User logged out\");\n    }\n  }, 500);\n}\n\nexport function isMine(soul) {\n  if (!soul) return;\n  return soul.slice(1, 88) == user.pub;\n}\n\n/**\n * Add a field to the User profile\n * @param {String} name\n * @example\n * import { addProfileField } from '@gun-vue/composables'\n *\n * addProfileField( 'city' )\n */\n\nexport function addProfileField(title) {\n  gun.user().get(\"profile\").get(title).put(\"\");\n}\n\n/**\n * Update a profile field\n * @param {String} field\n * @param {Any} data\n * @example\n * import { updateProfile } from '@gun-vue/composables'\n *\n * updateProfile( 'city', 'Moscow' )\n */\n\nexport function updateProfile(field, data) {\n  if (field && data !== undefined) {\n    gun.user().get(\"profile\").get(field).put(data);\n  }\n}\n\n/**\n * Check if the object is a proper SEA pair\n * @param {Object} pair - an object to check\n * @returns {Boolean}\n */\n\nexport function isPair(pair) {\n  return (\n    pair &&\n    typeof pair == \"object\" &&\n    pair.pub &&\n    pair.epub &&\n    pair.priv &&\n    pair.epriv\n  );\n}\n","/**\n * Manage user's password and credentials\n * @module usePass\n */\n\nimport { computed, reactive, watchEffect } from \"vue\";\nimport { gun, useGun, SEA, auth, isPair, user } from \"..\";\nimport base32 from \"base32\";\n\n/**\n * @typedef {reactive} Pass\n * @property {Object} safe\n * @property {Object} dec\n */\n\nexport const pass = reactive({\n  input: \"\",\n  show: false,\n  safePair: false,\n  minLength: 5,\n  safe: {},\n  dec: {},\n  links: {\n    pass: computed(() => {\n      return genLink(pass.safe?.enc);\n    }),\n    pair: computed(() => {\n      return genLink(JSON.stringify(user.pair()));\n    }),\n  },\n\n  set() {\n    setPass(pass.input);\n    pass.input = \"\";\n    pass.show = false;\n  },\n});\n\nfunction genLink(text = \"\") {\n  let base = base32.encode(text);\n  return window.location.origin + window.location.pathname + \"#/auth/\" + base;\n}\n\nexport function parseLink(link) {\n  let index = link.indexOf(\"#/auth/\");\n  let base = link.substr(index + 7);\n  return base32.decode(base);\n}\n\nlet initiated = false;\n\n/**\n * Manage password of a user\n * @returns {usePass}\n */\n\nexport function usePass() {\n  if (!initiated) {\n    const gun = useGun();\n    gun\n      .user()\n      .get(\"safe\")\n      .map()\n      .on((d, k) => {\n        pass.safe[k] = d;\n      });\n\n    watchEffect(async () => {\n      if (!pass.show) {\n        pass.dec = {};\n        return;\n      }\n      if (pass?.show && pass?.safe?.pass) {\n        pass.dec.pass = await SEA.decrypt(pass.safe.pass, user.pair());\n        pass.input = pass.dec.pass;\n      }\n      if (pass.show && pass?.safe?.enc) {\n        pass.dec.pair = await SEA.decrypt(pass.safe.enc, pass.dec.pass);\n      }\n    });\n  }\n  initiated = true;\n\n  return { pass, setPass, logWithPass };\n}\n\n/**\n * @typedef {Object} usePass\n * @property {Pass} pass - the reactive password object\n * @property {Function} setPass\n * @property {Function} logWithPass\n */\n\nexport async function hasPass(pub) {\n  return await gun.get(`~${pub}`).get(\"safe\").get(\"enc\").then();\n}\n\nasync function logWithPass(pub, passphrase) {\n  let encPair = await gun.get(`~${pub}`).get(\"safe\").get(\"enc\").then();\n  let pair = await SEA.decrypt(encPair, passphrase);\n  auth(pair);\n}\n\nasync function setPass(text) {\n  let encPair = await SEA.encrypt(user.pair(), text);\n  let encPass = await SEA.encrypt(text, user.pair());\n  user.db.get(\"safe\").get(\"enc\").put(encPair);\n  user.db.get(\"safe\").get(\"pass\").put(encPass);\n}\n\nexport function usePassLink(data, passPhrase) {\n  if (!data) return;\n  const decoded = base32.decode(data);\n  if (decoded.substring(0, 3) == \"SEA\") {\n    if (passPhrase) {\n      logEncPass(decoded, passPhrase);\n    }\n    return \"encrypted\";\n  } else {\n    try {\n      let d = JSON.parse(decoded);\n      if (isPair(d)) {\n        auth(d);\n      }\n      return \"success\";\n    } catch (e) {\n      return \"incorrect link\";\n    }\n  }\n}\n\nasync function logEncPass(encPair, passphrase) {\n  let pair = await SEA.decrypt(encPair, passphrase);\n  auth(pair);\n}\n","import { giftPath } from '.'\nimport { useUser } from '../user'\nimport { reactive, computed, ref, watch } from 'vue'\nimport { hashObj } from '../crypto'\nimport { useNow } from '@vueuse/core'\nimport { useGun } from '../gun'\nimport { computedAsync } from '@vueuse/core'\nimport { currentRoom } from '../room'\n\nexport function useGift(hash) {\n  const gun = useGun()\n  const gift = reactive({})\n  const state = reactive({\n    from: false,\n    to: false,\n    complete: computed(() => state.from && state.to),\n    status: computed(() => state.from ? state.to ? 'complete' : 'proposed' : 'canceled')\n  })\n  gun.get('#' + giftPath).get(hash).once((d, k) => {\n    try {\n\n      Object.assign(gift, JSON.parse(d))\n\n      gun.user(gift.from).get(giftPath).get(k).on(d => { state.from = d })\n\n      gun.user(gift.to).get(giftPath).get(k).on(d => { state.to = d })\n\n    } catch (e) {\n      // gifts[k] = d\n    }\n\n  })\n  return { gift, state }\n}\n\n\nexport async function giftState(hash, state = true) {\n  const { user } = useUser()\n  user.db.get(giftPath).get(hash).put(state)\n}\n\n\nexport function useNewGift(giftConf) {\n  const { user } = useUser()\n\n  const { now, pause } = useNow({ interval: 1000, controls: true })\n\n  const gift = reactive({\n    from: computed(() => user?.pub),\n    to: '',\n    qn: null,\n    ql: null,\n    wish: '',\n    project: '',\n    date: computed(() => now.value.toLocaleString('en-GB')),\n    room: computed(() => currentRoom.pub)\n  })\n\n  const cleanGift = computed(() => {\n    let g = removeEmpty(gift)\n    g.qn = Number(g.qn)\n    return g\n  })\n\n  const required = ['from', 'to', 'qn', 'ql']\n\n  const valid = computed(() => {\n    const isFilled = required.reduce((acc, val) => {\n      return acc && gift[val]\n    }, true)\n    return isFilled\n  })\n\n  watch(gift, g => {\n    if (g.project) {\n      gift.to = g.project.slice(-87)\n    }\n  })\n\n  const hash = computedAsync(async () => {\n    const { hash, hashed } = await hashObj(cleanGift.value)\n    return hash\n  })\n\n  const proposed = ref(false)\n\n  Object.assign(gift, giftConf)\n\n  const gun = useGun()\n\n  async function propose() {\n\n    const { hash, hashed } = await hashObj(cleanGift.value)\n\n    gun.get('#' + giftPath).get(hash).put(hashed)\n\n    gun.user().get(giftPath).get(hash).put('proposed', () => {\n      pause()\n      proposed.value = true\n    })\n\n    if (currentRoom.features?.gifts) {\n\n      gun\n        .user(currentRoom.pub)\n        .get(giftPath)\n        .get(`${hash}@${user.pub}`)\n        .put(\n          true,\n          () => {\n            console.log(`gift ${hash} published`)\n          },\n          {\n            opt: { cert: currentRoom.features.gifts }\n          }\n        )\n    }\n\n  }\n\n  return { gift, cleanGift, valid, propose, proposed, hash }\n\n}\n\nfunction removeEmpty(obj) {\n  return Object.entries(obj)\n    .filter(([_, v]) => !!v)\n    .reduce(\n      (acc, [k, v]) => ({ ...acc, [k]: v === Object(v) ? removeEmpty(v) : v }),\n      {}\n    );\n}","import { currentRoom } from '../room'\n\nexport * from './useGifts'\nexport * from './useGift'\n\nexport const giftPath = \"gifts\"\n\n\nexport const defaultGift = {\n  from: '',\n  to: '',\n  qn: 0,\n  ql: '',\n  wish: '',\n  project: '',\n  room: currentRoom.pub,\n  date: ''\n}","/**\n * Worker wrapper for heavy functions\n * @module useWorker\n */\n\n/**\n * Example sorter function for a dated list object\n * @param {Object} e - the worker post event with a `data` object with a list of records to sort by the date keys\n */\nexport function sortByDate(e) {\n  const arr = Object.entries(e.data);\n  let sorted = arr.sort((a, b) => {\n    if (!a || !b) return 0;\n    let timeA = Date.parse(a[0]);\n    let timeB = Date.parse(b[0]);\n    return timeB - timeA;\n  });\n  postMessage({ sorted, count: arr.length });\n}\n\n// https://vitejs.dev/guide/features.html#web-workers\n\n/**\n * Create a new worker for a function\n * It should contain a `postMessage` method to reply to any incoming `postMessage` from the main script\n * @param {Function} funcObj\n */\n\nexport const newWorker = function (funcObj) {\n  // Build a worker from an anonymous function body\n  var blobURL = URL.createObjectURL(\n    new Blob([\"onmessage=\", funcObj.toString()], {\n      type: \"application/javascript\",\n    })\n  ),\n    worker = new Worker(blobURL);\n\n  // Won't be needing this anymore\n  URL.revokeObjectURL(blobURL);\n\n  return worker;\n};\n\n","/**\n * Reactive version of `gun-util` Date tree\n * @module useLog\n */\n\nimport { reactive, ref, onMounted, watchEffect, onBeforeUnmount } from \"vue\";\nimport { DateTree } from \"gun-util\";\nimport ms from \"ms\";\nimport { newWorker } from \"./useWorker\";\nimport { gun, useGun } from \"../gun\";\n\nfunction sortByDate(e) {\n  const arr = Object.entries(e.data);\n  let sorted = arr.sort((a, b) => {\n    if (!a || !b) return 0;\n    let timeA = Date.parse(a[0]);\n    let timeB = Date.parse(b[0]);\n    return timeB - timeA;\n  });\n  postMessage({ sorted, count: arr.length });\n}\n\nexport function useLog({\n  name = \"logs\",\n  after = \"2021-01-01\",\n  before = \"2023-01-01\",\n} = {}) {\n  const gun = useGun();\n  const treeRoot = gun.get(name);\n  const tree = new DateTree(treeRoot, \"minute\");\n  const dateTree = reactive({});\n  const sorted = ref([]);\n  const count = ref(0);\n\n  let query;\n\n  onMounted(() => {\n    var w = newWorker(sortByDate);\n\n    query = tree.on(\n      function (d, date) {\n        if (!d?.event) return;\n        dateTree[date] = d;\n      },\n      { gte: after, lt: before }\n    );\n\n    watchEffect(() => {\n      w.postMessage(JSON.parse(JSON.stringify(dateTree)));\n    });\n\n    w.onmessage = (e) => {\n      sorted.value = e.data.sorted;\n      count.value = e.data.count;\n    };\n  });\n\n  onBeforeUnmount(() => {\n    query.off();\n  });\n\n  function putNow(data) {\n    if (!data) return;\n    tree.get(new Date()).put({ event: \"now\", data });\n  }\n\n  return { dateTree, sorted, count, putNow };\n}\n\nexport function logEvent(event = \"text\", data) {\n  if (!data) {\n    console.log(\"No data to log\");\n    return;\n  }\n  const tree = new DateTree(gun.get(\"logs\"), \"minute\");\n  let theData = { event, ...data };\n  tree.get(new Date()).put(theData);\n}\n\nexport function formatDate(date) {\n  if (!date) return;\n  let theDate = new Date(date);\n  return {\n    date: theDate.toLocaleDateString(\"en-CA\"),\n    time: theDate.toLocaleTimeString(\"ru-RU\"),\n    ms: ms(Date.now() - theDate.getTime()),\n  };\n}\n","import { reactive, ref, computed, onBeforeUnmount } from 'vue'\nimport { gun, useGun2, useGun } from '../gun'\nimport { currentRoom } from '../room'\nimport { useUser } from '../user'\nimport { projectsPath } from '.'\nimport { SEA } from 'gun'\n\n\nexport const newProject = reactive({\n  title: '',\n  public: true,\n  funding: false\n})\n\nexport async function updateProject({ publish = true } = {}) {\n  const gun = useGun()\n  const { user } = useUser()\n  const link = gun.user().get(projectsPath).get(newProject.title).put(newProject, () => {\n    if (!publish) return\n\n    gun\n      .user(currentRoom.pub)\n      .get(projectsPath)\n      .get(newProject.title + '@' + user.pub)\n      .put(\n        link,\n        null,\n        {\n          opt:\n            { cert: currentRoom.features?.projects }\n        }\n      )\n    newProject.title = null\n  })\n\n\n\n}\n\nexport function updateProjectField(title, field, value) {\n  const proj = gun.user().get(projectsPath).get(title)\n  proj.get(field).put(value, () => {\n    proj.get('updatedAt').put(Date.now())\n  })\n}\n\n\nexport function useProject(path = ref()) {\n  path = ref(path)\n  const gun = useGun()\n  const project = computed(() => {\n    const proj = reactive({})\n    gun.user(currentRoom.pub).get(projectsPath).get(path.value).map().on((d, k) => {\n      proj[k] = d\n    })\n    return proj\n  })\n  return { project }\n}\n\n\n\nexport async function removeProject(path) {\n  const gun = useGun()\n  const gun2 = useGun2()\n  const { user } = useUser()\n\n  if (path.includes(user.pub)) {\n    gun.user(currentRoom.pub).get(projectsPath).get(path).put(null, null, {\n      opt:\n        { cert: currentRoom.features?.projects }\n    })\n\n  } else if (currentRoom.hosts[user.pub]) {\n    const pair = await SEA.decrypt(currentRoom.hosts[user.pub].enc, user.pair())\n    gun2.user().auth(pair, () => {\n      gun2.user().get(projectsPath).get(path).put(null)\n    })\n\n  }\n\n\n}\n\n","/**\n * @module Projects\n */\n\nimport { computed, reactive, ref } from \"vue\"\nimport { projectsPath } from \".\"\nimport { newProject } from './useProject'\nimport { useGun } from \"../gun\"\nimport { currentRoom } from \"../room\"\nimport Fuse from \"fuse.js\";\n\n\n\nexport function useProjects(pub = currentRoom.pub) {\n\n  const search = ref('')\n  const projects = reactive({})\n\n  const fuse = computed(() => {\n    const list = Object.entries(projects).map(arr => ({ ...arr[1], path: arr[0] }))\n    return new Fuse(list, {\n      includeScore: true,\n      ignoreLocation: true,\n      keys: [\"title\"],\n    })\n  })\n\n  const candidates = computed(() => {\n    if (newProject.title) {\n      return fuse.value.search(newProject.title)\n    } else {\n      return Object.entries(projects).map(arr => ({ item: { ...arr[1], path: arr[0] } }))\n    }\n  });\n\n  const gun = useGun()\n\n  gun\n    .user(pub)\n    .get(projectsPath)\n    .map()\n    .on((d, k) => {\n      if (d == null) { delete projects[k]; return }\n      const data = { ...d, path: k }\n      delete data._\n      projects[k] = data\n    })\n\n  return { projects, search, candidates }\n}\n\n\nexport function countProjects(pub = currentRoom.pub) {\n  const list = reactive({})\n  const gun = useGun()\n  gun\n    .user(pub)\n    .get(projectsPath)\n    .map()\n    .on((d, k) => {\n      if (d == null) { delete list[k]; return }\n      list[k] = true\n    })\n  return computed(() => Object.keys(list).length)\n\n}","export * from \"./useProject\";\nexport * from \"./useProjects\";\n\nexport const projectsPath = 'projects'\n","/**\n * A 2D-space\n * @module useSpace\n */\n\nimport { useGun } from \"..\";\nimport { useSvgMouse } from \"../ui\";\nimport { useUser } from \"../user\";\nimport { computed, ref, reactive, watchEffect } from \"vue\";\nimport { getFirstEmoji, currentRoom } from \"..\";\nimport { getArrow } from \"curved-arrows\";\nimport { useElementBounding } from \"@vueuse/core\";\nimport { useClamp } from '@vueuse/math'\n\n/**\n * @typedef {Object} useSpace\n * @property {reactive} space The main object\n * @property {reactive} guests Active guests\n * @property {reactive} links Links between active guests\n * @property {ref} plane The SVG element\n * @property {ref} area The rect element for mouse events capture\n * @property {ref} width Width of the plane\n * @property {ref} height Height of the plane\n * @property {Function} join Join the space with the current user\n */\n\n/**\n *  A space to navigate with mouse clicks\n * @returns {useSpace}\n * @example\n * const { space, plane, links, width, height, guests, area, join } = useSpace({\n * TIMEOUT: 10000,\n * })\n */\n\nexport function useSpace({\n  TIMEOUT = 10000,\n  randomness = 0.1,\n} = {}) {\n  const plane = ref();\n  const { area, mouse } = useSvgMouse(plane);\n\n  const { width, height } = useElementBounding(plane);\n  const pos = reactive([0, 0])\n  const zoom = useClamp(1, 0.5, 2)\n\n  const gun = useGun();\n  const { user } = useUser()\n\n  const space = reactive({\n    title: \"space\",\n    joined: false,\n    db: computed(() => gun.user(currentRoom.pub).get(\"space\")),\n    cert: computed(() => currentRoom.features?.space),\n    my: {\n      mouse: computed(() => ({ x: mouse.x, y: mouse.y })),\n      pos: null,\n    },\n  });\n\n  async function join() {\n    space.joined = true;\n  }\n\n  function place({ x = mouse.x, y = mouse.y } = {}) {\n    if (!user.pub) return;\n    if (!space.joined) join();\n    pos[0] = x\n    pos[1] = y\n    space.db.get(user.pub).get('pos').put(JSON.stringify({ x, y }), null, {\n      opt: { cert: currentRoom.features?.space },\n    });\n  }\n\n  // function placePoint() {\n  //   const pointPos = [pos[0] + space.my.mouse.x, pos[1] + space.my.mouse.y].map(Math.round)\n  //   console.log(pointPos)\n  //   space.db.get(user.pub).set({\n  //     title: 'point',\n  //     x: pointPos[0],\n  //     y: pointPos[1],\n  //     url: 'https://gun-vue.js.org'\n  //   }, null, {\n  //     opt: { cert: currentRoom.features?.space },\n  //   });\n  // }\n\n  const allGuests = reactive({});\n  const mates = reactive({});\n  const links = reactive({});\n\n  const guests = computed(() => {\n    const obj = {};\n    for (let g in allGuests) {\n      if (Date.now() - allGuests[g]?.pulse < TIMEOUT) {\n        obj[g] = allGuests[g];\n      }\n    }\n    return obj;\n  });\n\n  const guestCount = computed(() => Object.keys(guests.value).length);\n\n  gun.user(currentRoom.pub).get(\"space\").map().once(async (pos, pub) => {\n    if (pub == user.pub) {\n      space.joined = true;\n    }\n    allGuests[pub] = {\n      pub: pub,\n      draw: '',\n      blink: false,\n      pulse: 0,\n      hasPos: false,\n      pos: {\n        x: 0,\n        y: 0,\n      }\n    };\n\n\n\n    gun.user(currentRoom.pub).get(\"space\").get(pub).get('pos').on((d, k) => {\n      allGuests[pub].hasPos = true;\n      allGuests[pub].pos = typeof d == \"string\" ? JSON.parse(d) : d;\n    });\n\n    gun.user(currentRoom.pub).get(\"space\").get(pub).get('draw').on(d => {\n      allGuests[pub].draw = d\n    })\n\n    gun\n      .user(pub)\n      .get(\"pulse\")\n      .on((d) => {\n        allGuests[pub].pulse = d;\n        allGuests[pub].blink = !allGuests[pub].blink;\n      })\n      .back()\n      .get(\"mates\")\n      .map()\n      .on((d, k) => {\n        mates[pub] = mates[pub] || {};\n        mates[pub][k] = d;\n      });\n\n\n  });\n\n  const seeds = {}; //random seeds to scatter the arrows a little - depends on the `randomness` option\n\n  watchEffect(() => {\n    for (let pub1 in mates) {\n      seeds[pub1] = seeds[pub1] || {};\n\n      for (let pub2 in mates[pub1]) {\n        let seed = (seeds[pub1][pub2] =\n          seeds[pub1][pub2] || Math.random() * randomness);\n\n        if (mates[pub1][pub2]) {\n          const linkData = mates[pub1][pub2];\n          let g1 = allGuests[pub1];\n          let g2 = allGuests[pub2];\n          let age = Date.now() * 2 - g1?.pulse - g2?.pulse;\n          if (g1 && g2 && g1?.hasPos && g2?.hasPos && age < TIMEOUT) {\n            links[pub1 + pub2] = {\n              user: pub1,\n              mate: pub2,\n              emoji: getFirstEmoji(linkData),\n              from: g1.pos,\n              to: g2.pos,\n              arrow: generateArrow(\n                g1.pos,\n                g2.pos,\n                seed,\n              ),\n            };\n          }\n        } else {\n          delete links[pub1 + pub2];\n        }\n      }\n    }\n  });\n  return {\n    space,\n    allGuests,\n    guests,\n    guestCount,\n    links,\n    plane,\n    width,\n    height,\n    pos,\n    zoom,\n    area,\n    join,\n    place\n  };\n}\n\nfunction generateArrow(pos1, pos2, seed = 0) {\n  let arrowArray = getArrow(\n    pos1.x,\n    pos1.y,\n    pos2.x,\n    pos2.y,\n    {\n      padEnd: 20,\n      padStart: 10,\n    }\n  );\n  const [sx, sy, c1x, c1y, c2x, c2y, ex, ey, ae, as] = arrowArray;\n  let arrow = {\n    sx,\n    sy,\n    c1x: c1x * (1 - seed + 2 * seed),\n    c1y: c1y * (1 - seed + 2 * seed),\n    c2x: c2x * (1 - seed + 2 * seed),\n    c2y: c2y * (1 - seed + 2 * seed),\n    ex,\n    ey,\n    ae,\n    as,\n  };\n  return arrow;\n}\n\n/**\n * @todo draggable handles https://dev.to/abolz/roll-your-own-svg-drag-and-drop-in-vuejs-2c7o\n */\n","import { computed, markRaw, nextTick, reactive, ref, watch, onMounted } from 'vue'\nimport { createDrauu } from 'drauu'\nimport { toReactive, useStorage, useCycleList, useDebounceFn } from '@vueuse/core'\n\nimport { useGun, currentRoom, useUser } from '../'\n\nexport const draw = reactive({\n  colors: [\n    '#000000',\n    ...new Array(12).fill(true).map((el, i) => `hsl(${i * 30}, 100%,50%)`),\n    '#ffffff',\n  ],\n  sizes: useCycleList([4, 8, 16, 24]),\n  modes: ['line', 'arrow', 'stylus', 'rectangle', 'ellipse'],\n  mode: computed({\n    get() {\n      return _mode.value\n    },\n    set(v) {\n      _mode.value = v\n      if (v === 'arrow') {\n        brush.mode = 'line'\n        brush.arrowEnd = true\n      }\n      else {\n        brush.mode = v\n        brush.arrowEnd = false\n      }\n    },\n  }),\n  enabled: false,\n  pinned: useStorage('drawing-pinned', false),\n  canUndo: false,\n  canRedo: false,\n  canClear: false,\n  ing: false,\n  initiated: false,\n  content: ''\n})\n\nexport const brush = toReactive(useStorage('drawing-brush', {\n  color: draw.colors[0],\n  size: 10,\n  mode: 'stylus',\n}))\n\nconst _mode = ref('stylus')\nlet disableDump = false\n\nexport const drauuOptions = reactive({\n  brush,\n  acceptsInputTypes: computed(() => draw.enabled ? undefined : ['pen']),\n  // coordinateTransform: true,\n})\nexport const drauu = markRaw(createDrauu(drauuOptions))\n\nexport function loadCanvas(page) {\n  disableDump = true\n  if (draw.content != null)\n    drauu.load(draw.content)\n  else\n    drauu.clear()\n  disableDump = false\n}\n\nexport function updateState() {\n  draw.canRedo = drauu.canRedo()\n  draw.canUndo = drauu.canUndo()\n  draw.canClear = !!drauu.el?.children.length\n}\n\n\nexport function useDraw() {\n  if (!draw.initiated) {\n    const gun = useGun()\n\n    const { user } = useUser()\n\n    const drawing = gun.user(currentRoom.pub).get('space').get(user.pub).get('draw')\n\n    drawing.on(d => {\n      if (draw.ing) return\n      draw.content = d\n      loadCanvas()\n    })\n\n    const debouncedDraw = useDebounceFn(() => {\n      updateState()\n      if (!disableDump) {\n        let content = drauu.dump()\n        draw.content = content\n\n        gun.user(currentRoom.pub).get('space').get(user.pub).get('draw').put(content, null, { opt: { cert: currentRoom.features?.space } })\n      }\n    }, 200)\n\n    drauu.on('changed', debouncedDraw)\n    onMounted(() => {\n      nextTick(() => {\n        loadCanvas()\n      })\n\n    })\n\n    drauu.on('start', () => draw.ing = true)\n    drauu.on('end', () => draw.ing = false)\n\n    draw.clear = () => {\n      drauu.clear()\n      draw.content = ''\n      drawing.put('', null, { opt: { cert: currentRoom.features?.space } })\n    }\n\n    window.addEventListener('keydown', (e) => {\n      if (!draw.enabled)\n        return\n\n      const noModifier = !e.ctrlKey && !e.altKey && !e.shiftKey && !e.metaKey\n      let handled = true\n      if (e.code === 'KeyZ' && (e.ctrlKey || e.metaKey)) {\n        if (e.shiftKey)\n          drauu.redo()\n        else\n          drauu.undo()\n      }\n      else if (e.code === 'Escape') {\n        draw.enabled = false\n      }\n      else if (e.code === 'KeyC' && (e.ctrlKey || e.metaKey)) {\n        draw.clear()\n      }\n      else if (e.code.startsWith('Digit') && noModifier && +e.code[5] <= brushColors.length) {\n        brush.color = brushColors[+e.code[5] - 1]\n      }\n      else {\n        handled = false\n      }\n\n      if (handled) {\n        e.preventDefault()\n        e.stopPropagation()\n      }\n    }, false)\n  }\n\n  draw.initiated = true\n\n  return {\n    brush, draw, drauu, loadCanvas\n  }\n}\n\n"],"names":["ref","useMousePressed","reactive","onMounted","useMouseInElement","watch","onBeforeUnmount","ColorHash","gunAvatar","colorDeep","computed","ms","currentRoom","slugify","refDebounced","SEA","useStorage","Buffer","gun","gun2","Gun","urlRegex","Fuse","hashObj","yaml","markdown","externalLinks","JSZip","watchEffect","rootRoom","user","GB","base32","useNow","computedAsync","DateTree","useElementBounding","useClamp","getArrow","useCycleList","toReactive","markRaw","createDrauu","useDebounceFn","nextTick"],"mappings":"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"}