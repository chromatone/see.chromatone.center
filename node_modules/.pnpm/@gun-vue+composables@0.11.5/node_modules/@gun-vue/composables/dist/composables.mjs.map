{"version":3,"file":"composables.mjs","sources":["../src/ui/useMouse.js","../src/ui/useColor.js","../src/ui/useBackground.js","../src/account/useAccount.js","../src/chat/useChat.js","../src/chat/usePrivate.js","../src/gun/useRelay.js","../src/gun/useGun.js","../src/gun/useRelays.js","../src/crypto/useCrypto.js","../src/crypto/useCert.js","../src/dict/useDict.js","../src/dict/langs.js","../src/file/useFile.js","../src/file/useMd.js","../src/posts/usePost.js","../src/posts/usePosts.js","../src/posts/useTags.js","../src/posts/useReaction.js","../src/posts/useReactions.js","../src/file/useZip.js","../src/room/rootRoom.js","../src/room/useRoom.js","../src/room/useGuests.js","../src/gifts/useGifts.js","../src/user/useMates.js","../src/user/useUser.js","../src/user/usePass.js","../src/gifts/useGift.js","../src/gifts/index.js","../src/log/useWorker.js","../src/log/useLog.js","../src/project/useProject.js","../src/project/useProjects.js","../src/project/index.js","../src/space/useSpace.js","../src/space/useDraw.js"],"sourcesContent":["/**\n * Handle mouse movement inside an SVG\n * @module useMouse\n * */\n\nimport { useMousePressed, useMouseInElement } from \"@vueuse/core\";\nimport { ref, reactive, onMounted, onBeforeUnmount, watch } from \"vue\";\n\n/**\n * @typedef {Object} useMouse\n * @property {ref} area - an area to mount the mouse to\n * @property {Mouse} mouse - the reactive mouse parameters\n */\n\n/**\n * @typedef {reactive} Mouse\n * @property {Number} x - absolute X coordinate to place a marker to\n * @property {Number} y - absolute Y coordinate to place a marker to\n * @property {Number} normX - [0-1] relative X coordinate\n * @property {Number} normY - [0-1] relative Y coordinate\n * @property {Boolean} pressed - is mouse pressed?\n * @property {Boolean} inside - is mouse inside the area?\n */\n\n/**\n * Correct mouse position in an SVG space\n * @returns {useMouse}\n */\n\nexport function useSvgMouse(area = ref(null)) {\n\n  const { pressed } = useMousePressed();\n\n  const mouse = reactive({\n    x: 0,\n    y: 0,\n    normX: 0,\n    normY: 0,\n    pressed,\n    inside: false,\n  });\n\n  onMounted(() => {\n    document.addEventListener(\"mousemove\", getCursorPosition);\n    const { isOutside } = useMouseInElement(area);\n    watch(isOutside, (out) => {\n      mouse.inside = !out;\n    });\n  });\n\n  onBeforeUnmount(() => {\n    document.removeEventListener(\"mousemove\", getCursorPosition);\n  });\n\n  function getCursorPosition(event, rect = area.value) {\n    const svgElement = rect.closest(\"svg\");\n    if (!svgElement) return;\n    var svgPoint = svgElement.createSVGPoint();\n    svgPoint.x = event.clientX;\n    svgPoint.y = event.clientY;\n    let correct = svgPoint.matrixTransform(svgElement.getScreenCTM().inverse());\n    if (false) {\n      let bounds = rect.getBBox();\n      mouse.x =\n        correct.x < bounds.width\n          ? correct.x < 0\n            ? 0\n            : correct.x\n          : bounds.width;\n      mouse.y =\n        correct.y < bounds.height\n          ? correct.y < 0\n            ? 0\n            : correct.y\n          : bounds.height;\n      mouse.normY = mouse.y / bounds.height;\n      mouse.normX = mouse.x / bounds.width;\n    } else {\n      mouse.x = correct.x;\n      mouse.y = correct.y;\n    }\n  }\n\n  return {\n    area,\n    mouse,\n  };\n}\n","/**\n * Deterministic colors derived from oub keys, hashes or any other string data\n * @module useColor\n * */\n\nimport ColorHash from \"color-hash\";\n\nconst color = {\n  light: new ColorHash({\n    saturation: [0.05, 0.08, 0.22],\n    lightness: [0.85, 0.87, 0.9],\n  }),\n  pale: new ColorHash({\n    saturation: [0.05, 0.42, 0.52],\n    lightness: [0.75, 0.77, 0.9],\n  }),\n  regular: new ColorHash({\n    saturation: [0.1, 0.5, 0.7],\n    lightness: [0.3, 0.5, 0.7],\n  }),\n  deep: new ColorHash({\n    saturation: [0.5, 0.6, 0.7],\n    lightness: [0.5, 0.55, 0.6],\n  }),\n  dark: new ColorHash({\n    saturation: [0.02, 0.5, 0.6],\n    lightness: [0.18, 0.2, 0.5],\n  }),\n};\n\n/**\n * Get a color generator of a certain palette\n * @param {('light'|'regular'|'deep'|'dark')} palette\n * @returns {ColorHash} Color-Hash instance\n * @see https://github.com/zenozeng/color-hash\n * @example\n * import {useColor} from '@gun-vue/composables'\n * const colorDeep = useColor('deep')\n * const color = colorDeep.hex('any text data')\n * // color == '#e052ae'\n */\n\nexport function useColor(palette = \"deep\") {\n  if (typeof palette == \"object\") {\n    return new ColorHash(palette);\n  }\n  return color[palette];\n}\n","import { gunAvatar } from \"..\";\n\nexport function useBackground({\n  pub,\n  size = 200,\n  light = 0.5,\n  overlay = 0.5,\n  draw = \"squares\",\n  attachment = \"fixed\",\n} = {}) {\n  if (!pub) return;\n\n  return {\n    background: `linear-gradient(hsla(255,0%,${\n      light * 100\n    }%,${overlay}), hsla(255,0%,${light * 100}%,${overlay})), url(${gunAvatar({\n      pub: pub,\n      draw,\n      reflect: false,\n      size: size,\n    })})`,\n    backgroundSize: \"cover, cover\",\n    backgroundAttachment: `${attachment},${attachment}`,\n  };\n}\n","/**\n * Basic user management\n * @module useAccount\n * */\n\nimport { useGun } from \"..\";\nimport { useColor } from \"../ui\";\nimport { computed, reactive, ref } from \"vue\";\nimport ms from \"ms\";\n\nconst colorDeep = useColor(\"deep\");\n\n/**\n * @typedef {computed(object)} account \n * Reactive account data\n * @property {string} pub   the pub key\n * @property {string} color the color hash of the pub key\n * @property {object} profile all the profile fields of the account\n * @property {number} pulse the recent presence timestamp\n * @property {boolean} blink on/off switching pulse\n * @property {'online' | string} lastSeen a human readable last seen status ('online' if less than TIMEOUT)\n */\n\n\n/**\n * Load and handle user's account by a public key\n * @param {ref(string) | string} pub - The public key of a user as a string or a ref\n * @returns {account}\n * @example\n * import { ref } from 'vue'\n * import { useAccount, SEA } from '@gun-vue/composables'\n *\n * const pub = ref()\n *\n * async function generatePair() {\n *  pub.value = await SEA.pair()\n * }\n *\n * const { account } = useAccount(pub)\n * \n * generatePair()\n */\n\nexport function useAccount(pub = ref(), { TIMEOUT = 10000 } = {}) {\n  const gun = useGun();\n  pub = ref(pub);\n  const account = computed(() => {\n    const obj = reactive({\n      pub,\n      color: computed(() => (pub.value ? colorDeep.hex(pub.value) : \"gray\")),\n      profile: {\n        name: \"\",\n      },\n      pulse: 0,\n      lastSeen: computed(() => {\n        let time = Date.now() - obj.pulse;\n        if (time > TIMEOUT) {\n          return ms(time);\n        } else {\n          return \"online\";\n        }\n      }),\n      blink: false,\n      db: gun.user(pub.value),\n    });\n\n    gun\n      .user(pub.value)\n      .get(\"pulse\")\n      .on((d) => {\n        obj.blink = !obj.blink;\n        obj.pulse = d;\n      })\n      .back()\n      .get(\"profile\")\n      .map()\n      .on((data, key) => {\n        obj.profile[key] = data;\n      });\n    return obj;\n  });\n\n  return { account };\n}","/**\n * Basic public chat\n * @module useChat\n */\n\nimport { ref, reactive, computed } from \"vue\";\nimport slugify from \"slugify\";\nimport { useUser, useGun, currentRoom } from \"..\";\nimport { refDebounced } from '@vueuse/core'\n\nexport function useChat() {\n  const gun = useGun();\n  const { user } = useUser();\n\n  const currentChat = ref(\"general\");\n  const chats = reactive({\n    general: {},\n  });\n\n  const chatDb = gun.user(currentRoom.pub).get(\"chat\");\n\n  chatDb.map().on((d, k) => {\n    const [title, author] = k.split(\"@\");\n    chats[title] = chats[title] || {};\n    if (d) {\n      chats[title][author] = d;\n    } else {\n      delete chats?.[title]?.[author];\n    }\n  });\n\n  function addChat(title) {\n    chatDb\n      .get(`${slugify(title) || title}@${user.pub}`)\n      .put(true, null, { opt: { cert: currentRoom.features.chat } });\n  }\n\n  const topicDb = computed(() =>\n    gun.user(currentRoom.pub).get(\"chat/\" + currentChat.value)\n  );\n\n  const messages = computed(() => {\n    const msgs = reactive({});\n    topicDb.value.map().on((text, k) => {\n      const timestamp = k.substring(0, 13);\n      const author = k.substring(14);\n      msgs[k] = {\n        timestamp,\n        author,\n        text,\n      };\n    });\n    return msgs;\n  });\n\n  const messageList = computed(() => Object.values(messages.value || {}))\n  const debList = refDebounced(messageList)\n  const sorted = computed(() => debList.value.sort((a, b) => a.timestamp > b.timestamp ? 1 : -1))\n\n\n  function send(message) {\n    if (!message) return;\n    let now = Date.now();\n    topicDb.value\n      .get(`${now}@${user.pub}`)\n      .put(message, null, { opt: { cert: currentRoom.features.chat } });\n  }\n\n  return {\n    send,\n    addChat,\n    currentChat,\n    chats,\n    messages,\n    sorted\n  };\n}\n","/**\n * Basic private chat\n * @module usePrivateChat\n */\n\nimport { reactive, computed, ref } from \"vue\"\nimport { useAccount, useUser, useGun, SEA } from '..'\nimport { refDebounced } from '@vueuse/core'\n\nexport function usePrivateChat(pub, { parse = true } = {}) {\n\n  const gun = useGun();\n  const { user } = useUser();\n  const messages = reactive({});\n  const epub = ref()\n\n  gun.user(pub)\n    .get('epub')\n    .once(d => epub.value = d)\n\n\n  gun.user(pub)\n    .get('chat')\n    .get(user.pub)\n    .map()\n    .once(function (d, k) {\n      parseMessages(d, k, pub, this)\n    })\n\n  gun.user()\n    .get('chat')\n    .get(pub)\n    .map()\n    .once(function (d, k) {\n      parseMessages(d, k, user.pub, this)\n    })\n\n  function parseMessages(data, today, author, that) {\n    that.map().on(async (d, k) => {\n      if (d && d.startsWith('SEA')) {\n        const secret = await SEA.secret(epub.value, user.pair())\n        const work = await SEA.work(secret, today)\n        const dec = await SEA.decrypt(d, work)\n        if (!dec || typeof dec != 'object') return\n        messages[k] = {\n          timestamp: dec.timestamp,\n          author,\n          text: dec.text\n        }\n      }\n    })\n  }\n\n  async function send(message) {\n    if (!message) return;\n    const theDate = new Date()\n    const toSend = {\n      timestamp: theDate.getTime(),\n      text: message\n    }\n    const today = theDate.toLocaleDateString('en-CA')\n    const secret = await SEA.secret(epub.value, user.pair())\n    const work = await SEA.work(secret, today)\n    const enc = await SEA.encrypt(toSend, work)\n    gun.user().get('chat').get(pub).get(today).set(enc)\n  }\n\n  const messageList = computed(() => Object.values(messages || {}))\n  const debList = refDebounced(messageList)\n  const sorted = computed(() => debList.value.sort((a, b) => a.timestamp > b.timestamp ? 1 : -1))\n\n  return {\n    send,\n    messages,\n    sorted\n  };\n}\n\n\nexport function usePrivateChatCount(pub) {\n  const gun = useGun();\n  const { user } = useUser();\n  const messages = reactive({});\n\n  const available = ref(false)\n\n  gun.user(pub).get('epub').on(d => available.value = d)\n\n  gun.user(pub).get('chat').get(user.pub).map().map().on((d, k) => {\n    if (d && !d.startsWith('SEA')) return\n    messages[k] = d\n  })\n\n  gun.user().get('chat').get(pub).map().map().on((d, k) => {\n    if (d && !d.startsWith('SEA')) return\n    messages[k] = d\n  })\n\n  const count = computed(() => {\n    return Object.keys(messages).length\n  })\n  return { count, available }\n}\n\nexport function usePrivateChatList() {\n  const gun = useGun();\n  const { user } = useUser();\n  const list = reactive({})\n  if (user.is) {\n    gun.user().get('chat').map().on((d, k) => {\n      list[k] = d\n    })\n    gun.user().get(\"mates\").map().on(async (d, k) => {\n      const mutual = await gun.user(k).get('mates').get(user.pub)\n      const epub = await gun.user(k).get('epub')\n      if (mutual && epub) {\n        list[k] = d\n      }\n    })\n\n  }\n  return { list }\n}","/**\n * Relay connection management\n * @module useRelay\n */\n\nimport { useGun } from '.'\nimport { computed, reactive, watch } from 'vue'\nimport { useStorage } from \"@vueuse/core\";\nimport ms from 'ms'\n\nexport const defaultPeer = \"https://etogun.glitch.me/gun\";\nexport const peer = useStorage(\"peer\", defaultPeer);\n\n/**\n * @typedef {reactive} Relay Peer server status reactive object\n * @property {String} host the current peer server URL\n * @property {String} status current connection status\n * @property {Number} started the timestamp of server started current session\n * @property {Number} pulse last received timestamp\n * @property {Number} lag drift of the timestamp in ms\n * @property {Number} diff age of the session in ms\n * @property {String} age age of the session in human readable format\n * @property {Boolean} blink a Boolean toggled every time the new pulse comes to drive animations\n * @example\n * {\n * \"peer\": \"https://etogun.glitch.me/gun\",\n * \"host\": \"6db1edbb5aae\",\n * \"status\": \"running\",\n * \"started\": 1642666725795,\n * \"pulse\": 1642677007483,\n * \"lag\": 8,\n * \"diff\": 10281688,\n * \"age\": \"3h\",\n * \"delay\": 22,\n * \"blink\": true\n * }\n */\n\nexport const relay = reactive({\n  list: [],\n  peer: peer.value,\n  host: new URL(peer.value).hostname,\n  status: 'offline',\n  started: 0,\n  pulse: 0,\n  lag: 0,\n  diff: computed(() => relay.pulse - relay.started),\n  age: computed(() => ms(relay.diff)),\n  delay: computed(() => Date.now() - relay.pulse),\n  blink: false,\n})\n\nwatch(\n  () => relay.pulse,\n  (next, prev) => {\n    relay.blink = !relay.blink\n    relay.lag = next - prev - 500\n  },\n)\n\nfunction setPeer(url) {\n  peer.value = url\n  window.location.reload()\n};\n\nfunction resetPeer() {\n  peer.value = defaultPeer\n  window.location.reload()\n}\n\n\n/**\n * Peer server status monitor\n * @returns {useRelay}\n *\n * @example\n * import { useRelay } from '@gun-vue/composables';\n *\n * const { relay, setPeer, resetPeer } = useRelay()\n */\nexport function useRelay() {\n  const gun = useGun()\n  if (relay.pulse == 0) {\n    gun\n      .get(relay.host)\n      .map()\n      .on((d, k) => {\n        relay[k] = d\n      })\n  }\n\n  return { relay, setPeer, resetPeer }\n}\n","/**\n * Gun DB initialization and basic methods\n * @module useGun\n */\n\nimport Gun from \"gun/gun\";\nimport \"gun/lib/then\";\nimport \"gun/lib/radix\";\nimport \"gun/lib/radisk\";\nimport \"gun/lib/store\";\nimport \"gun/lib/rindexed\";\nimport \"gun/lib/webrtc\";\nimport \"gun/nts\";\n\n\n// polyfiils for Gun 0.2020.1236\nimport { Buffer } from 'buffer'\nwindow.Buffer = Buffer\nwindow.setImmediate = setTimeout\n\nimport { peer } from './useRelay'\n\n\n// https://github.com/amark/gun/wiki/volunteer.dht\n// https://github.com/draeder/gun-relays\n\n/** The main Gun instance for database operations */\nexport let gun;\n\n/** Secondary Gun instance for key management */\nexport let gun2;\n\n/**\n * Instantiate a Gun instance for DB manipulations\n * @param {Object} options - options fot this gun instance, like { localstorage:true }\n * @returns {Gun}\n * @example\n * import { useGun } from '@gun-vue/composables'\n *\n * const gun = useGun()\n */\n\nexport function useGun(opts = { localStorage: false }) {\n  if (!gun) {\n    gun = Gun({ peers: [peer.value], ...opts });\n  }\n  return gun;\n}\n\n/**\n * get a secondary Gun instance for certificate management\n * @param {object} options - options fot this gun instance, like { localstorage:true }\n * @returns {Gun}\n */\n\nexport function useGun2(opts = { localStorage: false }) {\n  if (!gun2) {\n    gun2 = Gun({ peers: [peer.value], ...opts });\n  }\n  return gun2;\n}\n\n/**\n * SEA library\n * @constant SEA\n */\nexport { default as SEA } from \"gun/sea.js\";\n\n/**\n * **Get a soul for any given node**\n * A wrapper for `Gun.node.soul`\n * @function soul\n */\nexport const soul = Gun?.node?.soul;\n\n/**\n * **Generate a random UUID**\n * A wrapper for `Gun.text.random`\n * @function genUUID\n */\nexport const genUUID = Gun?.text?.random;\n\n\n","/**\n * Loads the [list of active volunteer DHT gun nodes](https://github.com/amark/gun/wiki/volunteer.dht)  and benchmarks ping for them\n * @module useRelays\n */\n\n/**\n * @typedef {Object} useRelays\n * @property {Object} Relays\n * @property {Object} Errors\n * @property {Function} loadRelays\n */\n\n/**\n * @typedef {Object} loadRelaysOptions\n * @property {String} source\n */\n\n/**\n * @typedef {Object[]} Relays \n * @property {String} hostname\n * @property {String} url\n * @property {Number} ping\n */\n\n\nimport urlRegex from 'url-regex'\nimport { reactive } from 'vue'\nimport { relay } from './useRelay'\n\nconst relays = reactive({})\nconst errors = reactive({})\n\n/**\n * Load the list of the relays\n * @param {Object} loadRelaysOptions\n * @returns {relays} \n */\n\nexport async function loadRelays({\n  source = 'https://raw.githubusercontent.com/wiki/amark/gun/volunteer.dht.md'\n} = {}) {\n  let res = await fetch(source)\n  let data = await res.text()\n  let urls = data.match(urlRegex())\n  urls.push(relay.peer)\n  urls = Array.from(urls)\n  urls.forEach((u) => {\n    let testUrl = new URL(u)\n    if (testUrl.pathname === '/gun' && testUrl.pathname.indexOf('~~') === -1) {\n      let startMoment = performance.now()\n      fetch(testUrl.href, {\n        method: 'HEAD',\n        mode: 'cors',\n        // mode: 'no-cors',\n        redirect: 'follow',\n        referrerPolicy: 'no-referrer',\n      }).then(response => {\n        let endMoment = performance.now()\n        if (response.ok) {\n          relays[testUrl.hostname] = {\n            host: testUrl.hostname,\n            ping: (endMoment - startMoment).toFixed(),\n            url: testUrl.href\n          }\n        } else {\n          errors[testUrl.hostname] = response\n        }\n      }).catch(e => {\n        errors[testUrl.hostname] = e\n      })\n    }\n  })\n  return relays\n}\n\n/**\n * Gets the list of actual gun relays and tool to update the list\n * @returns {useRelays}\n * @example\n * import { useRelays } from '@gun-vue/composables'\n * const { relays, errors, loadRelays } = useRelays()\n */\n\nexport function useRelays() {\n  return { relays, errors, loadRelays }\n}\n\n","/**\n * SEA cryptography abstraction\n * @module useCrypto\n */\n\n// https://github.com/amark/gun/wiki/Snippets\n\nimport { SEA } from \"../gun/\";\n\nexport function isHash(str) {\n  return str.length == 44 && str.charAt(43) == '='\n}\n\n/**\n * @typedef {Object} Entity\n * @property {String} pub - the public key\n * @property {String} epub - the elliplic encryption epub\n */\n\n/**\n * Encrypt data for one receiver entity\n * 1. Generates encryption secret using bob's epub and current user pair\n * 2. Enctypts data with this secret\n * @param {String} data - Stringified data to be encrypted\n * @param {Entity} sender - An object with `pub` and `epub` strings - the user.is object of the reciever's account\n * @param {SEAPair} receiver - SEA Pair of the sender – `epriv` key will be used to encrypt the data\n * @returns {String} Encrypted data string to be sent\n */\nexport async function encFor(data, receiver, sender) {\n  const secret = await SEA.secret(receiver.epub, sender);\n  const encryptedData = await SEA.encrypt(data, secret);\n  return encryptedData;\n}\n\n/**\n * Decrypt a private message from an entity\n * 1. Generates secret using senders `epub` and current user pair\n * 2. Decrypts the data with this secret\n * @param {String} data - Encrypted private data\n * @param {Entity} sender - An object with `pub` and `epub` strings - the user.is object of the sender's account\n * @param {SEAPair} receiver - SEA Pair of the receiver – `epriv` key will be used to encrypt the data\n * @returns {String} Decrypted data\n */\nexport async function decFrom(data, sender, receiver) {\n  const secret = await SEA.secret(sender.epub, receiver);\n  const decryptedData = await SEA.decrypt(data, secret);\n  return decryptedData;\n}\n\nexport async function hashText(text) {\n  let hash = await SEA.work(text, null, null, { name: \"SHA-256\" });\n  return hash;\n}\n\nexport async function hashObj(obj) {\n  let hashed = typeof obj == \"string\" ? obj : JSON.stringify(obj);\n  let hash = await hashText(hashed);\n  return { hashed, hash };\n}\n\n/**\n * Calculate a hex hash for any string data\n * @async\n * @param {String} text\n * @param {String} seed\n * @returns {String} The hex encoded SHA-1 hash\n */\nexport async function getShortHash(text, seed) {\n  return await SEA.work(text, seed, null, { name: \"SHA-1\", encode: \"hex\" });\n}\n\n// Buffer -> Base64 String -> Url Safe Base64 String\nexport function safeHash(unsafe) {\n  if (!unsafe) return;\n  const encode_regex = /[\\+=\\/]/g;\n  return unsafe.replace(encode_regex, encodeChar);\n}\n\nfunction encodeChar(c) {\n  switch (c) {\n    case \"+\":\n      return \"-\";\n    case \"=\":\n      return \".\";\n    case \"/\":\n      return \"_\";\n  }\n}\n\n// Url Safe Base64 String -> Base64 String -> Buffer\nexport function unsafeHash(safe) {\n  if (!safe) return;\n  const decode_regex = /[\\._\\-]/g;\n  return safe.replace(decode_regex, decodeChar);\n}\n\nfunction decodeChar(c) {\n  switch (c) {\n    case \"-\":\n      return \"+\";\n    case \".\":\n      return \"=\";\n    case \"_\":\n      return \"/\";\n  }\n}\n\nexport function safeJSONParse(input, def) {\n  // Convert null to empty object\n  if (!input) {\n    return def || {};\n  } else if (Object.prototype.toString.call(input) === \"[object Object]\") {\n    return input;\n  }\n  try {\n    return JSON.parse(input);\n  } catch (e) {\n    return def || {};\n  }\n}\n","import { SEA } from \"..\";\n\nexport async function issueCert({\n  pair,\n  tag = \"word\",\n  dot = '',\n  users = \"*\",\n  personal = false,\n} = {}) {\n  let policy = { \"*\": `${tag}` };\n  if (dot) {\n    policy[\".\"] = dot;\n  }\n  if (personal) {\n    policy[\"+\"] = \"*\";\n  }\n  try {\n    let cert = await SEA.certify(users, policy, pair);\n    return cert;\n  } catch (e) {\n    console.log(\"cert error: \", e);\n  }\n}\n\nwindow.issueCert = issueCert;\n\nexport async function generateCerts({ pair, list = [] } = {}) {\n  const all = {};\n  for (let opt of list) {\n    all[opt.tag] = await issueCert({ ...opt, pair });\n  }\n  return all;\n}\n","/**\n * @module useDictionary\n */\n\nimport Fuse from \"fuse.js\";\nimport { ref, reactive, computed, watch } from 'vue'\nimport { useStorage } from '@vueuse/core';\n\nimport { useGun, currentRoom, hashText, useUser, useColor, hashObj } from '..';\n\n\nexport const dictRecord = reactive({\n  word: null,\n  def: null\n})\n\nexport const dictLang = useStorage('dict-lang', 'en')\n\nwatch(dictRecord, () => {\n  if (dictRecord.word && dictRecord.def) {\n    addRecord(dictRecord)\n  }\n})\n\n/**\n * Use filtrable words list\n * @returns {useWords}\n */\n\nexport function useWords() {\n  const gun = useGun()\n  const { user } = useUser()\n\n  const input = ref('')\n  const word = computed(() => letterFilter(input.value))\n\n  async function addWord() {\n    const hash = await hashText(word.value)\n    gun.get('dict').get('#word').get(hash).put(word.value)\n    dictRecord.word = hash\n    // gun\n    //   .user(currentRoom.pub)\n    //   .get('dict')\n    //   .get(`${hash}@${user.pub}`)\n    //   .put(true, null, { opt: { cert: currentRoom.features?.dict } });\n    input.value = ''\n  }\n\n  const linked = reactive({})\n\n  gun.user(currentRoom.pub).get('dict').map().on(async (d, k) => {\n    if (!d) return\n    let hash = k.slice(0, 44);\n    let defHash = k.slice(45, 89);\n    let def = await gun.get('dict').get('#def').get(defHash).then()\n    if (!def) return\n    try {\n      def = JSON.parse(def)\n    } catch (e) {\n      console.log(e, def)\n      return\n    }\n    if (def?.lang != dictLang.value) return\n    linked[hash] = linked[hash] || await gun.get('dict').get('#word').get(hash).then()\n  })\n\n  const words = reactive({})\n\n  gun.get('dict').get('#word').map().once((d, k) => {\n    if (d.includes(' ')) return\n    words[k] = d\n  })\n\n  const fuse = computed(() => {\n    let arr = Object.entries(words).map(entry => {\n      return { text: entry[1], hash: entry[0] }\n    })\n    return new Fuse(arr, {\n      keys: ['text'],\n      includeScore: true\n    })\n  })\n\n  const found = computed(() => fuse.value.search(input.value))\n\n  return { input, found, words, linked, word, addWord }\n}\n\n\n\n\nexport function useWord(hash) {\n  const gun = useGun()\n\n  const word = ref()\n\n  gun.get('dict').get('#word').get(hash).once((d, k) => {\n    word.value = letterFilter(d)\n  })\n  return { word }\n}\n\n\n/**\n * Dictionary definitions browser\n * @returns {useDefs}\n */\n\nexport function useDefs() {\n  const gun = useGun()\n\n  const def = reactive({\n    text: '',\n    lang: dictLang,\n    part: 'noun'\n  })\n\n  async function addDef() {\n    const { hash, hashed } = await hashObj(def)\n    gun.get('dict').get('#def').get(hash).put(hashed)\n    dictRecord.def = hash\n    def.text = ''\n    def.part = null\n  }\n\n  const linked = reactive({})\n\n  gun.user(currentRoom.pub).get('dict').map().on(async (d, k) => {\n    if (!d) return\n\n    let hash = k.slice(45, 89);\n    let record = await gun.get('dict').get('#def').get(hash).then()\n    if (!record) return\n    try {\n      record = JSON.parse(record)\n      if (record?.lang != dictLang.value) return\n      linked[hash] = linked[hash] || record\n    } catch (e) {\n      console.log(e, record)\n    }\n\n  })\n\n\n  const defs = reactive({})\n\n  gun.get('dict').get('#def').map().once((d, k) => {\n    defs[k] = JSON.parse(d)\n  })\n\n  const fuse = computed(() => {\n    let defList = []\n    for (let hash in defs) {\n      defList.push({ hash, ...defs[hash] })\n    }\n    return new Fuse(defList, {\n      keys: ['text'],\n      includeScore: true\n    })\n  })\n\n  const found = computed(() => fuse.value.search(def.text))\n\n  return { def, addDef, defs, found, linked }\n}\n\n\n\nasync function addRecord({ word, def } = {}) {\n\n  const gun = useGun()\n  const { user } = useUser();\n  let already = await gun\n    .user(currentRoom.pub)\n    .get('dict')\n    .get(`${word}:${def}@${user.pub}`).then()\n\n  gun\n    .user(currentRoom.pub)\n    .get('dict')\n    .get(`${word}:${def}@${user.pub}`)\n    .put(!already, null, { opt: { cert: currentRoom.features?.dict } });\n  dictRecord.word = null\n  dictRecord.def = null\n}\n\nexport function useDictRecordsFor(hash) {\n  const gun = useGun()\n  const links = reactive({})\n  gun\n    .user(currentRoom.pub)\n    .get('dict')\n    .map()\n    .on((data, key) => {\n      let index = key.indexOf(hash);\n      if (index == -1) return;\n      const { from, to, author } = parseHashLink(key)\n      let linked = from == hash ? to : from\n\n      links[linked] = links[linked] || {}\n      if (data) {\n        links[linked][author] = data\n      } else {\n        delete links?.[linked]?.[author]\n        if (Object.keys(links?.[linked]).length == 0) {\n          delete links?.[linked]\n        }\n      }\n    })\n  return links\n}\n\nexport function useDictRecordsBy(pub) {\n  const gun = useGun()\n  const records = reactive({})\n  gun\n    .user(currentRoom.pub)\n    .get('dict')\n    .map()\n    .on((data, key) => {\n      const { from, to, author } = parseHashLink(key)\n      if (author != pub) return\n\n      records[from] = records[from] || {}\n      if (data) {\n        records[from][to] = data\n      } else {\n        delete records?.[from]?.[to]\n        if (Object.keys(records[from]).length == 0) {\n          delete records?.[from]\n        }\n      }\n    })\n  return records\n}\n\nexport function useDictAuthors() {\n  const gun = useGun()\n  const authors = reactive({})\n  gun\n    .user(currentRoom.pub)\n    .get('dict')\n    .map()\n    .once(async (data, key) => {\n      const { from, to, author } = parseHashLink(key)\n      authors[author] = authors[author] || {}\n      authors[author][from] = authors[author][from] || {}\n      authors[author][from][to] = data\n    })\n  return authors\n}\n\nexport function useDictLangs() {\n  const gun = useGun()\n  const langs = reactive({})\n  gun\n    .user(currentRoom.pub)\n    .get('dict')\n    .map()\n    .once(async (data, key) => {\n\n\n      let hash = key.slice(45, 89);\n      let def = await gun.get('dict').get('#def').get(hash).then()\n      if (!def) return\n      try {\n        def = JSON.parse(def)\n      } catch (e) {\n        console.log(def, e)\n      }\n      if (!def?.lang) return\n      langs[def?.lang] = langs[def?.lang] || 0\n      langs[def?.lang]++\n    })\n  return langs\n}\n\n\nexport function parseHashLink(link) {\n  return {\n    from: link.slice(0, 44),\n    to: link.slice(45, 89),\n    author: link.slice(-87),\n  }\n}\n\n\nexport function renderStress({ text, stress } = {}) {\n  const stressMark = '&#x301;'\n  if (!text) return;\n  let str = text.slice(0, stress + 1) + stressMark + text.slice(stress + 1);\n  return str[0].toUpperCase() + str.slice(1);\n}\n\nexport function letterFilter(str) {\n  if (!str) return ''\n  let clean = str.toLowerCase().matchAll(/\\p{L}/gu, '')\n  return Array.from(clean).map(el => el[0]).join('')\n}","export const langParts = {\n  noun: {\n    en: 'noun',\n    ru: 'сущ',\n    underline: 'solid',\n  },\n  adj: {\n    en: 'adjective',\n    ru: 'прил',\n    underline: 'wavy',\n  },\n  verb: {\n    en: 'verb',\n    ru: 'глаг',\n    underline: 'double',\n  },\n  adv: {\n    en: 'adverb',\n    ru: 'нареч',\n    underline: 'dotted',\n  },\n}\n\n\nexport const languages = [\n  {\n    \"code\": \"aa\",\n    \"name\": \"Afar\",\n    \"native\": \"Afar\"\n  },\n  {\n    \"code\": \"ab\",\n    \"name\": \"Abkhazian\",\n    \"native\": \"Аҧсуа\"\n  },\n  {\n    \"code\": \"af\",\n    \"name\": \"Afrikaans\",\n    \"native\": \"Afrikaans\"\n  },\n  {\n    \"code\": \"ak\",\n    \"name\": \"Akan\",\n    \"native\": \"Akana\"\n  },\n  {\n    \"code\": \"am\",\n    \"name\": \"Amharic\",\n    \"native\": \"አማርኛ\"\n  },\n  {\n    \"code\": \"an\",\n    \"name\": \"Aragonese\",\n    \"native\": \"Aragonés\"\n  },\n  {\n    \"code\": \"ar\",\n    \"name\": \"Arabic\",\n    \"native\": \"العربية\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"as\",\n    \"name\": \"Assamese\",\n    \"native\": \"অসমীয়া\"\n  },\n  {\n    \"code\": \"av\",\n    \"name\": \"Avar\",\n    \"native\": \"Авар\"\n  },\n  {\n    \"code\": \"ay\",\n    \"name\": \"Aymara\",\n    \"native\": \"Aymar\"\n  },\n  {\n    \"code\": \"az\",\n    \"name\": \"Azerbaijani\",\n    \"native\": \"Azərbaycanca / آذربايجان\"\n  },\n  {\n    \"code\": \"ba\",\n    \"name\": \"Bashkir\",\n    \"native\": \"Башҡорт\"\n  },\n  {\n    \"code\": \"be\",\n    \"name\": \"Belarusian\",\n    \"native\": \"Беларуская\"\n  },\n  {\n    \"code\": \"bg\",\n    \"name\": \"Bulgarian\",\n    \"native\": \"Български\"\n  },\n  {\n    \"code\": \"bh\",\n    \"name\": \"Bihari\",\n    \"native\": \"भोजपुरी\"\n  },\n  {\n    \"code\": \"bi\",\n    \"name\": \"Bislama\",\n    \"native\": \"Bislama\"\n  },\n  {\n    \"code\": \"bm\",\n    \"name\": \"Bambara\",\n    \"native\": \"Bamanankan\"\n  },\n  {\n    \"code\": \"bn\",\n    \"name\": \"Bengali\",\n    \"native\": \"বাংলা\"\n  },\n  {\n    \"code\": \"bo\",\n    \"name\": \"Tibetan\",\n    \"native\": \"བོད་ཡིག / Bod skad\"\n  },\n  {\n    \"code\": \"br\",\n    \"name\": \"Breton\",\n    \"native\": \"Brezhoneg\"\n  },\n  {\n    \"code\": \"bs\",\n    \"name\": \"Bosnian\",\n    \"native\": \"Bosanski\"\n  },\n  {\n    \"code\": \"ca\",\n    \"name\": \"Catalan\",\n    \"native\": \"Català\"\n  },\n  {\n    \"code\": \"ce\",\n    \"name\": \"Chechen\",\n    \"native\": \"Нохчийн\"\n  },\n  {\n    \"code\": \"ch\",\n    \"name\": \"Chamorro\",\n    \"native\": \"Chamoru\"\n  },\n  {\n    \"code\": \"co\",\n    \"name\": \"Corsican\",\n    \"native\": \"Corsu\"\n  },\n  {\n    \"code\": \"cr\",\n    \"name\": \"Cree\",\n    \"native\": \"Nehiyaw\"\n  },\n  {\n    \"code\": \"cs\",\n    \"name\": \"Czech\",\n    \"native\": \"Česky\"\n  },\n  {\n    \"code\": \"cu\",\n    \"name\": \"Old Church Slavonic / Old Bulgarian\",\n    \"native\": \"словѣньскъ / slověnĭskŭ\"\n  },\n  {\n    \"code\": \"cv\",\n    \"name\": \"Chuvash\",\n    \"native\": \"Чăваш\"\n  },\n  {\n    \"code\": \"cy\",\n    \"name\": \"Welsh\",\n    \"native\": \"Cymraeg\"\n  },\n  {\n    \"code\": \"da\",\n    \"name\": \"Danish\",\n    \"native\": \"Dansk\"\n  },\n  {\n    \"code\": \"de\",\n    \"name\": \"German\",\n    \"native\": \"Deutsch\"\n  },\n  {\n    \"code\": \"dv\",\n    \"name\": \"Divehi\",\n    \"native\": \"ދިވެހިބަސް\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"dz\",\n    \"name\": \"Dzongkha\",\n    \"native\": \"ཇོང་ཁ\"\n  },\n  {\n    \"code\": \"ee\",\n    \"name\": \"Ewe\",\n    \"native\": \"Ɛʋɛ\"\n  },\n  {\n    \"code\": \"el\",\n    \"name\": \"Greek\",\n    \"native\": \"Ελληνικά\"\n  },\n  {\n    \"code\": \"en\",\n    \"name\": \"English\",\n    \"native\": \"English\"\n  },\n  {\n    \"code\": \"eo\",\n    \"name\": \"Esperanto\",\n    \"native\": \"Esperanto\"\n  },\n  {\n    \"code\": \"es\",\n    \"name\": \"Spanish\",\n    \"native\": \"Español\"\n  },\n  {\n    \"code\": \"et\",\n    \"name\": \"Estonian\",\n    \"native\": \"Eesti\"\n  },\n  {\n    \"code\": \"eu\",\n    \"name\": \"Basque\",\n    \"native\": \"Euskara\"\n  },\n  {\n    \"code\": \"fa\",\n    \"name\": \"Persian\",\n    \"native\": \"فارسی\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"ff\",\n    \"name\": \"Peul\",\n    \"native\": \"Fulfulde\"\n  },\n  {\n    \"code\": \"fi\",\n    \"name\": \"Finnish\",\n    \"native\": \"Suomi\"\n  },\n  {\n    \"code\": \"fj\",\n    \"name\": \"Fijian\",\n    \"native\": \"Na Vosa Vakaviti\"\n  },\n  {\n    \"code\": \"fo\",\n    \"name\": \"Faroese\",\n    \"native\": \"Føroyskt\"\n  },\n  {\n    \"code\": \"fr\",\n    \"name\": \"French\",\n    \"native\": \"Français\"\n  },\n  {\n    \"code\": \"fy\",\n    \"name\": \"West Frisian\",\n    \"native\": \"Frysk\"\n  },\n  {\n    \"code\": \"ga\",\n    \"name\": \"Irish\",\n    \"native\": \"Gaeilge\"\n  },\n  {\n    \"code\": \"gd\",\n    \"name\": \"Scottish Gaelic\",\n    \"native\": \"Gàidhlig\"\n  },\n  {\n    \"code\": \"gl\",\n    \"name\": \"Galician\",\n    \"native\": \"Galego\"\n  },\n  {\n    \"code\": \"gn\",\n    \"name\": \"Guarani\",\n    \"native\": \"Avañe'ẽ\"\n  },\n  {\n    \"code\": \"gu\",\n    \"name\": \"Gujarati\",\n    \"native\": \"ગુજરાતી\"\n  },\n  {\n    \"code\": \"gv\",\n    \"name\": \"Manx\",\n    \"native\": \"Gaelg\"\n  },\n  {\n    \"code\": \"ha\",\n    \"name\": \"Hausa\",\n    \"native\": \"هَوُسَ\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"he\",\n    \"name\": \"Hebrew\",\n    \"native\": \"עברית\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"hi\",\n    \"name\": \"Hindi\",\n    \"native\": \"हिन्दी\"\n  },\n  {\n    \"code\": \"ho\",\n    \"name\": \"Hiri Motu\",\n    \"native\": \"Hiri Motu\"\n  },\n  {\n    \"code\": \"hr\",\n    \"name\": \"Croatian\",\n    \"native\": \"Hrvatski\"\n  },\n  {\n    \"code\": \"ht\",\n    \"name\": \"Haitian\",\n    \"native\": \"Krèyol ayisyen\"\n  },\n  {\n    \"code\": \"hu\",\n    \"name\": \"Hungarian\",\n    \"native\": \"Magyar\"\n  },\n  {\n    \"code\": \"hy\",\n    \"name\": \"Armenian\",\n    \"native\": \"Հայերեն\"\n  },\n  {\n    \"code\": \"hz\",\n    \"name\": \"Herero\",\n    \"native\": \"Otsiherero\"\n  },\n  {\n    \"code\": \"ia\",\n    \"name\": \"Interlingua\",\n    \"native\": \"Interlingua\"\n  },\n  {\n    \"code\": \"id\",\n    \"name\": \"Indonesian\",\n    \"native\": \"Bahasa Indonesia\"\n  },\n  {\n    \"code\": \"ie\",\n    \"name\": \"Interlingue\",\n    \"native\": \"Interlingue\"\n  },\n  {\n    \"code\": \"ig\",\n    \"name\": \"Igbo\",\n    \"native\": \"Igbo\"\n  },\n  {\n    \"code\": \"ii\",\n    \"name\": \"Sichuan Yi\",\n    \"native\": \"ꆇꉙ / 四川彝语\"\n  },\n  {\n    \"code\": \"ik\",\n    \"name\": \"Inupiak\",\n    \"native\": \"Iñupiak\"\n  },\n  {\n    \"code\": \"io\",\n    \"name\": \"Ido\",\n    \"native\": \"Ido\"\n  },\n  {\n    \"code\": \"is\",\n    \"name\": \"Icelandic\",\n    \"native\": \"Íslenska\"\n  },\n  {\n    \"code\": \"it\",\n    \"name\": \"Italian\",\n    \"native\": \"Italiano\"\n  },\n  {\n    \"code\": \"iu\",\n    \"name\": \"Inuktitut\",\n    \"native\": \"ᐃᓄᒃᑎᑐᑦ\"\n  },\n  {\n    \"code\": \"ja\",\n    \"name\": \"Japanese\",\n    \"native\": \"日本語\"\n  },\n  {\n    \"code\": \"jv\",\n    \"name\": \"Javanese\",\n    \"native\": \"Basa Jawa\"\n  },\n  {\n    \"code\": \"ka\",\n    \"name\": \"Georgian\",\n    \"native\": \"ქართული\"\n  },\n  {\n    \"code\": \"kg\",\n    \"name\": \"Kongo\",\n    \"native\": \"KiKongo\"\n  },\n  {\n    \"code\": \"ki\",\n    \"name\": \"Kikuyu\",\n    \"native\": \"Gĩkũyũ\"\n  },\n  {\n    \"code\": \"kj\",\n    \"name\": \"Kuanyama\",\n    \"native\": \"Kuanyama\"\n  },\n  {\n    \"code\": \"kk\",\n    \"name\": \"Kazakh\",\n    \"native\": \"Қазақша\"\n  },\n  {\n    \"code\": \"kl\",\n    \"name\": \"Greenlandic\",\n    \"native\": \"Kalaallisut\"\n  },\n  {\n    \"code\": \"km\",\n    \"name\": \"Cambodian\",\n    \"native\": \"ភាសាខ្មែរ\"\n  },\n  {\n    \"code\": \"kn\",\n    \"name\": \"Kannada\",\n    \"native\": \"ಕನ್ನಡ\"\n  },\n  {\n    \"code\": \"ko\",\n    \"name\": \"Korean\",\n    \"native\": \"한국어\"\n  },\n  {\n    \"code\": \"kr\",\n    \"name\": \"Kanuri\",\n    \"native\": \"Kanuri\"\n  },\n  {\n    \"code\": \"ks\",\n    \"name\": \"Kashmiri\",\n    \"native\": \"कश्मीरी / كشميري\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"ku\",\n    \"name\": \"Kurdish\",\n    \"native\": \"Kurdî / كوردی\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"kv\",\n    \"name\": \"Komi\",\n    \"native\": \"Коми\"\n  },\n  {\n    \"code\": \"kw\",\n    \"name\": \"Cornish\",\n    \"native\": \"Kernewek\"\n  },\n  {\n    \"code\": \"ky\",\n    \"name\": \"Kirghiz\",\n    \"native\": \"Kırgızca / Кыргызча\"\n  },\n  {\n    \"code\": \"la\",\n    \"name\": \"Latin\",\n    \"native\": \"Latina\"\n  },\n  {\n    \"code\": \"lb\",\n    \"name\": \"Luxembourgish\",\n    \"native\": \"Lëtzebuergesch\"\n  },\n  {\n    \"code\": \"lg\",\n    \"name\": \"Ganda\",\n    \"native\": \"Luganda\"\n  },\n  {\n    \"code\": \"li\",\n    \"name\": \"Limburgian\",\n    \"native\": \"Limburgs\"\n  },\n  {\n    \"code\": \"ln\",\n    \"name\": \"Lingala\",\n    \"native\": \"Lingála\"\n  },\n  {\n    \"code\": \"lo\",\n    \"name\": \"Laotian\",\n    \"native\": \"ລາວ / Pha xa lao\"\n  },\n  {\n    \"code\": \"lt\",\n    \"name\": \"Lithuanian\",\n    \"native\": \"Lietuvių\"\n  },\n  {\n    \"code\": \"lu\",\n    \"name\": \"Luba-Katanga\",\n    \"native\": \"Tshiluba\"\n  },\n  {\n    \"code\": \"lv\",\n    \"name\": \"Latvian\",\n    \"native\": \"Latviešu\"\n  },\n  {\n    \"code\": \"mg\",\n    \"name\": \"Malagasy\",\n    \"native\": \"Malagasy\"\n  },\n  {\n    \"code\": \"mh\",\n    \"name\": \"Marshallese\",\n    \"native\": \"Kajin Majel / Ebon\"\n  },\n  {\n    \"code\": \"mi\",\n    \"name\": \"Maori\",\n    \"native\": \"Māori\"\n  },\n  {\n    \"code\": \"mk\",\n    \"name\": \"Macedonian\",\n    \"native\": \"Македонски\"\n  },\n  {\n    \"code\": \"ml\",\n    \"name\": \"Malayalam\",\n    \"native\": \"മലയാളം\"\n  },\n  {\n    \"code\": \"mn\",\n    \"name\": \"Mongolian\",\n    \"native\": \"Монгол\"\n  },\n  {\n    \"code\": \"mo\",\n    \"name\": \"Moldovan\",\n    \"native\": \"Moldovenească\"\n  },\n  {\n    \"code\": \"mr\",\n    \"name\": \"Marathi\",\n    \"native\": \"मराठी\"\n  },\n  {\n    \"code\": \"ms\",\n    \"name\": \"Malay\",\n    \"native\": \"Bahasa Melayu\"\n  },\n  {\n    \"code\": \"mt\",\n    \"name\": \"Maltese\",\n    \"native\": \"bil-Malti\"\n  },\n  {\n    \"code\": \"my\",\n    \"name\": \"Burmese\",\n    \"native\": \"မြန်မာစာ\"\n  },\n  {\n    \"code\": \"na\",\n    \"name\": \"Nauruan\",\n    \"native\": \"Dorerin Naoero\"\n  },\n  {\n    \"code\": \"nb\",\n    \"name\": \"Norwegian Bokmål\",\n    \"native\": \"Norsk bokmål\"\n  },\n  {\n    \"code\": \"nd\",\n    \"name\": \"North Ndebele\",\n    \"native\": \"Sindebele\"\n  },\n  {\n    \"code\": \"ne\",\n    \"name\": \"Nepali\",\n    \"native\": \"नेपाली\"\n  },\n  {\n    \"code\": \"ng\",\n    \"name\": \"Ndonga\",\n    \"native\": \"Oshiwambo\"\n  },\n  {\n    \"code\": \"nl\",\n    \"name\": \"Dutch\",\n    \"native\": \"Nederlands\"\n  },\n  {\n    \"code\": \"nn\",\n    \"name\": \"Norwegian Nynorsk\",\n    \"native\": \"Norsk nynorsk\"\n  },\n  {\n    \"code\": \"no\",\n    \"name\": \"Norwegian\",\n    \"native\": \"Norsk\"\n  },\n  {\n    \"code\": \"nr\",\n    \"name\": \"South Ndebele\",\n    \"native\": \"isiNdebele\"\n  },\n  {\n    \"code\": \"nv\",\n    \"name\": \"Navajo\",\n    \"native\": \"Diné bizaad\"\n  },\n  {\n    \"code\": \"ny\",\n    \"name\": \"Chichewa\",\n    \"native\": \"Chi-Chewa\"\n  },\n  {\n    \"code\": \"oc\",\n    \"name\": \"Occitan\",\n    \"native\": \"Occitan\"\n  },\n  {\n    \"code\": \"oj\",\n    \"name\": \"Ojibwa\",\n    \"native\": \"ᐊᓂᔑᓈᐯᒧᐎᓐ / Anishinaabemowin\"\n  },\n  {\n    \"code\": \"om\",\n    \"name\": \"Oromo\",\n    \"native\": \"Oromoo\"\n  },\n  {\n    \"code\": \"or\",\n    \"name\": \"Oriya\",\n    \"native\": \"ଓଡ଼ିଆ\"\n  },\n  {\n    \"code\": \"os\",\n    \"name\": \"Ossetian / Ossetic\",\n    \"native\": \"Иронау\"\n  },\n  {\n    \"code\": \"pa\",\n    \"name\": \"Panjabi / Punjabi\",\n    \"native\": \"ਪੰਜਾਬੀ / पंजाबी / پنجابي\"\n  },\n  {\n    \"code\": \"pi\",\n    \"name\": \"Pali\",\n    \"native\": \"Pāli / पाऴि\"\n  },\n  {\n    \"code\": \"pl\",\n    \"name\": \"Polish\",\n    \"native\": \"Polski\"\n  },\n  {\n    \"code\": \"ps\",\n    \"name\": \"Pashto\",\n    \"native\": \"پښتو\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"pt\",\n    \"name\": \"Portuguese\",\n    \"native\": \"Português\"\n  },\n  {\n    \"code\": \"qu\",\n    \"name\": \"Quechua\",\n    \"native\": \"Runa Simi\"\n  },\n  {\n    \"code\": \"rm\",\n    \"name\": \"Raeto Romance\",\n    \"native\": \"Rumantsch\"\n  },\n  {\n    \"code\": \"rn\",\n    \"name\": \"Kirundi\",\n    \"native\": \"Kirundi\"\n  },\n  {\n    \"code\": \"ro\",\n    \"name\": \"Romanian\",\n    \"native\": \"Română\"\n  },\n  {\n    \"code\": \"ru\",\n    \"name\": \"Russian\",\n    \"native\": \"Русский\"\n  },\n  {\n    \"code\": \"rw\",\n    \"name\": \"Rwandi\",\n    \"native\": \"Kinyarwandi\"\n  },\n  {\n    \"code\": \"sa\",\n    \"name\": \"Sanskrit\",\n    \"native\": \"संस्कृतम्\"\n  },\n  {\n    \"code\": \"sc\",\n    \"name\": \"Sardinian\",\n    \"native\": \"Sardu\"\n  },\n  {\n    \"code\": \"sd\",\n    \"name\": \"Sindhi\",\n    \"native\": \"सिनधि\"\n  },\n  {\n    \"code\": \"se\",\n    \"name\": \"Northern Sami\",\n    \"native\": \"Sámegiella\"\n  },\n  {\n    \"code\": \"sg\",\n    \"name\": \"Sango\",\n    \"native\": \"Sängö\"\n  },\n  {\n    \"code\": \"sh\",\n    \"name\": \"Serbo-Croatian\",\n    \"native\": \"Srpskohrvatski / Српскохрватски\"\n  },\n  {\n    \"code\": \"si\",\n    \"name\": \"Sinhalese\",\n    \"native\": \"සිංහල\"\n  },\n  {\n    \"code\": \"sk\",\n    \"name\": \"Slovak\",\n    \"native\": \"Slovenčina\"\n  },\n  {\n    \"code\": \"sl\",\n    \"name\": \"Slovenian\",\n    \"native\": \"Slovenščina\"\n  },\n  {\n    \"code\": \"sm\",\n    \"name\": \"Samoan\",\n    \"native\": \"Gagana Samoa\"\n  },\n  {\n    \"code\": \"sn\",\n    \"name\": \"Shona\",\n    \"native\": \"chiShona\"\n  },\n  {\n    \"code\": \"so\",\n    \"name\": \"Somalia\",\n    \"native\": \"Soomaaliga\"\n  },\n  {\n    \"code\": \"sq\",\n    \"name\": \"Albanian\",\n    \"native\": \"Shqip\"\n  },\n  {\n    \"code\": \"sr\",\n    \"name\": \"Serbian\",\n    \"native\": \"Српски\"\n  },\n  {\n    \"code\": \"ss\",\n    \"name\": \"Swati\",\n    \"native\": \"SiSwati\"\n  },\n  {\n    \"code\": \"st\",\n    \"name\": \"Southern Sotho\",\n    \"native\": \"Sesotho\"\n  },\n  {\n    \"code\": \"su\",\n    \"name\": \"Sundanese\",\n    \"native\": \"Basa Sunda\"\n  },\n  {\n    \"code\": \"sv\",\n    \"name\": \"Swedish\",\n    \"native\": \"Svenska\"\n  },\n  {\n    \"code\": \"sw\",\n    \"name\": \"Swahili\",\n    \"native\": \"Kiswahili\"\n  },\n  {\n    \"code\": \"ta\",\n    \"name\": \"Tamil\",\n    \"native\": \"தமிழ்\"\n  },\n  {\n    \"code\": \"te\",\n    \"name\": \"Telugu\",\n    \"native\": \"తెలుగు\"\n  },\n  {\n    \"code\": \"tg\",\n    \"name\": \"Tajik\",\n    \"native\": \"Тоҷикӣ\"\n  },\n  {\n    \"code\": \"th\",\n    \"name\": \"Thai\",\n    \"native\": \"ไทย / Phasa Thai\"\n  },\n  {\n    \"code\": \"ti\",\n    \"name\": \"Tigrinya\",\n    \"native\": \"ትግርኛ\"\n  },\n  {\n    \"code\": \"tk\",\n    \"name\": \"Turkmen\",\n    \"native\": \"Туркмен / تركمن\"\n  },\n  {\n    \"code\": \"tl\",\n    \"name\": \"Tagalog / Filipino\",\n    \"native\": \"Tagalog\"\n  },\n  {\n    \"code\": \"tn\",\n    \"name\": \"Tswana\",\n    \"native\": \"Setswana\"\n  },\n  {\n    \"code\": \"to\",\n    \"name\": \"Tonga\",\n    \"native\": \"Lea Faka-Tonga\"\n  },\n  {\n    \"code\": \"tr\",\n    \"name\": \"Turkish\",\n    \"native\": \"Türkçe\"\n  },\n  {\n    \"code\": \"ts\",\n    \"name\": \"Tsonga\",\n    \"native\": \"Xitsonga\"\n  },\n  {\n    \"code\": \"tt\",\n    \"name\": \"Tatar\",\n    \"native\": \"Tatarça\"\n  },\n  {\n    \"code\": \"tw\",\n    \"name\": \"Twi\",\n    \"native\": \"Twi\"\n  },\n  {\n    \"code\": \"ty\",\n    \"name\": \"Tahitian\",\n    \"native\": \"Reo Mā`ohi\"\n  },\n  {\n    \"code\": \"ug\",\n    \"name\": \"Uyghur\",\n    \"native\": \"Uyƣurqə / ئۇيغۇرچە\"\n  },\n  {\n    \"code\": \"uk\",\n    \"name\": \"Ukrainian\",\n    \"native\": \"Українська\"\n  },\n  {\n    \"code\": \"ur\",\n    \"name\": \"Urdu\",\n    \"native\": \"اردو\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"uz\",\n    \"name\": \"Uzbek\",\n    \"native\": \"Ўзбек\"\n  },\n  {\n    \"code\": \"ve\",\n    \"name\": \"Venda\",\n    \"native\": \"Tshivenḓa\"\n  },\n  {\n    \"code\": \"vi\",\n    \"name\": \"Vietnamese\",\n    \"native\": \"Tiếng Việt\"\n  },\n  {\n    \"code\": \"vo\",\n    \"name\": \"Volapük\",\n    \"native\": \"Volapük\"\n  },\n  {\n    \"code\": \"wa\",\n    \"name\": \"Walloon\",\n    \"native\": \"Walon\"\n  },\n  {\n    \"code\": \"wo\",\n    \"name\": \"Wolof\",\n    \"native\": \"Wollof\"\n  },\n  {\n    \"code\": \"xh\",\n    \"name\": \"Xhosa\",\n    \"native\": \"isiXhosa\"\n  },\n  {\n    \"code\": \"yi\",\n    \"name\": \"Yiddish\",\n    \"native\": \"ייִדיש\",\n    \"rtl\": 1\n  },\n  {\n    \"code\": \"yo\",\n    \"name\": \"Yoruba\",\n    \"native\": \"Yorùbá\"\n  },\n  {\n    \"code\": \"za\",\n    \"name\": \"Zhuang\",\n    \"native\": \"Cuengh / Tôô / 壮语\"\n  },\n  {\n    \"code\": \"zh\",\n    \"name\": \"Chinese\",\n    \"native\": \"中文\"\n  },\n  {\n    \"code\": \"zu\",\n    \"name\": \"Zulu\",\n    \"native\": \"isiZulu\"\n  }\n]","/**\n * File handling functions\n * @module useFile\n * */\n\nimport { reactive } from \"vue\";\n\n/**\n * A method to download any text as a file\n * @param {String} text - the text to download\n * @param {String} fileType - the file type like \"application/json\"\n * @param {String} fileName - the full file name like \"myKey.json\"\n */\n\nexport function downloadFile(text, fileType, fileName, isBlob = true) {\n  const a = document.createElement(\"a\");\n  a.download = fileName;\n\n  if (isBlob) {\n    a.href = URL.createObjectURL(new Blob([text], { type: fileType }));\n    setTimeout(function () {\n      URL.revokeObjectURL(a.href);\n    }, 1500);\n  } else {\n    a.href = `data:${fileType};,${text}`;\n  }\n  a.dataset.downloadurl = [fileType, a.download, a.href].join(\":\");\n  a.style.display = \"none\";\n  document.body.appendChild(a);\n  a.click();\n  document.body.removeChild(a);\n}\n\n/**\n * Upload and parse JSON keypair\n * @param {Event} event - `$event` from the `@change` handler\n * @param {Function} callback - a function to handle the loaded file from the reader\n */\n\nexport function uploadText(event, callback = (r) => console.log(r)) {\n  let file = event.target.files[0];\n  const maxBytes = 20000000;\n  if (file.size > maxBytes) {\n    console.error(\"File is bigger than \" + niceBytes(maxBytes)) + \" limit\";\n    return;\n  }\n  let reader = new FileReader();\n  reader.readAsText(file);\n  reader.onload = () => {\n    callback(reader.result);\n  };\n}\n\n//// https://github.com/itsabdessalam/encodeit/blob/develop/src/components/FileUploader.vue\n// to be upgraded with this code https://github.com/powerbot15/image-compressor/blob/master/image-compressor.js\n// https://github.com/dhhb/vue-base64-file-upload\n// https://zocada.com/compress-resize-images-javascript-browser/\n\n/**\n * @typedef {Object} PictureUploadOptions\n * @property {Boolean} preserveRatio - should we preserve the original picture aspect ratio? Default: `false`\n * @property {Number} picSize - width of the rendered picture\n * @property {Number} maxSize - maximum size of an uploaded picture\n */\n\n/**\n * @typedef {Object} PictureUploadData\n * @property {reactive} state - a reactive object with the state of the upload\n * @property {Function} handleUpload - handler function to use with `@change=\"handleUpload\"` on an `<input type=\"file\">` element\n */\n\n/**\n * Process an uploaded picture by rendering in into a canvas with given size. Returns a base64 encoded image to be stored and displayed as `img.src`\n * @param {PictureUploadOptions} Options - uploader options\n * @returns {PictureUploadData}\n * @example\n * const src = ref(null)\n *\n * const {state, handleUpload} = usePictureUpload({\n *  preserveRatio: true,\n * })\n *\n * watch(()=>state.output, file => src.value = file.content)\n */\n\nexport function usePictureUpload({\n  preserveRatio = false,\n  picSize = 100,\n  maxSize = 10240000,\n} = {}) {\n  const state = reactive({\n    errors: [],\n    status: null,\n    output: {},\n  });\n\n  function handleChange(event) {\n    const fileList = event.target.files;\n    reset();\n    if (!fileList.length) return;\n    state.status = \"loading\";\n    [...fileList].map((file) => processFile(file));\n  }\n\n  function processFile(file) {\n    fileToBase64(file).then((res) => {\n      state.output = {\n        name: sanitizeFileName(file.name),\n        content: res,\n        size: niceBytes(Math.round((res.length * 3) / 4)),\n      };\n      state.status = \"success\";\n    });\n    return null;\n  }\n\n  function fileToBase64(file) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader(),\n        readerBase64 = new FileReader(),\n        blob = file.slice(0, 4);\n      reader.readAsArrayBuffer(blob);\n      reader.onloadend = (e) => {\n        let isValidMimeType = checkMimetype(\n          getMimeTypeSignature(e.target.result)\n        );\n\n        if (bytesToMegabytes(file.size) > bytesToMegabytes(maxSize)) {\n          state.errors.push({\n            message: \"File size is too large!\",\n          });\n        }\n\n        if (isValidMimeType === false) {\n          state.errors.push({\n            message: \"File type is not supported!\",\n          });\n        }\n\n        if (state.errors.length > 0) {\n          flashErrors(state.errors);\n          reset();\n          return;\n        } else {\n          readerBase64.readAsDataURL(file);\n        }\n      };\n\n      readerBase64.onloadend = () => {\n        const img = new Image();\n        img.src = readerBase64.result;\n        img.onload = () => {\n          const naturalAspect = preserveRatio\n            ? img.naturalWidth / img.naturalHeight\n            : 1;\n\n          const canvas = document.createElement(\"canvas\");\n          canvas.width = picSize;\n          canvas.height = picSize / naturalAspect;\n\n          const context = canvas.getContext(\"2d\");\n          context.drawImage(img, 0, 0, canvas.width, canvas.height);\n          resolve(canvas.toDataURL());\n        };\n      };\n\n      reader.onerror = (error) => reject(error);\n      readerBase64.onerror = (error) => reject(error);\n    });\n  }\n\n  // Resets upload\n  function reset() {\n    state.status = \"\";\n    state.errors = [];\n    state.output = {};\n  }\n\n  // Converts from bytes to megabytes\n  function bytesToMegabytes(bytes) {\n    const value = bytes * Math.pow(10, -6);\n    return value;\n  }\n\n  // Checks mime type (more at https://mimesniff.spec.whatwg.org/#matching-an-image-type-pattern )\n  // More info https://stackoverflow.com/questions/18299806/how-to-check-file-mime-type-with-javascript-before-upload\n  function checkMimetype(signature) {\n    const signatures = [\n      \"89504E47\", // image/png\n      \"47494638\", // image/gif\n      \"FFD8FFDB\", // image/jpeg\n      \"FFD8FFE0\",\n      \"FFD8FFE1\",\n      \"FFD8FFE2\",\n      \"FFD8FFE3\",\n      \"FFD8FFE8\",\n      \"FFD8FFED\",\n      \"3C3F786D\", // svg/xml\n      \"3C737667\",\n    ];\n    return signatures.includes(signature);\n  }\n\n  function getMimeTypeSignature(data) {\n    const uint = new Uint8Array(data);\n    let bytes = [];\n    uint.forEach((byte) => {\n      bytes.push(byte.toString(16));\n    });\n    return bytes.join(\"\").toUpperCase();\n  }\n\n  // Sanitizes file's name\n  function sanitizeFileName(name) {\n    return (\n      name\n        .replace(/\\.[^/.]+$/, \"\")\n        // .replace(/[^a-z0-9]/gi, \"_\")\n        .toLowerCase()\n    );\n  }\n\n  function flashErrors(errors) {\n    if (errors.length === 2) {\n      console.error(\"File upload failed due to size and type!\");\n    } else {\n      console.error(errors[0].message + errors[0].type);\n    }\n  }\n\n  return {\n    state,\n    handleChange,\n  };\n}\n\nconst units = [\"bytes\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"];\n\nfunction niceBytes(x) {\n  let l = 0,\n    n = parseInt(x, 10) || 0;\n\n  while (n >= 1024 && ++l) {\n    n = n / 1024;\n  }\n  return n.toFixed(n < 10 && l > 0 ? 1 : 0) + \" \" + units[l];\n}\n\nexport function base64MimeType(encoded) {\n  var result = null;\n  if (typeof encoded !== \"string\") {\n    return result;\n  }\n  var mime = encoded.match(/data:([a-zA-Z0-9]+\\/[a-zA-Z0-9-.+]+).*,.*/);\n  if (mime && mime.length) {\n    result = mime[1];\n  }\n  return result;\n}\n\nexport function base64FileType(encoded) {\n  return encoded.match(/[^:]\\w+\\/[\\w-+\\d.]+(?=;|,)/)?.[0];\n}\n\nexport function base64Extension(encoded) {\n  return encoded.substring(\n    encoded.indexOf(\"/\") + 1,\n    encoded.indexOf(\";base64\")\n  );\n}\n\nvar signatures = {\n  JVBERi0: \"application/pdf\",\n  R0lGODdh: \"image/gif\",\n  R0lGODlh: \"image/gif\",\n  iVBORw0KGgo: \"image/png\",\n  \"/9j/\": \"image/jpg\",\n};\n\nexport function detectMimeType(b64) {\n  for (var s in signatures) {\n    if (b64.indexOf(s) === 0) {\n      return signatures[s];\n    }\n  }\n}\n\n// DRAG AND DROP\n//https://medium.com/devschacht/https-medium-com-kasimoka-joseph-zimmerman-drag-drop-file-uploader-vanilla-js-de850d74aa2f\n//https://github.com/quarklemotion/html5-file-selector/blob/master/src/Html5FileSelector.js\n","/**\n * Handle Markdown files\n * @module useMd\n * */\n\nimport yaml from \"yaml\";\nimport markdown from \"markdown-it\";\nimport externalLinks from \"markdown-it-external-links\";\n\n/**\n * @typedef {Object} Md\n * @property {Object} frontmatter\n * @property {object} content\n */\n\n/**\n *  Create markdown with frontmatter\n * @param {Md} md -  frontmatter,content\n * @returns Markdown text file ready to download\n */\n\nexport function createMd({ frontmatter = null, text = \"\" } = md) {\n  let front = \"\";\n  if (typeof frontmatter == \"object\") {\n    let yml = yaml.stringify(frontmatter);\n    front = `---\n${yml}---\n `;\n    return front + text;\n  }\n}\n\n/**\n * Parse text content of a markdown file into an object\n * @param {String} file - Text form of an uploaded file\n * @returns {Md} - An object with md frontmatter and content\n */\nexport function parseMd(file) {\n  const yamlBlockPattern = /^(?:\\-\\-\\-)(.*?)(?:\\-\\-\\-|\\.\\.\\.)(?:\\n*\\s*)(.*)/s;\n  const yml = yamlBlockPattern.exec(file.trim());\n  let frontmatter, content;\n\n  if (yml) {\n    frontmatter = yml[1];\n    content = yml?.[2];\n    try {\n      frontmatter = yaml.parse(frontmatter);\n    } catch {\n      frontmatter = {};\n    }\n    return { frontmatter, content };\n  } else {\n    return { frontmatter: {}, content: file.trim() };\n  }\n}\n\nexport function useMd() {\n  const md = new markdown({\n    linkify: true,\n    typographer: true,\n  });\n\n  md.use(externalLinks, {\n    externalTarget: \"_blank\",\n  });\n  return md;\n}\n","/**\n * Get and handle a particular post by it's tag and hash\n * @module usePost\n */\n\nimport { computed, reactive, ref } from \"vue\";\nimport ms from \"ms\";\n\nimport { useGun, gun, useRoom, currentRoom, useUser } from \"..\";\nimport { useZip } from \"../file/\";\nimport { hashObj, hashText, safeHash } from \"../crypto\";\n\n/**\n * An interface to manage a post\n * @param {Object} options\n * @returns {Post}\n * @example\n * const post = usePost({ tag: 'tag', hash: postHash })\n */\n\nexport function usePost({ hash = \"\", loadMedia = true } = {}) {\n  const gun = useGun();\n\n  const post = reactive({});\n\n  gun\n    .get('posts')\n    .get(`#index`)\n    .get(hash)\n    .on(async (d, k) => {\n      try {\n        Object.assign(post, JSON.parse(d));\n      } catch (e) {\n        post.raw = d;\n      }\n      if (loadMedia) {\n        [\"icon\", \"cover\", \"text\"].forEach((file) => {\n          if (post[file]) {\n            gun\n              .get('posts')\n              .get(`#${file}`)\n              .get(post[file])\n              .on((data) => {\n                post[file] = data;\n              });\n          }\n        });\n      }\n\n    });\n\n  const downloading = ref(false);\n\n  async function download() {\n    downloading.value = true;\n    await downloadPost(post);\n    downloading.value = false;\n  }\n  return { post, download, downloading };\n}\n\n/**\n * @typedef {Object} Post\n * @property {Boolean} empty - whether the post has contents\n * @property {String} tag - the tag under which the post was published\n * @property {String} hash - the hash of the contents\n * @property {Object} data - the contents of the post\n * @property {Function} download - use this function to download the post as a Markdown file\n * @example\n * {\n *  \"empty\": false,\n *  \"tag\": \"ds\",\n *  \"hash\": \"C8trDBYNyvxVedHK4Q0IuUarc/k2/iiv8opPfoAU0xA=\",\n *  \"data\": {\n *    \"cover\": \"data:image/png;base64,..........\",\n *    \"icon\": \"data:image/png;base64,..........\",\n *    \"title\": \"OSS\",\n *    \"statement\": \"New live album by tsoop\",\n *    \"youtube\": \"K2MwpOd8vEI\",\n *    \"content\": \"It's mostly op-z + op-1 with my own Unity visuals based on [Chromatone](https://chromatone.center) system.\\n\\n### 2021\\nFirst played live at April 20th **2021**.\\n\\n### Into 2022\\nIt's an ongoing live album to be recorded throughout the **2022**.\"\n * },\n *  \"timestamp\": 1642590655747,\n *  \"lastUpdated\": \"1d\"\n * }\n */\n\n/**\n * Add a new post to a tag\n * @param {String} tag\n * @param {Object} post\n * @example\n * import { addPost } from '@gun-vue/composables'\n *\n * addPost('MyTag', {\n *  title: 'New post'\n * })\n */\n\nexport async function addPost(to, post) {\n  const { user } = useUser();\n  const { icon, cover, text } = post;\n  post.icon = await saveToHash(\"icon\", post.icon);\n  post.cover = await saveToHash(\"cover\", post.cover);\n  post.text = await saveToHash(\"text\", post.text);\n  const { hashed, hash } = await hashObj(post);\n  console.log(hash, post, to)\n  gun.get('posts').get(`#index`).get(`${hash}`).put(hashed);\n  gun\n    .user(currentRoom.pub)\n    .get(\"posts\")\n    .get(`${to}:${hash}@${user.pub}`)\n    .put(true, null, { opt: { cert: currentRoom.features?.posts } });\n\n}\n\n/**\n * Download the post as a zip file with MD contents and icon and cover pictures if present\n * @param {Post} post\n * @example\n * import { downloadPost, usePost } from '@gun-vue/composables'\n *\n * const {post} = usePost( postTag, postHash )\n *\n * downloadPost(post)\n */\n\nexport async function downloadPost(post) {\n  let { title } = post;\n\n  const { zipPost, addFile, downloadZip } = useZip();\n\n  let singleFile = false;\n\n  if (title && !post.raw) {\n    await zipPost({ ...post });\n  } else {\n    title = \"file\";\n    singleFile = true;\n    const hash = await hashText(post.raw);\n    await addFile({\n      title: safeHash(hash),\n      file: post.raw,\n    });\n  }\n\n  await downloadZip({ title });\n  return true;\n}\n\nexport async function loadFromHash(category, hash) {\n  if (\n    category &&\n    hash &&\n    typeof hash == \"string\" &&\n    hash.length == 44 &&\n    hash.slice(0, 5) != \"data:\"\n  ) {\n    return await gun.get('posts').get(`#${category}`).get(hash).then();\n  }\n  return hash;\n}\n\nasync function saveToHash(category, text) {\n  if (category && text) {\n    const hash = await hashText(text);\n    gun.get('posts').get(`#${category}`).get(`${hash}`).put(text);\n    return hash;\n  } else {\n    return text;\n  }\n}\n\n/**\n * Parse a post string from db\n * @param {String} data Stringified data from the hashed post\n * @returns {Object} Post object\n */\n\nexport async function parsePost(data) {\n  let post;\n  try {\n    post = JSON.parse(data);\n  } catch (e) {\n    post = { base64: data };\n  }\n  return post;\n}\n\n/**\n * Get and update the timestamp of an immutable post\n * @param {} - {tag, hash} \n * @returns {} - {timestamp, msTime, refresh}\n */\n\nexport function usePostTimestamp({ tag, hash } = {}) {\n  const timestamp = ref(0)\n\n  const msTime = computed(() => ms(Date.now() - timestamp.value || 1000))\n\n  gun\n    .get('posts')\n    .get(`#index`)\n    .get(hash)\n    .on(function (d, k, g) {\n      timestamp.value = g.put['>']\n    })\n\n  async function refresh() {\n    let data = await gun.get('posts').get(`#index`).get(hash).then();\n    gun.get('posts').get(`#index`).get(hash).put(data);\n  }\n  return { timestamp, msTime, refresh }\n}","/**\n * Get and handle a particular post by it's tag and hash\n * @module usePosts\n */\n\nimport { computed, reactive, ref } from \"vue\";\n\nimport JSZip from \"jszip\";\n\nimport { detectMimeType, useZip, parseMd, currentRoom, useUser, isHash } from \"..\";\nimport { useGun, gun } from \"../gun\";\nimport { parsePost, addPost, usePost } from \".\";\n\n/**\n * @typedef usePosts\n * @property {ref} posts -  the reactive list of hashed data\n * @property {ref} timestamps - reactive timestamps list for all posts in a list\n * @property {computed} count - the number of posts in a feed\n * @property {Function} downloadPosts - Download all posts in a zip file\n * @property {Function} uploadPosts - upload a zip file with posts\n */\n\n/**\n * Use a list of immutable data from a #tag\n * @param {String} tag - A vue ref to watch - generated from props by `toRef(props,'tag')`\n * @param {Object} options - Options for the feed\n * @returns {usePosts}\n * @example\n * import { usePosts } from '@gun-vue/composables'\n *\n * const { posts, timestamps, count, uploadPosts, downloadPosts} = usePosts('MyTag')\n */\nexport function usePosts(tag) {\n  if (!tag) return\n  const gun = useGun();\n\n  const posts = reactive({});\n  const backlinks = reactive({});\n\n  gun\n    .user(currentRoom.pub)\n    .get(\"posts\")\n    .map()\n    .on(function (data, key) {\n      let index = key.indexOf(tag);\n      if (index == -1) return;\n      let author = key.slice(-87);\n      let from = key.slice(0, 44);\n      let to = key.slice(45, 89);\n      if (index == 0) {\n        posts[to] = posts[to] || {};\n        posts[to][author] = data;\n      } else {\n        backlinks[from] = backlinks[from] || {};\n        backlinks[from][author] = data;\n      }\n    });\n\n\n  const countPosts = computed(() => {\n    let count = 0;\n    for (let hash in posts) {\n      inner_loop: for (let author in posts[hash]) {\n        if (posts[hash][author]) {\n          count++;\n          break inner_loop;\n        }\n      }\n    }\n    return count;\n  });\n\n  const countBacklinks = computed(() => {\n    let count = 0;\n    for (let hash in backlinks) {\n      inner_loop: for (let author in backlinks[hash]) {\n        if (backlinks[hash][author]) {\n          count++;\n          break inner_loop;\n        }\n      }\n    }\n    return count;\n  });\n\n  const downloading = ref(false);\n\n  async function downloadPosts() {\n    downloading.value = true;\n    downloading.value = !(await downloadFeed(tag, posts));\n  }\n\n  function uploadPosts(ev) {\n    uploadFeed(tag, ev);\n  }\n\n  return {\n    posts,\n    backlinks,\n    countPosts,\n    countBacklinks,\n    downloadPosts,\n    downloading,\n    uploadPosts\n  };\n}\n\n\n\n\n\n/**\n * Export a list of posts as a zip file\n * @async\n * @param {String} tag - Name of the tag\n * @param {Object} posts - Posts to export\n * @example\n * import {downloadFeed} from '@gun-vue/components'\n *\n * downloadFeed('myTag',posts)\n */\n\nexport async function downloadFeed(tag, posts) {\n  if (!posts) return;\n\n  const { zip, zipPost, downloadZip } = useZip();\n  const fullPosts = {};\n  for (let hash in posts) {\n    fullPosts[hash] = usePost({ tag, hash }).post;\n    await zipPost({ ...fullPosts[hash] });\n  }\n\n  await downloadZip({ title: `#${tag}` });\n  return true;\n}\n\n/**\n * Upload zip files and add all the MD files from it to the tag\n * @param {String} tag - a tag to add the posts to\n * @param {FileList} files - File list from the input `@change` event\n * @example\n * import { uploadFeed } from '@gun-vue/composables'\n * @example @lang html\n * <input type=\"file\" @change=\"uploadFeed( 'myTag', $event.target.files )\" />\n */\nexport function uploadFeed(tag, files) {\n  [...files].forEach(async (file) => {\n    const zip = await JSZip.loadAsync(file);\n    if (zip.comment) {\n      console.info(\"Zip file comment: \" + zip.comment);\n    }\n    zip.forEach(async (path, entry) => {\n      if (path.endsWith(\"index.md\")) {\n        let title = path.slice(0, -9);\n        let md = await entry.async(\"string\");\n        let { frontmatter, content } = parseMd(md);\n        frontmatter = frontmatter || {};\n        frontmatter.title = frontmatter?.title || title;\n        if (frontmatter.icon) {\n          const icon = await zip\n            .file(`${title}/${frontmatter.icon}`)\n            .async(\"base64\");\n          const iconMime = detectMimeType(icon);\n          frontmatter.icon = `data:${iconMime};base64,${icon}`;\n        }\n        if (frontmatter.cover) {\n          const cover = await zip\n            ?.file(`${title}/${frontmatter.cover}`)\n            ?.async(\"base64\");\n          const coverMime = detectMimeType(cover);\n          frontmatter.cover = `data:${coverMime};base64,${cover}`;\n        }\n        let post = { ...frontmatter, content };\n        addPost(tag, post);\n      }\n    });\n  });\n}\n","/**\n * Get and handle a particular post by it's tag and hash\n * @module useTags\n */\n\nimport { computed, reactive, ref } from \"vue\";\nimport slugify from \"slugify\";\nimport Fuse from \"fuse.js\";\nimport { useGun } from \"../gun\";\nimport { hashText } from \"../crypto\";\n\n/**\n * @typedef useTagList\n * @property {ref} search - a ref to bind to an input element\n * @property {computed} slug - a slugified search query - url safe verion to be used as a tag\n * @property {Tags} tags - the object to handle all the tags\n * @property {Function} addTag - add a slug tag to the list\n */\n\n/**\n * Toolkit to deal with the available tags\n * @returns {useTagList}\n */\nexport function useTagList() {\n  const gun = useGun();\n\n  const search = ref();\n  const slug = computed(() => slugify(search.value));\n\n  const tags = reactive({\n    list: {},\n    all: computed(() => {\n      const arr = [];\n      for (let t in tags.list) {\n        arr.push({\n          hash: t,\n          tag: tags.list[t],\n        });\n      }\n      return arr.sort((a, b) =>\n        a && b && a.tag.toLowerCase() < b.tag.toLowerCase() ? -1 : 1\n      );\n    }),\n    count: computed(() => tags.all.length),\n    fuse: computed(() => {\n      return new Fuse(tags.all, {\n        includeScore: true,\n        keys: [\"tag\"],\n      });\n    }),\n    results: computed(() => {\n      if (!search.value) return [];\n      let res = tags.fuse.search(slug.value);\n      return res;\n    }),\n    minScore: computed(() => {\n      let min = 100;\n      tags.results.forEach((res) => {\n        if (res.score < min) {\n          min = res.score;\n        }\n      });\n      return min;\n    }),\n  });\n\n  gun\n    .get(\"#tags\")\n    .map()\n    .on((d, k) => {\n      if (!d) return;\n      try {\n        data = JSON.parse(d); //ignore objects\n      } catch (e) {\n        tags.list[k] = d; // assumes tag is a plain string\n      }\n    });\n\n  async function addTag(tag = slug.value) {\n    if (!tag) return;\n    let safe = slugify(tag);\n    const hash = await hashText(safe);\n    gun.get(`#tags`).get(`${hash}`).put(safe);\n  }\n\n  return { search, slug, tags, addTag };\n}\n\n\n\nexport function listPersonalTag(tag, pub = currentRoom.pub) {\n  const gun = useGun();\n  const records = reactive({});\n  gun\n    .user(pub)\n    .get(`${tag}`)\n    .map()\n    .on(function (data, key) {\n      let k = key.substring(0, 87);\n      records[k] = records[k] || {};\n      records[k][key.substring(88)] = data;\n    });\n  return records;\n}\n\nexport async function addHashedPersonal(tag, obj, pub = currentRoom.pub, cert) {\n  if (!cert) cert = await gun.get(`~${pub}`).get(\"features\").get(tag).then();\n  if (!cert && pub == rootRoom.pub) {\n    cert = rootRoom.features?.[`#${tag}`];\n  }\n  if (!cert && pub != user.pub) {\n    console.log(\"No certificate found\");\n    return;\n  }\n  const { hashed, hash } = await hashObj(obj);\n  gun\n    .get(`~${pub}`)\n    .get(`#${tag}`)\n    .get(`${hash}@${user.pub}`)\n    .put(hashed, null, { opt: { cert } });\n}\n\nexport function getHashedPersonal(tag, hash, pub = currentRoom.pub) {\n  const record = reactive({});\n  gun\n    .get(`~${pub}`)\n    .get(`#${tag}`)\n    .map()\n    .once(function (data, key) {\n      if (key.includes(hash)) {\n        record.hash = hash;\n        record.tag = tag;\n        record.data = safeJSONParse(data);\n        record.authors = record.authors || {};\n        record.authors[key.slice(-87)] = true;\n      }\n    });\n  return { record };\n}\n","/**\n * React to posts with emojis\n * @module useReaction\n */\n\n\nimport { useUser, currentRoom, getFirstEmoji, useGun } from '..';\nimport { ref, watchEffect } from 'vue'\n\nconst rootsTags = ['rooms']\n\n\nexport function useReaction({ tag, hash, back } = {}) {\n\n  const { user } = useUser();\n\n  const reaction = ref('👍')\n\n  const gun = useGun()\n\n  const roomDb = gun.user(currentRoom.pub)\n\n  watchEffect(() => {\n    if (rootsTags.includes(tag)) {\n      roomDb.get(tag).get(`${hash}@${user.pub}`).on(d => {\n        if (d && d !== true) {\n          reaction.value = d\n        }\n      })\n    } else {\n      roomDb.get('posts').get(`${tag}:${hash}@${user.pub}`).on(d => {\n        if (d && d !== true) {\n          reaction.value = d\n        }\n      })\n    }\n  })\n\n\n  function react(r) {\n    reactToPost({ tag, hash, back, reaction: getFirstEmoji(r ? r : reaction.value) })\n  }\n  return { reaction, react }\n}\n\n\nexport async function reactToPost({ tag, hash, back, reaction = true } = {}) {\n  const { user } = useUser();\n  const gun = useGun();\n  console.log(tag, hash, reaction)\n  if (tag == \"rooms\") {\n    let myPost = gun.user(currentRoom.pub).get(tag).get(`${hash}@${user.pub}`);\n    let current = await myPost.then();\n    myPost.put(!current ? reaction : null, null, {\n      opt: { cert: currentRoom.features?.[tag] },\n    });\n  } else {\n    let myLink = gun.user(currentRoom.pub).get(\"posts\");\n    if (!back) {\n      myLink = myLink.get(`${tag}:${hash}@${user.pub}`);\n    } else {\n      myLink = myLink.get(`${hash}:${tag}@${user.pub}`);\n    }\n\n    let current = await myLink.then();\n    myLink.put(!current ? reaction : null, null, {\n      opt: { cert: currentRoom.features?.posts },\n    });\n  }\n}\n\n","/**\n * Reactions to posts with emojis\n * @module useReactions\n */\n\nimport { useGun, currentRoom, isEmoji, useUser, reactToPost } from '../';\nimport { reactive, ref, computed } from 'vue'\n\n\nexport function useReactions(authors) {\n  const reactions = {}\n  for (let pub in authors) {\n    let reaction = authors[pub]\n    if (reaction) {\n      reactions[reaction] = reactions[reaction] || []\n      reactions[reaction].push(pub)\n    }\n\n  }\n  return reactions\n}\n\nexport function countRating(authors) {\n  let count = 0\n  for (let author in authors) {\n    if (authors[author] && authors[author] != '🗑') {\n      count++\n    } else if (authors[author] == '🗑') {\n      count--\n    }\n  }\n  return count\n}\n\n\nexport function useUserPosts(pub) {\n  const gun = useGun()\n  const posts = reactive({})\n  gun.user(currentRoom.pub).get('posts').map().on((d, k) => {\n    let author = k.slice(90);\n    let from = k.substring(0, 44)\n    let to = k.substring(45, 89)\n    if (author == pub) {\n      if (d) {\n        posts[d] = posts[d] || {}\n        posts[d][to] = from\n      } else {\n        delete posts?.[d]?.[to]\n      }\n\n    }\n  })\n  return posts\n}","/**\n * Read and write zip files\n * @module useZip\n * @see https://github.com/Stuk/jszip\n * */\n\nimport JSZip from \"jszip\";\nimport { downloadFile, base64Extension, base64FileType } from \"./useFile\";\nimport { genUUID, SEA } from \"../gun/\";\nimport { createMd } from \"./useMd\";\nimport { loadFromHash } from \"../posts\";\n\n/**\n * @typedef useZip\n * @property {JSZip} zip - a JSZip instance\n * @property {Function} zipPost - treats a post with md contents and cover and icon images and adds them to the zip\n * @property {Function} addMd - add a MD file to the zip\n * @property {Function} addFile - add a binary file to the zip\n * @property {Function} downloadZip - initiate the download of the zip file\n */\n\n/**\n * Zip file creation toolbox\n * @returns {useZip}\n * @example\n * import {useZip} from '@gun-vue/composables'\n * const { zip, zipPost, addMd, addFile, downloadZip } = useZip()\n */\n\nexport function useZip() {\n  const zip = new JSZip();\n\n  /**\n   * Add a binary file to the zip\n   * @async\n   * @param {Object} options\n   * @returns {String} the resulting filename\n   * @example\n   *  if (post.cover) { // a base64 encoded picture\n   *   const fileName = await addFile({\n   *     title: \"cover\",\n   *     file: post.cover,\n   *     folder: post.title,\n   *   });\n   *   post.cover = fileName;\n   * }\n   */\n\n  async function addFile({ title, file, folder = \".\" } = {}) {\n    const fileType = base64FileType(file);\n    const extension = base64Extension(file);\n    const blob = await fetch(file).then((res) => res.blob());\n    const fileName = `${title}.${extension}`;\n    zip.file(`${folder}/${fileName}`, blob, fileType);\n    return fileName;\n  }\n\n  function addMd({ md, title } = {}) {\n    zip.file(`${title}/index.md`, createMd(md), \"text/markdown\");\n  }\n\n  /**\n   * Zips the whole post object\n   * @param {Object} post\n   * @async\n   */\n\n  async function zipPost(post = {}) {\n    let { icon, cover, text, title, statement } = post;\n    delete post?.text;\n    if (!title) {\n      title = statement ? statement.split(0, 12) : genUUID();\n    }\n\n    const files = [\"cover\", \"icon\"];\n\n    for (let type of files) {\n      let file = await loadFromHash(type, post[type]);\n      if (file) {\n        const fileName = await addFile({\n          title: type,\n          file,\n          folder: title,\n        });\n\n        post[type] = fileName;\n      }\n    }\n\n    text = await loadFromHash(\"text\", text);\n\n    addMd({\n      title,\n      md: {\n        frontmatter: post,\n        text,\n      },\n    });\n  }\n\n  async function downloadZip({ title = \"\", addDate = true } = {}) {\n    let now = new Date();\n    const offset = now.getTimezoneOffset();\n    now = new Date(now.getTime() - offset * 60 * 1000);\n    const date = now.toISOString().split(\"T\")[0];\n\n    const blob = await zip.generateAsync({\n      type: \"blob\",\n      comment: `Exported from ${title} at ${location} on ${date}`,\n      compression: \"DEFLATE\",\n      compressionOptions: {\n        level: 9,\n      },\n    });\n\n    const fileName = `${title}-${date}.zip`;\n\n    downloadFile(blob, \"application/zip\", fileName);\n    return true;\n  }\n\n  return { zip, zipPost, addMd, addFile, downloadZip };\n}\n","export const rootRoom = {\n  \"pub\": \"OUlhoY2Eq8QkZE_iWN3l6J2vvbkX33vowcFdqFoCoEQ.a-B1ImQK4aoiEpdW-38MAPc8oi16DHY57bDJ4dEZpX0\",\n  \"hosts\": {\n    \"jFjrmOEaRy-GAJlOCdG4SGoaLm_4AGMPP1sfmzYPwwo.mp2H7IQuTWlFSahN6ZnXN9Za0pD3thiIYUyGCaMel-M\": {\n      \"enc\": \"SEA{\\\"ct\\\":\\\"pvG4zoG5OIM7gyT5Jsh+PuFLAf200NKIpa7X/OxNm+lneWOD6avNS9iEXx9GgTM18iSdE3CBrKydusfLcqiXFFfMZivXsUTnf2Mbe702drcEcr7x9JTRhEqo3ptmunn+a+NUtfOPeExNFSCKoqfdMzSIR/nZFdW/qGcV5DDZOjuYdbV9Sh1rbvDPThJNJERz3WioLv3SodSXo4J5pq+2NujebALBabIZJYw2RXOxPjRMSnaYjT4lAZTA3FCy4mmP9fReVNw46Zjs6GYoZzIer0E4q5thRKyzf9IDFRJLfwpjejYY/fQWW4YFffN+1QBOjDAysCws+nCBSmFeKuAr2vFTvzdUI7gcoeKOc16BRnTC5NF8qQnXMS4XoilvueQ4as2mffG6iEwUiU5TicZO77+fARiUfG5WIgjEdkE=\\\",\\\"iv\\\":\\\"a6bjav88otAnmjv6iB/r\\\",\\\"s\\\":\\\"W+WzjXaZ4EAu\\\"}\",\n      \"profile\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"jFjrmOEaRy-GAJlOCdG4SGoaLm_4AGMPP1sfmzYPwwo.mp2H7IQuTWlFSahN6ZnXN9Za0pD3thiIYUyGCaMel-M\\\",\\\"w\\\":{\\\"*\\\":\\\"profile\\\"}},\\\"s\\\":\\\"YIGcs8VXeD4eB21MFPM/wnpJnMkmuxX6wjA/1GD170ATGBob9Ps3WCGtRUyhT2AmCIOe7oXpinZdtd3SCSZh/A==\\\"}\",\n      \"features\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"jFjrmOEaRy-GAJlOCdG4SGoaLm_4AGMPP1sfmzYPwwo.mp2H7IQuTWlFSahN6ZnXN9Za0pD3thiIYUyGCaMel-M\\\",\\\"w\\\":{\\\"*\\\":\\\"features\\\"}},\\\"s\\\":\\\"vhnmYfslzJm6qWTUBp4meKtlzAkIxyayRJa1KNeCFJT27T7UX4X//+t5giRX6Z/rIz3aWEPZX9UK3LLhc/J91g==\\\"}\",\n      \"hosts\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"jFjrmOEaRy-GAJlOCdG4SGoaLm_4AGMPP1sfmzYPwwo.mp2H7IQuTWlFSahN6ZnXN9Za0pD3thiIYUyGCaMel-M\\\",\\\"w\\\":{\\\"*\\\":\\\"hosts\\\"}},\\\"s\\\":\\\"2x5ZTh1NYv+eCtRKwlKItC1j9ZV5YhhiWJiaNq8Y+8YBF93aaagY6CT0YzLYFvG/fKTBWN4lldaeI+cFV88AbA==\\\"}\"\n    }\n  },\n  \"features\": {\n    \"rooms\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"*\\\",\\\"w\\\":{\\\"*\\\":\\\"rooms\\\",\\\"+\\\":\\\"*\\\"}},\\\"s\\\":\\\"iJjnFrGvM092KSqH9kUYJm0pBgd6HSg8b9kl9QPjdQYNDAZQe2btfDP6rXIVNPcYFIjEYqBCibuQhcAjODUQFg==\\\"}\",\n    \"space\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"*\\\",\\\"w\\\":{\\\"*\\\":\\\"space\\\",\\\"+\\\":\\\"*\\\"}},\\\"s\\\":\\\"eTZNu+acczsk8ew+UKCseanlVJ4prm+N1cvLXe2T6Bccfk6a7gR5EjvyBat4iCv97HpcoYtfcQO1ImhgVzP/bQ==\\\"}\",\n    \"posts\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"*\\\",\\\"w\\\":{\\\"*\\\":\\\"posts\\\",\\\"+\\\":\\\"*\\\"}},\\\"s\\\":\\\"g94jrn4qvausK0sf5ej+MDIqJr9QOyG6U/fwAfmjxWcxCSiVzra8ZhvwOA3PVsqdcRYMK9YFMZ2cNJhT84ew/w==\\\"}\",\n    \"chat\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"*\\\",\\\"w\\\":{\\\"*\\\":\\\"chat\\\",\\\"+\\\":\\\"*\\\"}},\\\"s\\\":\\\"Nclaw2A61Dzx6wLNeGSFr+od7bdj0jYftz/8XDRTZTUUp42xnD1Hyp2GbmFGKrY8be+60XOxYB0Tcp+ewkPimA==\\\"}\",\n    \"dict\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"*\\\",\\\"w\\\":{\\\"*\\\":\\\"dict\\\",\\\"+\\\":\\\"*\\\"}},\\\"s\\\":\\\"cmnSSjKGrbxEoJ3JyGfgeesLJ3fELC6aIy3nO4MmSLok4ZNxpx2HayQaQmi+8gfgwX86poYUm1WR2bDdUAgzmw==\\\"}\",\n    \"projects\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"*\\\",\\\"w\\\":{\\\"*\\\":\\\"projects\\\",\\\"+\\\":\\\"*\\\"}},\\\"s\\\":\\\"Zx/1sVapPoqx0pVMrMElSWVwBbD1AH0uPP11/tte2qHUmww458tqwRNfC3XMhZVl/fR589I3VWoUXSfNGDPj+g==\\\"}\",\n    \"gifts\": \"SEA{\\\"m\\\":{\\\"c\\\":\\\"*\\\",\\\"w\\\":{\\\"*\\\":\\\"gifts\\\",\\\"+\\\":\\\"*\\\"}},\\\"s\\\":\\\"YpWMF8FpZToI4KCc4ZxR4zBChQMF+C6HQF1maNpDyA6g9t/DY9tejELG+mc2CqcV9mDU/km2q7EeaZGnxQsREA==\\\"}\"\n  }\n}","/**\n * @module useRoom\n */\n\nimport {\n  SEA,\n  useGun2,\n  gun,\n  useGun,\n  generateCerts,\n  useUser,\n  user,\n  hashObj,\n  safeJSONParse,\n  hashText\n} from \"..\";\nimport { rootRoom } from \"./rootRoom\";\nimport { reactive, computed, ref, watchEffect } from \"vue\";\n\nexport const currentRoom = reactive({\n  pub: rootRoom.pub,\n  isRoot: computed(() => currentRoom.pub == rootRoom.pub),\n  hosts: {},\n  features: {},\n  profile: {},\n});\n\nwatchEffect(() => {\n  const gun = useGun();\n\n  if (currentRoom.pub == rootRoom.pub) {\n    currentRoom.hosts = rootRoom.hosts;\n    currentRoom.features = rootRoom.features;\n  } else {\n    currentRoom.features = {};\n    currentRoom.hosts = {};\n    gun\n      .user(currentRoom.pub)\n      .get(\"hosts\")\n      .map()\n      .once((d, k) => {\n\n        currentRoom.hosts[k] = d;\n      });\n    gun\n      .user(currentRoom.pub)\n      .get(\"features\")\n      .map()\n      .once((d, k) => {\n\n        currentRoom.features[k] = d;\n      });\n  }\n});\n\n\n/**\n * Reactive room controls\n * @returns {useRoom}\n */\n\nexport function useRoom(pub = currentRoom.pub) {\n  const room = reactive({\n    pub,\n    isRoot: pub != rootRoom.pub,\n    hosts: {},\n    features: {},\n    profile: {},\n  });\n\n  const gun = useGun();\n  gun\n    .user(pub)\n    .get(\"profile\")\n    .map()\n    .on((d, k) => {\n      room.profile[k] = d;\n    });\n  gun\n    .user(pub)\n    .get(\"hosts\")\n    .map()\n    .once((d, k) => {\n      room.hosts[k] = d;\n    });\n  gun\n    .user(pub)\n    .get(\"features\")\n    .map()\n    .once((d, k) => {\n      room.features[k] = d;\n    });\n\n  return {\n    room,\n    submitRoom,\n    enterRoom,\n    createRoom,\n    leaveRoom,\n    updateRoomProfile,\n  };\n}\n\nexport function useRoomLogo(pub = currentRoom.pub) {\n\n  const logo = ref()\n\n  gun.user(pub).get('profile').get('logo').on(hash => {\n    if (!hash) {\n      logo.value = null\n      return\n    }\n    gun.get('#logos').get(hash).once(d => {\n      logo.value = d\n    })\n  })\n\n  async function uploadLogo(file) {\n    if (file) {\n      const hash = await hashText(file)\n      gun.get('#logos').get(hash).put(file)\n      updateRoomProfile('logo', hash)\n    } else {\n      removeLogo()\n    }\n\n  }\n\n  function removeLogo() {\n    updateRoomProfile('logo', null)\n  }\n\n  return {\n    logo, uploadLogo, removeLogo\n  }\n}\n\nexport function useRooms() {\n  const rooms = computed(() => {\n    return listPersonal(\"rooms\", currentRoom.pub);\n  });\n  return { rooms, createRoom };\n}\n\nexport function listPersonal(tag, pub = currentRoom.pub) {\n  const gun = useGun();\n  const records = reactive({});\n  gun\n    .user(pub)\n    .get(`${tag}`)\n    .map()\n    .on(function (data, key) {\n      let k = key.substring(0, 87);\n      records[k] = records[k] || {};\n      records[k][key.substring(88)] = data;\n    });\n  return records;\n}\n\n/**\n * Update a profile field of a room\n * @param {String} field parameter to write to\n * @param {String} content\n */\n\nexport function updateRoomProfile(field, content) {\n  const gun = useGun();\n  const { user } = useUser();\n  let certificate = currentRoom.hosts?.[user.pub]?.profile;\n  gun\n    .user(currentRoom.pub)\n    .get(\"profile\")\n    .get(field)\n    .put(content, null, { opt: { cert: certificate } });\n}\n\n/**\n * Create a new room inside the current room\n */\n\nexport async function createRoom({ pair, name } = {}) {\n  const { user } = useUser();\n  // if (!pair) pair = await SEA.pair();\n  if (!pair) return;\n\n  const certs = await generateCerts({\n    pair,\n    list: [\n      { tag: \"profile\", users: [user.pub] },\n      { tag: \"features\", users: [user.pub] },\n      { tag: \"hosts\", users: [user.pub] },\n    ],\n  });\n  const features = await generateCerts({\n    pair,\n    list: [\n      { tag: \"rooms\", personal: true },\n      { tag: \"space\", personal: true },\n      { tag: \"posts\", personal: true },\n      { tag: \"chat\", personal: true },\n      { tag: \"dict\", personal: true },\n      { tag: \"projects\", personal: true },\n      { tag: \"gifts\", personal: true },\n    ],\n  });\n\n  const enc = await SEA.encrypt(pair, user.pair());\n  const dec = await SEA.decrypt(enc, user.pair());\n\n  console.log(\n    \"COPY THIS ROOM INFO TO USE IT AS A ROOT\",\n    {\n      pub: dec.pub,\n      hosts: { [user.pub]: { enc, ...certs } },\n      features,\n    },\n    \"STORE THIS KEY PAIR IN A SAFE PLACE\",\n    dec\n  );\n\n  const gun = useGun();\n  gun.user().get(\"safe\").get(\"rooms\").get(dec.pub).put(enc);\n\n  gun\n    .user(currentRoom.pub)\n    .get(\"rooms\")\n    .get(`${dec.pub}@${user.pub}`)\n    .put(true, null, { opt: { cert: currentRoom?.features?.rooms } });\n\n  const roomDb = gun.user(dec.pub);\n  roomDb\n    .get(\"hosts\")\n    .get(user.pub)\n    .put(\n      {\n        enc,\n        ...certs,\n      },\n      null,\n      { opt: { cert: certs.hosts } }\n    );\n  roomDb.get(\"features\").put(features, null, { opt: { cert: certs.features } });\n\n  if (name) {\n    roomDb.get(\"profile\").put({ name }, null, { opt: { cert: certs.profile } });\n  }\n\n  // enterRoom(pair.pub);\n}\n\nexport async function recreateRoom(enc) {\n  const dec = await SEA.decrypt(enc, user.pair());\n  createRoom({\n    pair: dec,\n  });\n}\n\nexport async function submitRoom(pub) {\n  const gun = useGun();\n  const already = await gun\n    .user(currentRoom.pub)\n    .get(\"rooms\")\n    .get(`${pub}@${user.pub}`)\n    .then();\n\n  gun\n    .user(currentRoom.pub)\n    .get(\"rooms\")\n    .get(`${pub}@${user.pub}`)\n    .put(!already, null, { opt: { cert: currentRoom.features?.rooms } });\n}\n\nexport function joinRoom() {\n  const gun = useGun();\n  gun\n    .user(currentRoom.pub)\n    .get(\"space\")\n    .get(user.pub)\n    .put(JSON.stringify({ x: Math.random(), y: Math.random() }), null, {\n      opt: { cert: currentRoom.features?.space },\n    });\n}\n\n/**\n * The right way to come inside a room\n * @param {String} pub\n */\n\nexport function enterRoom(pub) {\n  currentRoom.pub = pub;\n}\n\n/**\n * Leave the room\n */\n\nexport function leaveRoom() {\n  currentRoom.pub = rootRoom.pub;\n}\n\nexport async function addPersonal({\n  tag,\n  key,\n  text,\n  pub = currentRoom.pub,\n  cert,\n} = {}) {\n  if (!cert) cert = await gun.user(pub).get(\"features\").get(tag).then();\n  if (!cert) {\n    cert = currentRoom.features?.[`${tag}`];\n  }\n  if (!cert && pub != user.pub) {\n    console.log(\"No certificate found\");\n    return;\n  }\n  gun\n    .user(pub)\n    .get(`${tag}`)\n    .get(`${key}@${user.pub}`)\n    .put(text, null, { opt: { cert } });\n}\n","import { computed, ref, reactive, watchEffect } from \"vue\";\nimport { useGun, useAccount, getFirstEmoji, currentRoom } from \"..\";\n\nlet startTime = Date.now();\n\nexport function useGuests({ TIMEOUT = 10000 } = {}) {\n  const gun = useGun();\n\n  const guests = reactive({});\n  const online = reactive({});\n  const offline = reactive({});\n\n  const count = reactive({\n    total: computed(() => Object.keys(guests).length),\n    online: computed(() => Object.keys(online).length),\n    offline: computed(() => Object.keys(offline).length),\n  });\n\n  gun\n    .user(currentRoom.pub)\n    .get(\"space\")\n    .map()\n    .once((pos, pub) => {\n      const { account } = useAccount(pub);\n      guests[pub] = account;\n      guests[pub].order = computed(() =>\n        startTime - account.value.pulse < TIMEOUT\n          ? 1\n          : startTime - account.value.pulse\n      );\n      guests[pub].online = computed(() => {\n        return startTime - account.value.pulse < TIMEOUT;\n      });\n    });\n\n  watchEffect(() => {\n    for (let pub in guests) {\n      if (guests[pub].online) {\n        online[pub] = guests[pub];\n        delete offline[pub];\n      } else {\n        offline[pub] = guests[pub];\n        delete online[pub];\n      }\n    }\n  });\n\n  return { guests, online, offline, count };\n}\n","import { useNow, watchThrottled } from '@vueuse/core'\nimport { SEA } from 'gun'\nimport { reactive, computed, watch } from 'vue'\nimport { useGun, useUser, hashObj, currentRoom } from '..'\n\nimport { giftPath } from '.'\n\nexport function useGifts() {\n  const { user } = useUser()\n  const gun = useGun()\n\n  const gifts = reactive({})\n\n  gun.user(currentRoom.pub).get(giftPath).map().once((data, key) => {\n    gun.get('#' + giftPath).get(key.slice(0, -88)).once((d, k) => {\n      try {\n        const obj = JSON.parse(d)\n        gifts[k] = obj\n      } catch (e) {\n        // gifts[k] = d\n      }\n    })\n  })\n\n  return { gifts }\n}\n\n\nexport function useMyGifts() {\n  const { user } = useUser()\n  const gun = useGun()\n  const gifts = reactive({})\n  const from = reactive({})\n  const to = reactive({})\n\n  gun.user().get(giftPath).map().on((d, hash) => {\n    gun.get('#' + giftPath).get(hash).once(d => {\n      try {\n        d = JSON.parse(d)\n        gifts[hash] = d\n        if (d.from == user.pub) {\n          from[hash] = d\n        }\n        if (d.to == user.pub) {\n          to[hash] = d\n        }\n      } catch { }\n    })\n  })\n\n  const newGifts = reactive({})\n\n  gun.user(currentRoom.pub).get(giftPath).map().once(async (d, path) => {\n    let hash = path.slice(0, -88)\n    gun.get('#' + giftPath).get(hash).once(async (d) => {\n      try {\n        d = JSON.parse(d)\n        if (d.to == user.pub) {\n          let has = await gun.user().get(giftPath).get(hash).then()\n          if (!has) {\n            newGifts[hash] = d\n          }\n        }\n      } catch { }\n    })\n  })\n\n\n  return { gifts, from, to, newGifts }\n}\n\nexport function useProjectGifts(path) {\n  const pub = path.slice(-87)\n  const gun = useGun()\n  const gifts = reactive({})\n\n  gun.user(pub).get(giftPath).map().once((d, hash) => {\n    gun.get('#' + giftPath).get(hash).once(d => {\n      try {\n        d = JSON.parse(d)\n        if (d.project == path) {\n          gifts[hash] = { ...d, state: {} }\n\n          gun.user(d.from).get(giftPath).get(hash).on(data => { gifts[hash].state.from = data })\n          gun.user(d.to).get(giftPath).get(hash).on(data => { gifts[hash].state.to = data })\n        }\n\n      } catch { }\n    })\n  })\n\n\n\n  const collections = computed(() => {\n    let collections = {}\n    for (let hash in gifts) {\n      let gift = gifts[hash]\n      collections[gift.ql] = collections[gift.ql] || { list: {}, sum: 0, from: {} }\n      collections[gift.ql].list[hash] = gift\n    }\n\n    for (let q in collections) {\n      collections[q].sum = 0\n      collections[q].from = {}\n\n      for (let hash in collections[q].list) {\n\n        let colG = collections[q].list[hash]\n        if (!(colG.state.from && colG.state.to)) continue\n        collections[q].sum += Number(colG.qn)\n        collections[q].from[colG.from] = collections[q].from[colG.from] || 0\n        collections[q].from[colG.from] += Number(colG.qn)\n      }\n\n    }\n    return collections\n  })\n\n\n\n  return { gifts, collections }\n}","/**\n * Connections between accounts\n * @module useMates\n */\n\nimport { reactive, watch, ref, computed } from \"vue\";\nimport { useGun, user } from \"..\";\nimport GB from \"grapheme-breaker-mjs\";\n\n/**\n * @typedef {reactive} useMates\n */\n\n/**\n * Get a reactive list of the user's mates\n * @param {String} pub\n * @returns {useMates}\n */\n\nexport function useMates(pub) {\n  if (!pub) {\n    pub = user.pub;\n  }\n  const mates = reactive({});\n  const gun = useGun();\n  gun\n    .user(pub)\n    .get(\"mates\")\n    .map()\n    .once((text, matePub) => {\n      if (text) {\n        mates[matePub] = {\n          emoji: getFirstEmoji(text),\n          text,\n        };\n        gun\n          .user(matePub)\n          .get(\"mates\")\n          .get(pub)\n          .on((d) => {\n            if (d) {\n              mates[matePub].back = getFirstEmoji(d);\n            } else {\n              delete mates[matePub].back;\n            }\n          });\n      } else {\n        delete mates[matePub];\n      }\n    });\n  return mates;\n}\n\n/**\n * Break the string into graphemes and return the first one if it's an emoji\n * @param {String} text\n * @returns {String} Emoji\n */\n\nexport function getFirstEmoji(text, def = \"👋\") {\n  if (!text || typeof text != \"string\") return;\n  let em = GB.break(text)[0];\n  if (isEmoji(em)) {\n    return em;\n  } else {\n    return def;\n  }\n}\n\n/**\n * Check if the text has emojis\n * @param {String} text\n * @returns {Boolean}\n */\n\nexport function isEmoji(text) {\n  return /\\p{Extended_Pictographic}/u.test(text);\n}\n\n/**\n * @typedef {Object} useMate\n * @property {ref} emoji - change it in an input\n * @property {ref} isMate - reactive state of connection\n * @property {Function} toggleMate - toggle the link with current `emoji` ref\n */\n\n/**\n * Make mates with some account by current user\n * @param {String} pub\n * @returns {useMate}\n */\n\nexport function useMate(pub) {\n  const emoji = ref(\"👋\");\n  const isMate = ref(false);\n\n  const dbMate = user.db.get(\"mates\").get(pub);\n\n  dbMate.on((d) => {\n    isMate.value = getFirstEmoji(d);\n  });\n\n  function toggleMate() {\n    dbMate.put(isMate.value ? false : getFirstEmoji(emoji.value));\n  }\n  return { emoji, isMate, toggleMate };\n}\n","/**\n * Basic user management\n * @module useUser\n * */\n\nimport { gun, useGun } from \"..\";\nimport { useColor } from \"../ui\";\nimport { computed, reactive, ref } from \"vue\";\nimport ms from \"ms\";\n\nconst colorDeep = useColor(\"deep\");\n\nexport const selectedUser = reactive({\n  pub: null,\n});\n\n/**\n * @typedef {Object} Account - the user account interface\n * @property {ref} pub - The pub key used to build the account\n * @property {computed} color - The user account color derived from the pub key\n * @property {Object} profile - An object with all the `gun.user().get('profile')` data\n * @property {Number} pulse - latest timestamp from the user. It's emitted every second. Offline timeout is set to 10 seconds.\n * @property {Boolean} blink - A boolean that toggles on every timestamp received\n * @property {Sting} lastSeen - Shows 'online' if recent pulse is less then 10s ago or a human readable time string\n * @property {gun} db - `gun.user(pub)` ref to query any additional user data\n * @example\n * {\n * \"pub\": \"XnpLVDYZWdl1NNgo6BlD6e3-n3Fzi-ZzVrzbIgYCYHo.9-hHUHaWNaAE6tMp800MMzNtDLtjicS53915IrBu4uc\",\n * \"color\": \"#f55c3d\",\n * \"profile\": {\n *    \"name\": \"Accord\",\n *    \"Message\": \"Use your imagination!\",\n *    \"Money\": \"$ 20000000000\"\n * },\n * \"pulse\": 1642077216809,\n * \"lastSeen\": \"online\",\n * \"blink\": true\n * }\n */\n\n/**\n * @typedef {Object} User - An interface to the current gun user\n * @property {Boolean} initiated - `true` if useUser has been run at least once\n * @property {Object} is - Reactive `gun.user().is`\n * @property {String} pub - Current user public key\n * @property {String} color - a HEX color for the given pub\n * @property {Number} pulse - Last received pulse timestamp\n * @property {Number} pulser - An id for pulse `setInterval`\n * @property {Boolean} blink - Toggles with every pulse received\n * @property {Object} db - `gun.user()` reference\n * @property {Object} safe - safe account indicators\n * @property {Function} pair - use `user.pair()` to get curent user key pair\n * @example\n * { \n *  \"initiated\": true, \n *  \"is\": { \n *    \"pub\": \"XnpLVDYZWdl1NNgo6BlD6e3-n3Fzi-ZzVrzbIgYCYHo.9-hHUHaWNaAE6tMp800MMzNtDLtjicS53915IrBu4uc\", \n *    \"epub\": \"wAvPlMAg4jvUvK4sPpVyF1CAWnRCMu1YpHnoDrVDg-o.l79QDmdPCLEiO0F_WkB3zYLpJt-lANtyhNmHSM4bTes\", \n *    \"alias\": \"XnpLVDYZWdl1NNgo6BlD6e3-n3Fzi-ZzVrzbIgYCYHo.9-hHUHaWNaAE6tMp800MMzNtDLtjicS53915IrBu4uc\" \n *  }, \n *  \"name\": \"Accord\", \n *  \"pub\": \"XnpLVDYZWdl1NNgo6BlD6e3-n3Fzi-ZzVrzbIgYCYHo.9-hHUHaWNaAE6tMp800MMzNtDLtjicS53915IrBu4uc\", \n *  \"color\": \"#f55c3d\", \n *  \"pulse\": 1642708061615, \n *  \"pulser\": 12, \n *  \"blink\": false, \n *  \"safe\": { \n *    \"saved\": true, \n *    \"password\": null, \n *    \"enc\": \"SEA{\\\"ct\\\":\\\"E+6GViU9dTuidruOCNAoBITE+AlGNRgiABplSbL5fh4v1P+fhF33MuBwKd3ssBNi2kJ1sCzvS/YLmzivECA5ARZPGVbgXTSj8AE9kCz0Ac/8ushlsfBNdt8s3+a3OPVxMIevnT01uqcgr75Zp4TugIg/YuB5WltA9RHsgWEMlo+X+tRGaqG5rfw4sAmTSV0P8evMgM9rN/Un5t/WeDbvIPNXqZEmtxwAhMUZwOJWZckNZmNwpxnelFO0BwmauWfzkXuqGeSxNhMeaZi+VoRDMUvTjT68DLBnVoOhFhcdco+RW8AJfktZHZ4GF2IzFnQmTGpUd2LfvIY/Yn1eNJH7iQ5w41ChiYB/zhgQCOc5ur51PV6swAuN595vUNn7+0J1JRSNGzW2V/4j4YR4IEsAoqOtdn2Y21ga/CFdrE0=\\\",\\\"iv\\\":\\\"LtODTV+LBzhWHqUcptUO\\\",\\\"s\\\":\\\"XCL9Uj1YlPcV\\\"}\", \n *  \"pass\": \"SEA{\\\"ct\\\":\\\"8wNClMx/ebfou+gGWdf+bbx0TAgc9RU=\\\",\\\"iv\\\":\\\"NPgHkI+Ke+i/mw+3chlr\\\",\\\"s\\\":\\\"3VzGv06Y4fQ+\\\"}\" \n *  } \n * }\n\n */\n\nexport const user = reactive({\n  initiated: false,\n  auth: false,\n  is: null,\n  name: \"\",\n  pub: computed(() => user?.is?.pub),\n  color: computed(() => (user.pub ? colorDeep.hex(user.pub) : \"gray\")),\n  pulse: 0,\n  pulser: null,\n  blink: false,\n  safe: {\n    saved: null,\n    password: null,\n  },\n  pair() {\n    return gun?.user?.()?._?.sea;\n  },\n});\n\n/**\n * @typedef useUser\n * @property {User} user - the user interface\n * @property {Function} auth - auth with a pair\n * @property {Function} leave - log out\n */\n\n/**\n * Get access to current logged in user\n * @returns {useUser}\n * @example\n * import { useUser } from '@gun-vue/composables'\n *\n * const { user, auth, leave } = useUser()\n */\n\nexport function useUser() {\n\n\n  if (!user.initiated) {\n    const gun = useGun();\n    user.db = gun.user();\n    gun.user().recall({ sessionStorage: true }, () => {\n      console.log(\"user was recalled\");\n    });\n\n    gun.on(\"auth\", () => {\n      init();\n      console.log(\"user authenticated\");\n    });\n    user.initiated = true;\n  }\n\n\n  return { user, auth, leave };\n}\n\nfunction init() {\n  user.is = gun.user().is;\n  if (user.pulser) {\n    clearInterval(user.pulser);\n  }\n  user.pulser = setInterval(() => {\n    gun.user().get(\"pulse\").put(Date.now());\n  }, 1000);\n\n  gun.user().get('epub').put(user.is.epub)\n\n  gun\n    .user()\n    .get(\"pulse\")\n    .on((d) => {\n      user.blink = !user.blink;\n      user.pulse = d;\n    })\n\n  gun.user()\n    .get(\"safe\")\n    .map()\n    .on((d, k) => {\n      user.safe[k] = d;\n    });\n\n  gun\n    .user()\n    .get(\"profile\")\n    .get(\"name\")\n    .on((d) => (user.name = d));\n\n  user.initiated = true;\n}\n\n/**\n * Authenticate with a SEA key pair\n * @param {Object} pair\n * @example\n * import { auth, SEA } from '@gun-vue/composables'\n *\n * async function login() {\n *    const pair = await SEA.pair()\n *    auth(pair)\n * }\n */\n\nexport async function auth(pair, cb = () => { }) {\n  if (!isPair(pair)) {\n    // pair = await SEA.pair();\n    console.log(\"incorrect pair\", pair);\n    return;\n  }\n  gun.user().auth(pair, async () => {\n    cb(pair);\n    console.log(\"user is authenticated\");\n  });\n}\n\n/**\n * Log out the user\n * @example\n * import { leave } from '@gun-vue/composables'\n *\n * leave()\n **/\n\nexport function leave() {\n  let is = !!user.is?.pub;\n  user.initiated = false;\n  clearInterval(user.pulser);\n  gun.user().leave();\n  setTimeout(() => {\n    if (is && !user.pair()) {\n      user.is = null;\n      console.info(\"User logged out\");\n    }\n  }, 500);\n}\n\nexport function isMine(soul) {\n  if (!soul) return;\n  return soul.slice(1, 88) == user.pub;\n}\n\n/**\n * Add a field to the User profile\n * @param {String} name\n * @example\n * import { addProfileField } from '@gun-vue/composables'\n *\n * addProfileField( 'city' )\n */\n\nexport function addProfileField(title) {\n  gun.user().get(\"profile\").get(title).put(\"\");\n}\n\n/**\n * Update a profile field\n * @param {String} field\n * @param {Any} data\n * @example\n * import { updateProfile } from '@gun-vue/composables'\n *\n * updateProfile( 'city', 'Moscow' )\n */\n\nexport function updateProfile(field, data) {\n  if (field && data !== undefined) {\n    gun.user().get(\"profile\").get(field).put(data);\n  }\n}\n\n/**\n * Check if the object is a proper SEA pair\n * @param {Object} pair - an object to check\n * @returns {Boolean}\n */\n\nexport function isPair(pair) {\n  return (\n    pair &&\n    typeof pair == \"object\" &&\n    pair.pub &&\n    pair.epub &&\n    pair.priv &&\n    pair.epriv\n  );\n}\n","/**\n * Manage user's password and credentials\n * @module usePass\n */\n\nimport { computed, reactive, watchEffect } from \"vue\";\nimport { gun, useGun, SEA, auth, isPair, user } from \"..\";\nimport base32 from \"base32\";\n\n/**\n * @typedef {reactive} Pass\n * @property {Object} safe\n * @property {Object} dec\n */\n\nexport const pass = reactive({\n  input: \"\",\n  show: false,\n  safePair: false,\n  minLength: 5,\n  safe: {},\n  dec: {},\n  links: {\n    pass: computed(() => {\n      return genLink(pass.safe?.enc);\n    }),\n    pair: computed(() => {\n      return genLink(JSON.stringify(user.pair()));\n    }),\n  },\n\n  set() {\n    setPass(pass.input);\n    pass.input = \"\";\n    pass.show = false;\n  },\n});\n\nfunction genLink(text = \"\") {\n  let base = base32.encode(text);\n  return window.location.origin + window.location.pathname + \"#/auth/\" + base;\n}\n\nexport function parseLink(link) {\n  let index = link.indexOf(\"#/auth/\");\n  let base = link.substr(index + 7);\n  return base32.decode(base);\n}\n\nlet initiated = false;\n\n/**\n * Manage password of a user\n * @returns {usePass}\n */\n\nexport function usePass() {\n  if (!initiated) {\n    const gun = useGun();\n    gun\n      .user()\n      .get(\"safe\")\n      .map()\n      .on((d, k) => {\n        pass.safe[k] = d;\n      });\n\n    watchEffect(async () => {\n      if (!pass.show) {\n        pass.dec = {};\n        return;\n      }\n      if (pass?.show && pass?.safe?.pass) {\n        pass.dec.pass = await SEA.decrypt(pass.safe.pass, user.pair());\n        pass.input = pass.dec.pass;\n      }\n      if (pass.show && pass?.safe?.enc) {\n        pass.dec.pair = await SEA.decrypt(pass.safe.enc, pass.dec.pass);\n      }\n    });\n  }\n  initiated = true;\n\n  return { pass, setPass, logWithPass };\n}\n\n/**\n * @typedef {Object} usePass\n * @property {Pass} pass - the reactive password object\n * @property {Function} setPass\n * @property {Function} logWithPass\n */\n\nexport async function hasPass(pub) {\n  return await gun.get(`~${pub}`).get(\"safe\").get(\"enc\").then();\n}\n\nasync function logWithPass(pub, passphrase) {\n  let encPair = await gun.get(`~${pub}`).get(\"safe\").get(\"enc\").then();\n  let pair = await SEA.decrypt(encPair, passphrase);\n  auth(pair);\n}\n\nasync function setPass(text) {\n  let encPair = await SEA.encrypt(user.pair(), text);\n  let encPass = await SEA.encrypt(text, user.pair());\n  user.db.get(\"safe\").get(\"enc\").put(encPair);\n  user.db.get(\"safe\").get(\"pass\").put(encPass);\n}\n\nexport function usePassLink(data, passPhrase) {\n  if (!data) return;\n  const decoded = base32.decode(data);\n  if (decoded.substring(0, 3) == \"SEA\") {\n    if (passPhrase) {\n      logEncPass(decoded, passPhrase);\n    }\n    return \"encrypted\";\n  } else {\n    try {\n      let d = JSON.parse(decoded);\n      if (isPair(d)) {\n        auth(d);\n      }\n      return \"success\";\n    } catch (e) {\n      return \"incorrect link\";\n    }\n  }\n}\n\nasync function logEncPass(encPair, passphrase) {\n  let pair = await SEA.decrypt(encPair, passphrase);\n  auth(pair);\n}\n","import { giftPath } from '.'\nimport { useUser } from '../user'\nimport { reactive, computed, ref, watch } from 'vue'\nimport { hashObj } from '../crypto'\nimport { useNow } from '@vueuse/core'\nimport { useGun } from '../gun'\nimport { computedAsync } from '@vueuse/core'\nimport { currentRoom } from '../room'\n\nexport function useGift(hash) {\n  const gun = useGun()\n  const gift = reactive({})\n  const state = reactive({\n    from: false,\n    to: false,\n    complete: computed(() => state.from && state.to),\n    status: computed(() => state.from ? state.to ? 'complete' : 'proposed' : 'canceled')\n  })\n  gun.get('#' + giftPath).get(hash).once((d, k) => {\n    try {\n\n      Object.assign(gift, JSON.parse(d))\n\n      gun.user(gift.from).get(giftPath).get(k).on(d => { state.from = d })\n\n      gun.user(gift.to).get(giftPath).get(k).on(d => { state.to = d })\n\n    } catch (e) {\n      // gifts[k] = d\n    }\n\n  })\n  return { gift, state }\n}\n\n\nexport async function giftState(hash, state = true) {\n  const { user } = useUser()\n  user.db.get(giftPath).get(hash).put(state)\n}\n\n\nexport function useNewGift(giftConf) {\n  const { user } = useUser()\n\n  const { now, pause } = useNow({ interval: 1000, controls: true })\n\n  const gift = reactive({\n    from: computed(() => user?.pub),\n    to: '',\n    qn: null,\n    ql: null,\n    wish: '',\n    project: '',\n    date: computed(() => now.value.toLocaleString('en-GB')),\n    room: computed(() => currentRoom.pub)\n  })\n\n  const cleanGift = computed(() => {\n    let g = removeEmpty(gift)\n    g.qn = Number(g.qn)\n    return g\n  })\n\n  const required = ['from', 'to', 'qn', 'ql']\n\n  const valid = computed(() => {\n    const isFilled = required.reduce((acc, val) => {\n      return acc && gift[val]\n    }, true)\n    return isFilled\n  })\n\n  watch(gift, g => {\n    if (g.project) {\n      gift.to = g.project.slice(-87)\n    }\n  })\n\n  const hash = computedAsync(async () => {\n    const { hash, hashed } = await hashObj(cleanGift.value)\n    return hash\n  })\n\n  const proposed = ref(false)\n\n  Object.assign(gift, giftConf)\n\n  const gun = useGun()\n\n  async function propose() {\n\n    const { hash, hashed } = await hashObj(cleanGift.value)\n\n    gun.get('#' + giftPath).get(hash).put(hashed)\n\n    gun.user().get(giftPath).get(hash).put('proposed', () => {\n      pause()\n      proposed.value = true\n    })\n\n    if (currentRoom.features?.gifts) {\n\n      gun\n        .user(currentRoom.pub)\n        .get(giftPath)\n        .get(`${hash}@${user.pub}`)\n        .put(\n          true,\n          () => {\n            console.log(`gift ${hash} published`)\n          },\n          {\n            opt: { cert: currentRoom.features.gifts }\n          }\n        )\n    }\n\n  }\n\n  return { gift, cleanGift, valid, propose, proposed, hash }\n\n}\n\nfunction removeEmpty(obj) {\n  return Object.entries(obj)\n    .filter(([_, v]) => !!v)\n    .reduce(\n      (acc, [k, v]) => ({ ...acc, [k]: v === Object(v) ? removeEmpty(v) : v }),\n      {}\n    );\n}","import { currentRoom } from '../room'\n\nexport * from './useGifts'\nexport * from './useGift'\n\nexport const giftPath = \"gifts\"\n\n\nexport const defaultGift = {\n  from: '',\n  to: '',\n  qn: 0,\n  ql: '',\n  wish: '',\n  project: '',\n  room: currentRoom.pub,\n  date: ''\n}","/**\n * Worker wrapper for heavy functions\n * @module useWorker\n */\n\n/**\n * Example sorter function for a dated list object\n * @param {Object} e - the worker post event with a `data` object with a list of records to sort by the date keys\n */\nexport function sortByDate(e) {\n  const arr = Object.entries(e.data);\n  let sorted = arr.sort((a, b) => {\n    if (!a || !b) return 0;\n    let timeA = Date.parse(a[0]);\n    let timeB = Date.parse(b[0]);\n    return timeB - timeA;\n  });\n  postMessage({ sorted, count: arr.length });\n}\n\n// https://vitejs.dev/guide/features.html#web-workers\n\n/**\n * Create a new worker for a function\n * It should contain a `postMessage` method to reply to any incoming `postMessage` from the main script\n * @param {Function} funcObj\n */\n\nexport const newWorker = function (funcObj) {\n  // Build a worker from an anonymous function body\n  var blobURL = URL.createObjectURL(\n    new Blob([\"onmessage=\", funcObj.toString()], {\n      type: \"application/javascript\",\n    })\n  ),\n    worker = new Worker(blobURL);\n\n  // Won't be needing this anymore\n  URL.revokeObjectURL(blobURL);\n\n  return worker;\n};\n\n","/**\n * Reactive version of `gun-util` Date tree\n * @module useLog\n */\n\nimport { reactive, ref, onMounted, watchEffect, onBeforeUnmount } from \"vue\";\nimport { DateTree } from \"gun-util\";\nimport ms from \"ms\";\nimport { newWorker } from \"./useWorker\";\nimport { gun, useGun } from \"../gun\";\n\nfunction sortByDate(e) {\n  const arr = Object.entries(e.data);\n  let sorted = arr.sort((a, b) => {\n    if (!a || !b) return 0;\n    let timeA = Date.parse(a[0]);\n    let timeB = Date.parse(b[0]);\n    return timeB - timeA;\n  });\n  postMessage({ sorted, count: arr.length });\n}\n\nexport function useLog({\n  name = \"logs\",\n  after = \"2021-01-01\",\n  before = \"2023-01-01\",\n} = {}) {\n  const gun = useGun();\n  const treeRoot = gun.get(name);\n  const tree = new DateTree(treeRoot, \"minute\");\n  const dateTree = reactive({});\n  const sorted = ref([]);\n  const count = ref(0);\n\n  let query;\n\n  onMounted(() => {\n    var w = newWorker(sortByDate);\n\n    query = tree.on(\n      function (d, date) {\n        if (!d?.event) return;\n        dateTree[date] = d;\n      },\n      { gte: after, lt: before }\n    );\n\n    watchEffect(() => {\n      w.postMessage(JSON.parse(JSON.stringify(dateTree)));\n    });\n\n    w.onmessage = (e) => {\n      sorted.value = e.data.sorted;\n      count.value = e.data.count;\n    };\n  });\n\n  onBeforeUnmount(() => {\n    query.off();\n  });\n\n  function putNow(data) {\n    if (!data) return;\n    tree.get(new Date()).put({ event: \"now\", data });\n  }\n\n  return { dateTree, sorted, count, putNow };\n}\n\nexport function logEvent(event = \"text\", data) {\n  if (!data) {\n    console.log(\"No data to log\");\n    return;\n  }\n  const tree = new DateTree(gun.get(\"logs\"), \"minute\");\n  let theData = { event, ...data };\n  tree.get(new Date()).put(theData);\n}\n\nexport function formatDate(date) {\n  if (!date) return;\n  let theDate = new Date(date);\n  return {\n    date: theDate.toLocaleDateString(\"en-CA\"),\n    time: theDate.toLocaleTimeString(\"ru-RU\"),\n    ms: ms(Date.now() - theDate.getTime()),\n  };\n}\n","import { reactive, ref, computed, onBeforeUnmount } from 'vue'\nimport { gun, useGun2, useGun } from '../gun'\nimport { currentRoom } from '../room'\nimport { useUser } from '../user'\nimport { projectsPath } from '.'\nimport { SEA } from 'gun'\n\n\nexport const newProject = reactive({\n  title: '',\n  public: true,\n  funding: false\n})\n\nexport async function updateProject({ publish = true } = {}) {\n  const gun = useGun()\n  const { user } = useUser()\n  const link = gun.user().get(projectsPath).get(newProject.title).put(newProject, () => {\n    if (!publish) return\n\n    gun\n      .user(currentRoom.pub)\n      .get(projectsPath)\n      .get(newProject.title + '@' + user.pub)\n      .put(\n        link,\n        null,\n        {\n          opt:\n            { cert: currentRoom.features?.projects }\n        }\n      )\n    newProject.title = null\n  })\n\n\n\n}\n\nexport function updateProjectField(title, field, value) {\n  const proj = gun.user().get(projectsPath).get(title)\n  proj.get(field).put(value, () => {\n    proj.get('updatedAt').put(Date.now())\n  })\n}\n\n\nexport function useProject(path = ref()) {\n  path = ref(path)\n  const gun = useGun()\n  const project = computed(() => {\n    const proj = reactive({})\n    gun.user(currentRoom.pub).get(projectsPath).get(path.value).map().on((d, k) => {\n      proj[k] = d\n    })\n    return proj\n  })\n  return { project }\n}\n\n\n\nexport async function removeProject(path) {\n  const gun = useGun()\n  const gun2 = useGun2()\n  const { user } = useUser()\n\n  if (path.includes(user.pub)) {\n    gun.user(currentRoom.pub).get(projectsPath).get(path).put(null, null, {\n      opt:\n        { cert: currentRoom.features?.projects }\n    })\n\n  } else if (currentRoom.hosts[user.pub]) {\n    const pair = await SEA.decrypt(currentRoom.hosts[user.pub].enc, user.pair())\n    gun2.user().auth(pair, () => {\n      gun2.user().get(projectsPath).get(path).put(null)\n    })\n\n  }\n\n\n}\n\n","/**\n * @module Projects\n */\n\nimport { computed, reactive, ref } from \"vue\"\nimport { projectsPath } from \".\"\nimport { newProject } from './useProject'\nimport { useGun } from \"../gun\"\nimport { currentRoom } from \"../room\"\nimport Fuse from \"fuse.js\";\n\n\n\nexport function useProjects(pub = currentRoom.pub) {\n\n  const search = ref('')\n  const projects = reactive({})\n\n  const fuse = computed(() => {\n    const list = Object.entries(projects).map(arr => ({ ...arr[1], path: arr[0] }))\n    return new Fuse(list, {\n      includeScore: true,\n      ignoreLocation: true,\n      keys: [\"title\"],\n    })\n  })\n\n  const candidates = computed(() => {\n    if (newProject.title) {\n      return fuse.value.search(newProject.title)\n    } else {\n      return Object.entries(projects).map(arr => ({ item: { ...arr[1], path: arr[0] } }))\n    }\n  });\n\n  const gun = useGun()\n\n  gun\n    .user(pub)\n    .get(projectsPath)\n    .map()\n    .on((d, k) => {\n      if (d == null) { delete projects[k]; return }\n      const data = { ...d, path: k }\n      delete data._\n      projects[k] = data\n    })\n\n  return { projects, search, candidates }\n}\n\n\nexport function countProjects(pub = currentRoom.pub) {\n  const list = reactive({})\n  const gun = useGun()\n  gun\n    .user(pub)\n    .get(projectsPath)\n    .map()\n    .on((d, k) => {\n      if (d == null) { delete list[k]; return }\n      list[k] = true\n    })\n  return computed(() => Object.keys(list).length)\n\n}","export * from \"./useProject\";\nexport * from \"./useProjects\";\n\nexport const projectsPath = 'projects'\n","/**\n * A 2D-space\n * @module useSpace\n */\n\nimport { useGun } from \"..\";\nimport { useSvgMouse } from \"../ui\";\nimport { useUser } from \"../user\";\nimport { computed, ref, reactive, watchEffect } from \"vue\";\nimport { getFirstEmoji, currentRoom } from \"..\";\nimport { getArrow } from \"curved-arrows\";\nimport { useElementBounding } from \"@vueuse/core\";\nimport { useClamp } from '@vueuse/math'\n\n/**\n * @typedef {Object} useSpace\n * @property {reactive} space The main object\n * @property {reactive} guests Active guests\n * @property {reactive} links Links between active guests\n * @property {ref} plane The SVG element\n * @property {ref} area The rect element for mouse events capture\n * @property {ref} width Width of the plane\n * @property {ref} height Height of the plane\n * @property {Function} join Join the space with the current user\n */\n\n/**\n *  A space to navigate with mouse clicks\n * @returns {useSpace}\n * @example\n * const { space, plane, links, width, height, guests, area, join } = useSpace({\n * TIMEOUT: 10000,\n * })\n */\n\nexport function useSpace({\n  TIMEOUT = 10000,\n  randomness = 0.1,\n} = {}) {\n  const plane = ref();\n  const { area, mouse } = useSvgMouse(plane);\n\n  const { width, height } = useElementBounding(plane);\n  const pos = reactive([0, 0])\n  const zoom = useClamp(1, 0.5, 2)\n\n  const gun = useGun();\n  const { user } = useUser()\n\n  const space = reactive({\n    title: \"space\",\n    joined: false,\n    db: computed(() => gun.user(currentRoom.pub).get(\"space\")),\n    cert: computed(() => currentRoom.features?.space),\n    my: {\n      mouse: computed(() => ({ x: mouse.x, y: mouse.y })),\n      pos: null,\n    },\n  });\n\n  async function join() {\n    space.joined = true;\n  }\n\n  function place({ x = mouse.x, y = mouse.y } = {}) {\n    if (!user.pub) return;\n    if (!space.joined) join();\n    pos[0] = x\n    pos[1] = y\n    space.db.get(user.pub).get('pos').put(JSON.stringify({ x, y }), null, {\n      opt: { cert: currentRoom.features?.space },\n    });\n  }\n\n  // function placePoint() {\n  //   const pointPos = [pos[0] + space.my.mouse.x, pos[1] + space.my.mouse.y].map(Math.round)\n  //   console.log(pointPos)\n  //   space.db.get(user.pub).set({\n  //     title: 'point',\n  //     x: pointPos[0],\n  //     y: pointPos[1],\n  //     url: 'https://gun-vue.js.org'\n  //   }, null, {\n  //     opt: { cert: currentRoom.features?.space },\n  //   });\n  // }\n\n  const allGuests = reactive({});\n  const mates = reactive({});\n  const links = reactive({});\n\n  const guests = computed(() => {\n    const obj = {};\n    for (let g in allGuests) {\n      if (Date.now() - allGuests[g]?.pulse < TIMEOUT) {\n        obj[g] = allGuests[g];\n      }\n    }\n    return obj;\n  });\n\n  const guestCount = computed(() => Object.keys(guests.value).length);\n\n  gun.user(currentRoom.pub).get(\"space\").map().once(async (pos, pub) => {\n    if (pub == user.pub) {\n      space.joined = true;\n    }\n    allGuests[pub] = {\n      pub: pub,\n      draw: '',\n      blink: false,\n      pulse: 0,\n      hasPos: false,\n      pos: {\n        x: 0,\n        y: 0,\n      }\n    };\n\n\n\n    gun.user(currentRoom.pub).get(\"space\").get(pub).get('pos').on((d, k) => {\n      allGuests[pub].hasPos = true;\n      allGuests[pub].pos = typeof d == \"string\" ? JSON.parse(d) : d;\n    });\n\n    gun.user(currentRoom.pub).get(\"space\").get(pub).get('draw').on(d => {\n      allGuests[pub].draw = d\n    })\n\n    gun\n      .user(pub)\n      .get(\"pulse\")\n      .on((d) => {\n        allGuests[pub].pulse = d;\n        allGuests[pub].blink = !allGuests[pub].blink;\n      })\n      .back()\n      .get(\"mates\")\n      .map()\n      .on((d, k) => {\n        mates[pub] = mates[pub] || {};\n        mates[pub][k] = d;\n      });\n\n\n  });\n\n  const seeds = {}; //random seeds to scatter the arrows a little - depends on the `randomness` option\n\n  watchEffect(() => {\n    for (let pub1 in mates) {\n      seeds[pub1] = seeds[pub1] || {};\n\n      for (let pub2 in mates[pub1]) {\n        let seed = (seeds[pub1][pub2] =\n          seeds[pub1][pub2] || Math.random() * randomness);\n\n        if (mates[pub1][pub2]) {\n          const linkData = mates[pub1][pub2];\n          let g1 = allGuests[pub1];\n          let g2 = allGuests[pub2];\n          let age = Date.now() * 2 - g1?.pulse - g2?.pulse;\n          if (g1 && g2 && g1?.hasPos && g2?.hasPos && age < TIMEOUT) {\n            links[pub1 + pub2] = {\n              user: pub1,\n              mate: pub2,\n              emoji: getFirstEmoji(linkData),\n              from: g1.pos,\n              to: g2.pos,\n              arrow: generateArrow(\n                g1.pos,\n                g2.pos,\n                seed,\n              ),\n            };\n          }\n        } else {\n          delete links[pub1 + pub2];\n        }\n      }\n    }\n  });\n  return {\n    space,\n    allGuests,\n    guests,\n    guestCount,\n    links,\n    plane,\n    width,\n    height,\n    pos,\n    zoom,\n    area,\n    join,\n    place\n  };\n}\n\nfunction generateArrow(pos1, pos2, seed = 0) {\n  let arrowArray = getArrow(\n    pos1.x,\n    pos1.y,\n    pos2.x,\n    pos2.y,\n    {\n      padEnd: 20,\n      padStart: 10,\n    }\n  );\n  const [sx, sy, c1x, c1y, c2x, c2y, ex, ey, ae, as] = arrowArray;\n  let arrow = {\n    sx,\n    sy,\n    c1x: c1x * (1 - seed + 2 * seed),\n    c1y: c1y * (1 - seed + 2 * seed),\n    c2x: c2x * (1 - seed + 2 * seed),\n    c2y: c2y * (1 - seed + 2 * seed),\n    ex,\n    ey,\n    ae,\n    as,\n  };\n  return arrow;\n}\n\n/**\n * @todo draggable handles https://dev.to/abolz/roll-your-own-svg-drag-and-drop-in-vuejs-2c7o\n */\n","import { computed, markRaw, nextTick, reactive, ref, watch, onMounted } from 'vue'\nimport { createDrauu } from 'drauu'\nimport { toReactive, useStorage, useCycleList, useDebounceFn } from '@vueuse/core'\n\nimport { useGun, currentRoom, useUser } from '../'\n\nexport const draw = reactive({\n  colors: [\n    '#000000',\n    ...new Array(12).fill(true).map((el, i) => `hsl(${i * 30}, 100%,50%)`),\n    '#ffffff',\n  ],\n  sizes: useCycleList([4, 8, 16, 24]),\n  modes: ['line', 'arrow', 'stylus', 'rectangle', 'ellipse'],\n  mode: computed({\n    get() {\n      return _mode.value\n    },\n    set(v) {\n      _mode.value = v\n      if (v === 'arrow') {\n        brush.mode = 'line'\n        brush.arrowEnd = true\n      }\n      else {\n        brush.mode = v\n        brush.arrowEnd = false\n      }\n    },\n  }),\n  enabled: false,\n  pinned: useStorage('drawing-pinned', false),\n  canUndo: false,\n  canRedo: false,\n  canClear: false,\n  ing: false,\n  initiated: false,\n  content: ''\n})\n\nexport const brush = toReactive(useStorage('drawing-brush', {\n  color: draw.colors[0],\n  size: 10,\n  mode: 'stylus',\n}))\n\nconst _mode = ref('stylus')\nlet disableDump = false\n\nexport const drauuOptions = reactive({\n  brush,\n  acceptsInputTypes: computed(() => draw.enabled ? undefined : ['pen']),\n  // coordinateTransform: true,\n})\nexport const drauu = markRaw(createDrauu(drauuOptions))\n\nexport function loadCanvas(page) {\n  disableDump = true\n  if (draw.content != null)\n    drauu.load(draw.content)\n  else\n    drauu.clear()\n  disableDump = false\n}\n\nexport function updateState() {\n  draw.canRedo = drauu.canRedo()\n  draw.canUndo = drauu.canUndo()\n  draw.canClear = !!drauu.el?.children.length\n}\n\n\nexport function useDraw() {\n  if (!draw.initiated) {\n    const gun = useGun()\n\n    const { user } = useUser()\n\n    const drawing = gun.user(currentRoom.pub).get('space').get(user.pub).get('draw')\n\n    drawing.on(d => {\n      if (draw.ing) return\n      draw.content = d\n      loadCanvas()\n    })\n\n    const debouncedDraw = useDebounceFn(() => {\n      updateState()\n      if (!disableDump) {\n        let content = drauu.dump()\n        draw.content = content\n\n        gun.user(currentRoom.pub).get('space').get(user.pub).get('draw').put(content, null, { opt: { cert: currentRoom.features?.space } })\n      }\n    }, 200)\n\n    drauu.on('changed', debouncedDraw)\n    onMounted(() => {\n      nextTick(() => {\n        loadCanvas()\n      })\n\n    })\n\n    drauu.on('start', () => draw.ing = true)\n    drauu.on('end', () => draw.ing = false)\n\n    draw.clear = () => {\n      drauu.clear()\n      draw.content = ''\n      drawing.put('', null, { opt: { cert: currentRoom.features?.space } })\n    }\n\n    window.addEventListener('keydown', (e) => {\n      if (!draw.enabled)\n        return\n\n      const noModifier = !e.ctrlKey && !e.altKey && !e.shiftKey && !e.metaKey\n      let handled = true\n      if (e.code === 'KeyZ' && (e.ctrlKey || e.metaKey)) {\n        if (e.shiftKey)\n          drauu.redo()\n        else\n          drauu.undo()\n      }\n      else if (e.code === 'Escape') {\n        draw.enabled = false\n      }\n      else if (e.code === 'KeyC' && (e.ctrlKey || e.metaKey)) {\n        draw.clear()\n      }\n      else if (e.code.startsWith('Digit') && noModifier && +e.code[5] <= brushColors.length) {\n        brush.color = brushColors[+e.code[5] - 1]\n      }\n      else {\n        handled = false\n      }\n\n      if (handled) {\n        e.preventDefault()\n        e.stopPropagation()\n      }\n    }, false)\n  }\n\n  draw.initiated = true\n\n  return {\n    brush, draw, drauu, loadCanvas\n  }\n}\n\n"],"names":["colorDeep","currentRoom","Buffer","gun","hashObj","yaml","externalLinks","rootRoom","user","GB","DateTree","SEA"],"mappings":"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IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,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IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,IACV,KAAO;AAAA,EACR;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,IACV,KAAO;AAAA,EACR;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,IACV,KAAO;AAAA,EACR;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,MAAQ;AAAA,IACR,MAAQ;AAAA,IACR,QAAU;AAAA,EACX;AAAA,EACD;AAAA,IACE,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"}